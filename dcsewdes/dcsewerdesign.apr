/3.2
(ODB.1
	Dependencies:	"$AVEXT/script_tools_jen.avx\n$AVEXT/cadview.avx\n$AVEXT/geoproc.avx\n"
	FirstRootClassName:	"Project"
	Roots:	2
	Version:	32
)

(Project.2
	Name:	"dcsewerdesign.apr"
	CreationDate:	"Saturday, February 26, 2000 09:19:58 AM"
	GUIName:	"Project"
	Win:	3
	CSMgr:	4
	DocExts:	5
	VisGUIWidth:	70
	Doc:	6
	Doc:	10
	Doc:	14
	Doc:	18
	Doc:	22
	Doc:	26
	Doc:	30
	Doc:	34
	Doc:	38
	Doc:	42
	Doc:	46
	Doc:	50
	Doc:	54
	Doc:	58
	Doc:	62
	Doc:	66
	Doc:	70
	Doc:	74
	Doc:	78
	Doc:	82
	Doc:	86
	Doc:	90
	Doc:	94
	Doc:	98
	Doc:	102
	Doc:	106
	Doc:	110
	Doc:	114
	Doc:	118
	Doc:	122
	Doc:	126
	Doc:	130
	Doc:	134
	Doc:	138
	Doc:	142
	Doc:	146
	Doc:	150
	Doc:	154
	Doc:	158
	Doc:	162
	Doc:	166
	Doc:	170
	Doc:	174
	Doc:	178
	Doc:	182
	Buttons:	186
	Buttons:	187
	Buttons:	188
	Dependencies:	189
	Dependencies:	190
	Dependencies:	191
	Scripts:	192
	Prefs:	193
	GUI:	676
	GUI:	984
	GUI:	1403
	GUI:	1578
	WorkDir:	1834
	WinY:	1
	WinW:	1680
	WinH:	1015
	SerialNumber:	"835011100145"
	SelColor:	1835
	GUINames:	1836
	GUINames:	1837
	GUINames:	1838
	GUINames:	1839
	GUINames:	1840
	GUINames:	1841
	GUINames:	1842
	GUINames:	1843
	TocWidthScale:	1.00000000000000
)

(DocWin.3
	Owner:	2
	Open:	1
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.4
)

(DocAct.5
	Doc:	2
)

(SEd.6
	Name:	"DCSewerDesign.accumulateBranchLength"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 31. Oktober 2002 15:25:31"
	GUIName:	"Script"
	Win:	7
	CSMgr:	8
	DocExts:	9
	Source:	"' DCSewerDesign.accumulateBranchLength\n\n' accumulates the Branch Length in a simple Sewer Network\n' This will overwrite the AccumulatedBranch field.\n' The maximum upstream branch length (Handover from upstream network)\n' will be accumulated in the AccumulatedBranch field.\n' Note: The lines have to be flipped to the correct direction!\n\n' (c) 2002 DORSCH Consult\n\n'information\n  MsgBox.info(\"The Lines have to be flipped to the Flow direction!\",\"DC Sewer Design\")\n\n'get the table\n  viewActive = av.GetActiveDoc \n
  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n  ' get the fields\n  \n  lstFields = ftbLine.getFields.deepclone\n  lstNumberFields = av.run(\"DCSewerDesign.Fields.returnNumberFields\",lstFields)\n  fldAccumulatedBra
nchLength = MsgBox.choice(lstNumberFields, \"Select the Accumulated Branch Length field.\"+NL+\n                              \"This field will be overwritten.\",\"DC Sewer Design\")\n  if(fldAccumulatedBranchLength = nil)then\n    exit\n  end\n  fldAccumulatedBranchLength = ftbLine.findField(fldAccumulatedBranchLength.getName)\n  fldBranchLength = MsgBox.choice(lstNumberFields, \"Select the BranchLength field.\",\"DC Sewer Design\")\n  if(fldBranchLength = nil)then\n    exit\n  end\n \n fldShape = ftbLine.findField(\"Shape\")\n  
 \n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n 'give the user a chance to kill script\n av.showStopButton \n  \n ftbLine.setEditable(true)\n\nfor each recLine in ftbLine\n  ftbLine.setValue(fldAccumulatedBranchLength,recLine, 0)\nend  \n\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n\n  \nbmpCalculate = Bitmap.make(ftbLine.getNumRecords)\nbmpCalculate.setAll\nbmpCompleted = Bitmap.make(ftbLine.getNumRecords)\nbmpCompleted.setAll\n  \n  \n' loop until all lines are calculated  \n
while(bmpCalculate.count > 0)\nnumPreventEndlessLoop = bmpCalculate.count\n  \n' run over all records in the table\n  for each recLine in bmpCalculate\n\n   ' get the Upstream Manhole\n    pllLine = ftbLine.returnValue(fldShape, recLine)\n    pntUpstreamManhole = pllLine.asList.get(0).get(0)\n    lstUpstreamLines = av.run(\"DCSewerDesign.Manhole.findUpstreamLines\",{ftbLine, pntUpstreamManhole})\n      \n'    numAccumulatedBranchLength = ftbLine.returnValue(fldAccumulatedBranchLength, recLine)\n    numAccumulatedBranchLe
ngth = 0\n      \n    'check if all the upstream pipes have been calculated\n    blnReady = true\n    for each recConnectedLine in lstUpstreamLines\n'      if(bmpCalculate.get(recConnectedLine))then\n      if(ftbLine.returnValue(fldAccumulatedBranchLength,recConnectedLine) <= 0)then\n        blnReady = false\n       ' break\n      else\n       'add the Handover AccumulatedBranchLengths\n        numBranchLength = ftbLine.returnValue(fldAccumulatedBranchLength, recConnectedLine)\n        if(numBranchLength.isNull)then\n  
        numBranchLength = 0\n        end\n        numAccumulatedBranchLength = numAccumulatedBranchLength.max(numBranchLength)\n      end\n    end\n      \n    if(blnReady)then    \n      'calculate the AccumulatedBranchLength\n      numBranchLength = ftbLine.returnValue(fldBranchLength, recLine)\n      numAccumulatedBranchLength = numAccumulatedBranchLength + numBranchLength\n      numAccumulatedBranchLength = numAccumulatedBranchLength.max(0.001)\n      ftbLine.setValue(fldAccumulatedBranchLength, recLine, numAccumu
latedBranchLength)             \n      bmpCompleted.clear(recLine)      \n      'update status display\n      if(av.setStatus((numCounter/numTotal)*100).not)then\n        'user hit the stop button\n        exit\n      end\n      numCounter = numCounter+1\n    end\n  end\n  \n  bmpCalculate.and(bmpCompleted)  \n  \n  if(numPreventEndlessLoop = bmpCalculate.count)then\n    MsgBox.info(\"System leads to endless loop. Aborting.\",\"DC Sewer Design\")\n    exit\n  end\nend\n\n' check if script run was successful\n numSumBranchLength = 
0\n for each recLine in ftbLine\n   numSumBranchLength = numSumBranchLength + ftbLine.returnValue(fldBranchLength, recLine)\n end  \n \n if(numSumBranchLength <> numAccumulatedBranchLength)then\n   Msgbox.info(\"Accumulated BranchLength doesn't match the Sum of BranchLength.\"+NL+\n   \"Script run might have failed. Check the System\",\"DC Sewer Design\")\n end\n \n ftbLine.setEditable(false)\n av.clearStatus\n"
	SearchStr:	"Population"
	FontSize:	1
)

(DocWin.7
	Owner:	6
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.8
)

(DocAct.9
	Doc:	6
)

(SEd.10
	Name:	"DCSewerDesign.accumulatePopulation"
	Creator:	"sdteffen"
	CreationDate:	"Wednesday, March 22, 2000 01:06:36"
	GUIName:	"Script"
	Win:	11
	CSMgr:	12
	DocExts:	13
	Source:	"' DCSewerDesign.accumulatePopulation\n\n' accumulates the Population in a simple Sewer Network\n' This will overwrite the AccumulatedPopulation field.\n' The Population figures (Handover from upstream network)\n' will be accumulated in the AccumulatedPopulation field.\n' Note: The lines have to be flipped to the AccumulatedPopulation direction!\n\n' (c) 2000 - 2004 DORSCH Consult\n \n'information about the configuration file\n  MsgBox.info(\"The Lines have to be flipped to the Flow direction!\",\"DC Sewer Design\")\n\n'get 
the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n  ' get the fields\n  \n  lstFields = ftbLine.getFields.deepclone\n  lstNumberFields = av.run(\"DCSewerDesign.Fields.returnNu
mberFields\",lstFields)\n  fldAccumulatedPopulation = MsgBox.choice(lstNumberFields, \"Select the Accumulated Population field.\"+NL+\n                              \"This field will be overwritten.\",\"DC Sewer Design\")\n  if(fldAccumulatedPopulation = nil)then\n    exit\n  end\n  fldAccumulatedPopulation = ftbLine.findField(fldAccumulatedPopulation.getName)\n  if(fldAccumulatedPopulation.getPrecision < 3)then\n    MsgBox.error(\"The Accumulated Population Field needs at least 3 digits after the decimal point.\",\"DC Sewer
 Design\")\n    exit\n  end\n  \n  fldPopulation = MsgBox.choice(lstNumberFields, \"Select the Population field.\",\"DC Sewer Design\")\n  if(fldPopulation = nil)then\n    exit\n  end\n \n fldShape = ftbLine.findField(\"Shape\")\n   \n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n 'give the user a chance to kill script\n av.showStopButton \n  \n ftbLine.setEditable(true)\n\nfor each recLine in ftbLine\n  ftbLine.setValue(fldAccumulatedPopulation,recLine, 0)\nend  \n\n  numCounter = 0 \n  numTotal = 
ftbLine.GetNumRecords \n\n  \nbmpCalculate = Bitmap.make(ftbLine.getNumRecords)\nbmpCalculate.setAll\nbmpCompleted = Bitmap.make(ftbLine.getNumRecords)\nbmpCompleted.setAll\n  \n  \n' loop until all lines are calculated  \nwhile(bmpCalculate.count > 0)\nnumPreventEndlessLoop = bmpCalculate.count\n  \n' run over all records in the table\n  for each recLine in bmpCalculate\n\n   ' get the Upstream Manhole\n    pllLine = ftbLine.returnValue(fldShape, recLine)\n    pntUpstreamManhole = pllLine.asList.get(0).get(0)\n    lstUpstrea
mLines = av.run(\"DCSewerDesign.Manhole.findUpstreamLines\",{ftbLine, pntUpstreamManhole})\n      \n'    numAccumulatedPopulation = ftbLine.returnValue(fldAccumulatedPopulation, recLine)\n    numAccumulatedPopulation = 0\n      \n    'check if all the upstream pipes have been calculated\n    blnReady = true\n    for each recConnectedLine in lstUpstreamLines\n'      if(bmpCalculate.get(recConnectedLine))then\n      if(ftbLine.returnValue(fldAccumulatedPopulation,recConnectedLine) <= 0)then\n        blnReady = false\n    
   ' break\n      else\n       'add the Handover AccumulatedPopulations\n        numPopulation = ftbLine.returnValue(fldAccumulatedPopulation, recConnectedLine)\n        if(numPopulation.isNull)then\n          numPopulation = 0\n        end\n        numAccumulatedPopulation = numAccumulatedPopulation + numPopulation\n      end\n    end\n      \n    if(blnReady)then    \n      'calculate the AccumulatedPopulation\n      numPopulation = ftbLine.returnValue(fldPopulation, recLine)\n      numAccumulatedPopulation = numAccumu
latedPopulation + numPopulation\n      numAccumulatedPopulation = numAccumulatedPopulation.max(0.001)\n      ftbLine.setValue(fldAccumulatedPopulation, recLine, numAccumulatedPopulation)             \n      bmpCompleted.clear(recLine)      \n      'update status display\n      if(av.setStatus((numCounter/numTotal)*100).not)then\n        'user hit the stop button\n        exit\n      end\n      numCounter = numCounter+1\n    end\n  end\n  \n  bmpCalculate.and(bmpCompleted)  \n  \n  if(numPreventEndlessLoop = bmpCalculate.c
ount)then\n    MsgBox.info(\"System leads to endless loop. Aborting.\",\"DC Sewer Design\")\n    exit\n  end\nend\n\n' check if script run was successful\n numSumPopulation = 0\n for each recLine in ftbLine\n   numSumPopulation = numSumPopulation + ftbLine.returnValue(fldPopulation, recLine)\n end  \n \n if(numSumPopulation <> numAccumulatedPopulation)then\n   Msgbox.info(\"Accumulated Population doesn't match the Sum of Population.\"+NL+\n   \"Script run might have failed. Check the System\",\"DC Sewer Design\")\n end\n \n ftbLine.s
etEditable(false)\n av.clearStatus\n"
	SearchStr:	"Flow"
	FontSize:	1
)

(DocWin.11
	Owner:	10
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.12
)

(DocAct.13
	Doc:	10
)

(SEd.14
	Name:	"DCSewerDesign.calculateMaximumManholeElevations"
	Creator:	"sdteffen"
	CreationDate:	"Sunday, February 27, 2000 02:04:06 PM"
	GUIName:	"Script"
	Win:	15
	CSMgr:	16
	DocExts:	17
	Source:	"' DCSewerDesign.calculateMaximumManholeElevations\n' (c) 2000, 2004, 2005 DORSCH Consult\n\n' Calculates the maximum Manhole levels, based on the elevations from\n' a point theme, according to the miminum cover provided\n' NOTE: This presumes that the lines are flipped to the Flow Direction\n' (use the function provided by DC Sewer Design)\n\n\n' get the table\n viewActive = av.GetActiveDoc\n \n \nlstThemes = viewActive.getActiveThemes\nthmLine = 0\nthmElevation = 0\nif(lstThemes.count = 2)then\n  for each thmTheme in lstTh
emes\n    if((thmTheme.getFTab.getShapeClass.getClassName = \"Polyline\")and\n      (thmTheme.getFTab.isEditable))then\n      thmLine = thmTheme\n    else \n      if(thmTheme.getFTab.getShapeClass.getClassName = \"Point\")then\n        thmElevation = thmTheme\n      end\n    end\n  end\nend\n\nftbLine = thmLine.getFTab\nfldLineShape = ftbLine.findField(\"Shape\")\n\nftbElevation = thmElevation.getFTab\nfldElevationShape = ftbElevation.findField(\"Shape\")\n\n' Get the line fields\nlstLineFields = ftbLine.getFields\nlstNumberFields = a
v.run(\"DCSewerDesign.Fields.returnNumberFields\",lstLineFields)\nfldMaxDownstreamElevation = Msgbox.choice(lstNumberFields, \"Select the downstream elevation field.\",\"DC Sewer Design\")\nif(fldMaxDownstreamElevation.asString = \"nil\")then\n  exit\nend\nfldMaxUpstreamElevation = Msgbox.choice(lstNumberFields, \"Select the upstream elevation field.\",\"DC Sewer Design\")\nif(fldMaxUpstreamElevation.asString = \"nil\")then\n  exit\nend\nfldGradient = Msgbox.choice(lstNumberFields, \"Select the gradient field.\",\"DC Sewer Design\")\n
if(fldGradient.asString = \"nil\")then\n  exit\nend\nfldMinimumCover = Msgbox.choice(lstNumberFields, \"Select the minimum cover field.\", \"DC Sewer Design\")\nif(fldMinimumCover.asString = \"nil\")then\n  exit\nend\n\n' Get the elevation field\nlstElevationFields = ftbElevation.getFields\nlstNumberFields = av.run(\"DCSewerDesign.Fields.returnNumberFields\", lstElevationFields)\nfldElevation = MsgBox.choice(lstNumberFields, \"Select the elevation field.\", \"DC Sewer Design\")\nif(fldElevation.asString = \"nil\")then\n  exit\nend\n\n' As
k for snapping radius\nstrSnappingRadius = MsgBox.input(\"Enter the snapping radius.\",\"DC Sewer Design\",\"5.0\")\nif(strSnappingRadius = nil)then\n  exit\nend\nnumSnappingRadius = strSnappingRadius.asNumber\nif(numSnappingRadius.isNull)then\n  exit\nend\n\n' 1 m should be fine for densification\nnumStepWidth = 1.0\n\n' Data for status display\nnumCounter = 0 \nnumTotal = ftbLine.getNumRecords\n\n'give the user a chance to kill script\n\nav.showStopButton \n\nfor each recLine in ftbLine\n  numGradient = ftbLine.returnValue(fldGradie
nt, recLine)\n  pllLine = ftbLine.returnValue(fldLineShape, recLine)\n  lstLine = pllLine.asList\n  numLength = pllLine.returnLength\n  numMaxDownstreamElevation = Number.makeNull\n  numMaxUpstreamElevation = Number.makeNull\n  if((lstLine.count = 1)and(lstLine.get(0).count = 2))then\n    numMinimumCover = ftbLine.returnValue(fldMinimumCover, recLine)\n    numMaxUpstreamElevation = 1000000.0\n    pntUpstream = pllLine.along(0.0)\n    \n    ' Densify the polyline\n    pllDense = pllLine.returnDensified(numStepWidth)\n   
 \n    ' Select elevation points within snapping radius\n    plgnBuffer = pllLine.returnBuffered(numSnappingRadius)\n    \n    ftbElevation.selectByPolygon(plgnBuffer, #VTAB_SELTYPE_NEW)\n    bmpSelection = ftbElevation.getSelection\n    for each recElevation in bmpSelection\n      pntElevation = ftbElevation.returnValue(fldElevationShape, recElevation)\n      numElevation = ftbElevation.returnValue(fldElevation, recElevation)\n      if(pntElevation.snap(pllDense, numSnappingRadius))then\n        numDistance = pntUps
tream.distance(pntElevation)\n        numUpstreamElevation = numElevation +  (numGradient * numDistance)\n        numMaxUpstreamElevation = numMaxUpstreamElevation.min(numUpstreamElevation)\n      end\n    end\n    if(numMaxUpstreamElevation = 1000000.0)then\n      numMaxUpstreamElevation = Number.makeNull\n    else\n      numMaxUpstreamElevation = numMaxUpstreamElevation - numMinimumCover\n      numMaxDownstreamElevation = numMaxUpstreamElevation - (numGradient * numLength)\n    end\n  end\n  ftbLine.setValue(fldMaxDo
wnstreamElevation, recLine, numMaxDownstreamElevation)\n  ftbLine.setValue(fldMaxUpstreamElevation, recLine, numMaxUpstreamElevation)\n\n  ' Update status display\n  numCounter = numCounter + 1 \n  if(av.setStatus((numCounter/numTotal)*100).not)then\n   ' User hit the stop button\n    exit\n  end\nend\n\n' Clean up\nav.clearStatus"
	FontSize:	1
)

(DocWin.15
	Owner:	14
	W:	801
	H:	972
)

(CSMgr.16
)

(DocAct.17
	Doc:	14
)

(SEd.18
	Name:	"DCSewerDesign.calculateMaximumManholeElevations.update"
	Creator:	"sdteffen"
	CreationDate:	"Montag, 24. Januar 2005 14:13:28"
	GUIName:	"Script"
	Win:	19
	CSMgr:	20
	DocExts:	21
	Source:	"' DCSewerDesign.calculateMaximumManholeElevations.update\n\n' (c) 2005 DORSCH Consult\n\n' Enable the Calculate Maximum Manhole Elevations menu when one Polyline and one\n' Point themes are activated and the Polyline theme is editable\n\nviewActive = av.getActiveDoc\nlstThemes = viewActive.getActiveThemes\nblnLine = false\nblnElevation = false\nif(lstThemes.count = 2)then\n  for each thmTheme in lstThemes\n    if((thmTheme.getFTab.getShapeClass.getClassName = \"Polyline\")and\n      (thmTheme.getFTab.isEditable))then\n     
 blnLine = true\n    else \n      if(thmTheme.getFTab.getShapeClass.getClassName = \"Point\")then\n        blnElevation = true\n      end\n    end\n  end\nend\n  \nif(blnLine and blnElevation)then\n  self.setEnabled(true)\nelse\n  self.setEnabled(false)\nend"
	FontSize:	1
)

(DocWin.19
	Owner:	18
	X:	799
	Y:	549
	W:	677
	H:	420
)

(CSMgr.20
)

(DocAct.21
	Doc:	18
)

(SEd.22
	Name:	"DCSewerDesign.calculateMinimumElevationDifferences"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 09:48:07 AM"
	GUIName:	"Script"
	Win:	23
	CSMgr:	24
	DocExts:	25
	Source:	"' DCSewerDesign.calculateMinimumElevationDifferences\n' (c) 2000 DORSCH Consult\n\n' Calculate the minimum Elevation differences in a sewer network.\n' This runs a network trace from the lowest point of the network\n' to the upper ends of all branches. There must be no network meshes\n' The downstream elevation should be 0 for all the records except for the\n' ones where the trace should start\n\n\n'inform what this is doing\nMsgbox.info(\"The downstream Elevation should be 0 for all the records except for lowest ones.
 This will calculate new upstream and downstream elevations based on a constant gradient\",\"DC Sewer Design\")\n\n' get the table\n viewActive = av.GetActiveDoc\n themeList = viewActive.GetThemes\n lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\") \n if (LineTheme.asString = \"nil\") then\n    exit\n end\n thmLine = viewActive.FindTheme(LineTheme.AsString)\n ftbLine = thmLine.GetFTab\n \n ' get the elevation
 fields\n lstFields = thmLine.getFTab.getFields\n fldDownstreamElevation = Msgbox.choice(lstFields, \"Select the Downstream Elevation Field.\",\"Select a Field\")\n if(fldDownstreamElevation.asString = \"nil\")then\n  exit\n end\n fldUpstreamElevation = Msgbox.choice(lstFields, \"Select the Upstream Elevation Field.\",\"Select a Field\")\n if(fldUpstreamElevation.asString = \"nil\")then\n  exit\n end\n\n fldShape = ftbLine.findField(\"Shape\")\n \n \n' ask the user to specify a gradient\nnumGradient = 0.02\nfldGradient = MsgBox.choice(l
stFields, \"Select Gradient Field\", \"DC Sewer Design\")\nif(fldGradient.asString = \"nil\")then\n  strGradient = msgbox.input(\"Enter the minimum gradient\",\"DC Sewer Design\",\"0.02\")\n  if (strGradient=nil)then\n    exit\n  end\n  numGradient=strGradient.asNumber\n  if(numGradient.isNull)then\n    exit\n  end\nend\n \n ' data for status display\n numCounter = 0 \n numTotal = ftbLine.GetNumRecords\n\n' give the user a chance to kill script\n av.showStopButton \n ftbLine.setEditable(true)\n \n ' The queue of lines for which the connec
tions will be searched\n stkQueue = Stack.make\n    \n 'run over all records in the table, find the startline(s)\n  for each recLine in ftbLine\n    'check if line has already been calculated\n    numDownstreamElevation = ftbLine.returnValue(fldDownstreamElevation, recLine)\n     if( numDownstreamElevation <> 0.0)then\n        stkQueue.push(recLine.clone)\n        numLength = ftbLine.returnValue(fldShape,recLine).returnLength\n        numUpstreamElevation = numDownstreamElevation + (numGradient * numLength)\n        f
tbLine.setValue(fldUpstreamElevation, recLine, numUpstreamElevation)\n        numCounter = numCounter+1\n     end\n  end\n  \nif(stkQueue.isEmpty)then\n  MsgBox.info(\"Did you set the downstream elevation at the lowest point?\",\"DC Sewer Design\")\n  exit\nend\n\n' loop until all lines are calculated  \nwhile(numCounter < numTotal)\n  if(stkQueue.isEmpty)then\n    ftbLine.setEditable(false)\n    av.clearStatus\n    Msgbox.info(\"Could not calculate all Elevations. System might not be fully connected.\",\"DC Sewer Design\")\n    e
xit\n  end\n  recStart = stkQueue.pop\n  lstConnectedLines = av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine, recStart})\n  numDownstreamElevation = ftbLine.returnValue(fldUpstreamElevation,recStart)\n\n  for each recLine in lstConnectedLines\n     if(fldGradient.asString <> \"nil\")then\n       numGradient = ftbLine.returnValue(fldGradient, recLine)\n     end\n     if(ftbLine.returnValue(fldDownstreamElevation,recLine) = 0.0)then\n       ' calculate the upstream elevation\n       numLength = ftbLine.returnValue(
fldShape,recLine).returnLength\n       numUpstreamElevation = numDownstreamElevation + (numGradient * numLength)\n      ftbLine.setValue(fldDownstreamElevation, recLine, numDownstreamElevation)\n       ftbLine.setValue(fldUpstreamElevation, recLine, numUpstreamElevation)\n       numCounter = NumCounter+1\n       stkQueue.push(recLine.clone)\n             \n       ' update status display\n       if(av.setStatus((numCounter/numTotal)*100).not)then\n        ' user hit the stop button\n         exit\n       end\n     end\n 
 end \nend\n\nftbLine.setEditable(false)\nav.clearStatus\n"
	FontSize:	1
)

(DocWin.23
	Owner:	22
	X:	801
	W:	801
	H:	533
)

(CSMgr.24
)

(DocAct.25
	Doc:	22
)

(SEd.26
	Name:	"DCSewerDesign.ComplexProfile.addManholeLegend"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 28. Januar 2005 11:02:00"
	GUIName:	"Script"
	Win:	27
	CSMgr:	28
	DocExts:	29
	Source:	"'DCSewerDesign.ComplexProfile.addManholeLegend\n\n' Adds the manholes with a given legend to the profile\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied warr
anty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nviewProfile = self.get(0)\nif(viewProfile.is(View).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: First Argument is not a view.\",\"DC Sewer
 Design\")\n  exit\nend\n\nftbManhole = self.get(1)\nif(ftbManhole.is(FTab).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Second Argument is not an FTab.\",\"DC Sewer Design\")\n  exit\nend\n\nstrLegend = self.get(2)\nif(strLegend.is(String).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Third Argument is not a String.\",\"DC Sewer Design\")\n  exit\nend\n\nlstProfileManholes = self.get(3)\nif(lstProfileManholes.is(List).not)then\n  MsgBox.error(\"DCSewerDesign.C
omplexProfile.addManholeLegend(): ERROR: Fourth Argument is not a list.\", \"DC Sewer Design\")\n  exit\nend\n\nfldManholeInvertLevel = self.get(4)\nif(fldManholeInvertLevel.is(Field).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Fifth Argument is not a Field.\", \"DC Sewer Design\")\n  exit\nend\n\nftbLine = self.get(5)\nif(ftbLine.is(FTab).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Sixth argument is not an FTab.\", \"DC Sewer Design\")\n  exit\nend\n\nlstP
rofileLines = self.get(6)\nif(lstProfileLines.is(List).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Seventh argument is not a List.\", \"DC Sewer Design\")\n  exit\nend\n\n' Copy layout manholes including all attributes - this allows to apply legend\n\nflnProfileManhole = av.getProject.getWorkDir.makeTmp(\"manhole\",\"shp\")\nftbProfileManhole = ftbManhole.export(flnProfileManhole, Shape, false)\nif(ftbProfileManhole.is(FTab).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManho
leLegend(): ERROR: Export of \"+ftbManhole.asString.quote+\" failed.\", \"DC Sewer Design\")\n  exit\nend\n\n' Draw manholes (shift to correct location)\nftbProfileManhole.setEditable(true)\nfldProfileManholeShape = ftbProfileManhole.findField(\"shape\")\nfldLineShape = ftbLine.findField(\"shape\")\nnumX = 1000.0\nnumY = 1000.0\nfor each i in 0..(lstProfileManholes.count-1)\n  recManhole = lstProfileManholes.get(i)\n  numInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recManhole)\n  pntProfileManhole = Point.make(num
X, numY+(numInvertLevel*10))\n  ftbProfileManhole.setValue(fldProfileManholeShape, recManhole, pntProfileManhole)\n  if(i < lstProfileLines.count)then\n    numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n  end\nend\nftbProfileManhole.setEditable(false)\n\nthmProfileManhole = FTheme.make(ftbProfileManhole)\nviewProfile.addTheme(thmProfileManhole)\nflnLegend = Filename.make(strLegend)\nif(flnLegend.is(Filename).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend():
 ERROR: Could not open file \"+strLegend.quote+\".\", \"DC Sewer Design\")\n  exit\nend\nlgdProfileManhole = thmProfileManhole.getLegend\nif(lgdProfileManhole.load(flnLegend, #LEGEND_LOADTYPE_ALL).not)then\nMsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Could not load legend \"+strLegend.quote+\".\", \"DC Sewer Design\")\n  exit\nend\nthmProfileManhole.updateLegend\nthmProfileManhole.setVisible(true)"
	FontSize:	1
)

(DocWin.27
	Owner:	26
	W:	801
	H:	972
)

(CSMgr.28
)

(DocAct.29
	Doc:	26
)

(SEd.30
	Name:	"DCSewerDesign.ComplexProfile.create"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 18:30:03"
	GUIName:	"Script"
	Win:	31
	CSMgr:	32
	DocExts:	33
	Source:	"' DCSewerDesign.ComplexProfile.create\n\n' creates a longitudinal section for the selected lines\n\n' called from the DC Sewer menu\n\n' (c) 2000 - 2005 DORSCH Consult\n\n' TODO: remove dc_id dependency\n\n' adjustment to control elevation of profile above data boxes\nnumAdjustment = 15\n\nextSewer = Extension.find(\"DC Sewer Design\")\ndicPreferences = extSewer.getPreferences\nstrConfigurationFile = dicPreferences.get(\"strComplexProfileConfigurationFile\")\nwhile(strConfigurationFile = nil)\n  av.run(\"DCSewerDesign.ComplexPro
file.selectConfigurationFile\", nil)\n  strConfigurationFile = dicPreferences.get(\"strComplexProfileConfigurationFile\")\nend\n\n' open the configuration file\n\nlnfConfiguration = LineFile.make(strConfigurationFile.asFilename, #FILE_PERM_READ)\n\nfldManholeID=nil\nfldManholeDiameter=nil\nfldManholeInvertLevel=nil\nfldManholeElevation=nil\nfldLineID = nil\nfldLineDiameter = nil\nfldLineUpstreamInvert = nil\nfldLineDownstreamInvert = nil\nstrLineTheme = nil\nstrManholeTheme = nil\nintDatumInterval = nil\nfldLineDcId = nil\nstrMan
holeLegend = nil\n\n' first configuration file run to locate theme names\n\nstrLine=lnfConfiguration.readElt\n'process the configuration file \nwhile (not (strLine=nil ))\n  lstConfTokens = strLine.asTokens(\"=\")\n  if(lstConfTokens.count=2)then\n    strScriptFieldName = lstConfTokens.get(0).trim.lcase\n    strTableFieldName = lstConfTokens.get(1).trim.lcase\n    if(strScriptFieldName = \"line.theme\")then\n      strLineTheme = strTableFieldName\n    elseif(strScriptFieldName = \"manhole.theme\")then\n      strManholeTheme = 
strTableFieldName\n    elseif(strScriptFieldName = \"manhole.legend\")then\n      strManholeLegend = strTableFieldName  \n    end\n  end\n  strLine = lnfConfiguration.readElt\nend\n \n' close the configuration file\nlnfConfiguration.close\n \n' get the line table\n\nthmLine = nil\nviewActive = av.getActiveDoc\nthemeList = viewActive.getThemes\nlstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\nfor each thmTheme in lstLineThemes\n  if((strLineTheme <> nil)and(strLineTheme.lcase = thmTheme.getName.lca
se))then\n    thmLine = thmTheme\n    break\n  end\n  if(thmTheme.getName.left(6) <> \"Profil\")then\n    lstLineThemes.shuffle(thmTheme, 0)\n    break\n  end\nend\nif(thmLine.asString = \"nil\")then\n  thmLine = Msgbox.Choice (lstLineThemes, \"Select the Sewer Line Theme.\", \"DC Sewer - Complex Profile\")   \nend\nif(thmLine.asString = \"nil\") then\n  exit\nend\nftbLine = thmLine.GetFTab \nfldLineDcId = ftbLine.findField(\"dc_id\")\nif(fldLineDcId.asString = \"nil\")then\n  MsgBox.error(\"Error: Field Line.DC_ID was not found.\",\"DC Sewe
r Design\")\n  exit\nend\n\n' get the manhole table\nthmManhole = nil\nlstManholeThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\nfor each thmTheme in lstManholeThemes\n  if((strManholeTheme <> nil)and(strManholeTheme.lcase = thmTheme.getName.lcase))then\n    thmManhole = thmTheme\n    break\n  end\nend\nif(thmManhole.asString = \"nil\")then\n  thmManhole = Msgbox.Choice (lstManholeThemes, \"Select the Manhole Theme.\", \"DC Sewer - Complex Profile\")\nend\nif (thmManhole.asString = \"nil\") then\n  exit\nend\n
ftbManhole = thmManhole.GetFTab \n\nlstProfileLines = av.run(\"DCSewerDesign.Profile.buildLineList\", {ftbLine, fldLineDcId})\nlstProfileManholes =av.run(\"DCSewerDesign.Profile.buildNodeList\", {ftbLine, ftbManhole, lstProfileLines})\n\nlstFreeLineFields = List.make\nlstFreeManholeFields = List.make\nlstFreeCumulativeLineFields = List.make\n\nlstFreeFields = {{\"linedata\",lstFreeLineFields},\n  {\"manholedata\",lstFreeManholeFields},\n  {\"cumulativelinedata\",lstFreeCumulativeLineFields}}\n\n' second configuration file run\nlnf
Configuration = LineFile.make(strConfigurationFile.asFilename, #FILE_PERM_READ)\nstrLine=lnfConfiguration.readElt\nwhile (not (strLine=nil ))\n  lstConfTokens = strLine.asTokens(\"=\")\n  if(lstConfTokens.count=2)then\n    strScriptFieldName = lstConfTokens.get(0).trim.lcase\n    strTableFieldName = lstConfTokens.get(1).trim.lcase\n    if(strScriptFieldName = \"manhole.id\")then\n      fldManholeID=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"manhole.diameter\")then\n      fldManholeDiamet
er=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"manhole.invertlevel\")then\n      fldManholeInvertLevel=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"manhole.elevation\")then\n      fldManholeElevation=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.diameter\")then\n      fldLineDiameter = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.id\")then\n      fldLineID = ftbLine.findField(strTab
leFieldName)\n    end\n    if(strScriptFieldName = \"line.upstreaminvert\")then\n      fldLineUpstreamInvert = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.downstreaminvert\")then\n      fldLineDownstreamInvert = ftbLine.findField(strTableFieldName)\n    end\n    if((strScriptFieldName = \"datuminterval\")and(strTableFieldName.isnumber))then\n      intDatumInterval = strTableFieldName.asNumber.truncate\n    end\n    for each lstFreeField in lstFreeFields\n      if(strScriptFieldName = lst
FreeField.get(0))then\n        lstFieldTokens = strTableFieldName.asTokens(\"@\")\n        if(lstFieldTokens.count = 5)then\n          strJustificationToken = lstFieldTokens.get(4)\n          intJustification = #TEXTCOMPOSER_JUST_LEFT\n          if(strJustificationToken = \"center\")then\n            intJustification = #TEXTCOMPOSER_JUST_CENTER\n          elseif(strJustificationToken = \"right\")then\n            intJustification = #TEXTCOMPOSER_JUST_RIGHT\n          end\n          lstFree = {lstFieldTokens.get(0),lstField
Tokens.get(1).asNumber,\n            lstConfTokens.get(1).asTokens(\"@\").get(2), lstFieldTokens.get(3).asNumber, intJustification.clone}\n          lstFreeField.get(1).add(lstFree)      \n        end\n      end \n    end\n  end\n  strLine = lnfConfiguration.readElt\nend\nlnfConfiguration.close\n\n' Check configuration\nif(fldManholeID = nil)then\n  MsgBox.error(\"Error: Field Manhole.ID was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldManholeDiameter = nil)then\n  MsgBox.error(\"Error: Field Manhole.Diameter was not foun
d.\",\"DC Sewer Design\")\n  exit\nend\nif(fldManholeInvertLevel = nil)then\n  MsgBox.error(\"Error: Field Manhole.InvertLevel was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldManholeElevation = nil)then\n  MsgBox.error(\"Error: Field Manhole.Elevation was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineID = nil)then\n  MsgBox.error(\"Error: Field Line.ID was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineDiameter = nil)then\n  MsgBox.error(\"Error: Field Line.Diameter was not found.\",\"DC Sewer Design\")\n  exi
t\nend\nif(fldLineUpstreamInvert = nil)then\n  MsgBox.error(\"Error: Field Line.UpstreamInvert was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineDownstreamInvert = nil)then\n  MsgBox.error(\"Error: Field Line.DownstreamInvert was not found.\",\"DC Sewer Design\")\n  exit\nend\n\nfldManholeShape = ftbManhole.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\n\nflnProfile = av.getProject.getWorkDir.makeTmp(\"profile\",\"shp\")\nftbProfile = FTab.makeNew(flnProfile,PolyLine)\n\nftbProfile.setEditable(true)\nfldProfi
leShape = ftbProfile.findField(\"Shape\")\nftbProfile.addFields({Field.make(\"id\", #FIELD_DECIMAL, 4, 0),\n  Field.make(\"style\",#FIELD_CHAR,16,0),\n  Field.make(\"dc_id\", #FIELD_CHAR, 16, 0)})\nfldProfileStyle = ftbProfile.findField(\"style\")\nfldProfileDcId = ftbProfile.findField(\"dc_id\")\n\npntManhole = ftbManhole.returnValue(fldManholeShape, lstProfileManholes.get(0))\npllLine = ftbLine.returnValue(fldLineShape, lstProfileLines.get(0))\nif(pntManhole.distance(pllLine.along(0)) > 0.1)then\n   lstProfileManholes = av.run
(\"DCSewerDesign.List.flip\", lstProfileManholes)\n   lstProfileLines = av.run(\"DCSewerDesign.List.flip\", lstProfileLines)\nend\n\n' create the profile view\nstrFirstManhole = ftbManhole.returnValue(fldManholeID, lstProfileManholes.get(0)).asString\nstrLastManhole = ftbManhole.returnValue(fldManholeID, lstProfileManholes.get(lstProfileManholes.count-1)).asString\nstrViewName = \"Profile\"++strFirstManhole++\"-\"++strLastManhole\nlstViews = av.getProject.getDocsWithGUI(av.findGUI(\"View\"))\nfor each viewCheck in lstViews\n  
if(viewCheck.getName = strViewName)then\n    blnOverwrite = MsgBox.yesNo(\"A view named'\"+strViewName+\"' already exists.\"+NL+\"Overwrite it?\", \"DC Sewer Design\", true)\n    if(blnOverwrite)then\n      av.getProject.removeDoc(av.getProject.findDoc(strViewName))      \n    else\n      exit\n    end\n  end\nend\nviewProfile = View.make\nviewProfile.setName(strViewName)\nviewProfile.getWin.activate\n\nviewProfile.setUnits(#UNITS_LINEAR_METERS)\nviewProfile.getDisplay.setDistanceUnits(#UNITS_LINEAR_METERS)\nviewProfile.getDispla
y.zoomToScale(1000)\n\n' draw manholes\n\nnumX = 1000.0\nnumY = 1000.0\nfor each i in 0..(lstProfileManholes.count-1)\n  recProfile = ftbProfile.addRecord\n  recManhole = lstProfileManholes.get(i)\n  numDiameter = ftbManhole.returnValue(fldManholeDiameter, recManhole)\n  numInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recManhole)\n  numElevation = ftbManhole.returnValue(fldManholeElevation, recManhole)\n  pntLowerLeft = Point.make(numX-(numDiameter/2000), numY+(numInvertLevel*10))\n  pntUpperLeft = Point.
make(numX-(numDiameter/2000), numY+(numElevation*10))\n  pntUpperRight = Point.make(numX+(numDiameter/2000), numY+(numElevation*10))\n  pntLowerRight = Point.make(numX+(numDiameter/2000), numY+(numInvertLevel*10))\n  pllManhole = Polyline.make({{pntLowerLeft,pntUpperLeft,pntUpperRight, pntLowerRight, pntLowerLeft}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllManhole)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n      \n  ' Draw connecting lines\n  if((i <> 0)and(i<>(lstProfileManholes.co
unt-1)))then\n    pntManhole = ftbManhole.returnValue(fldManholeShape, recManhole)\n    ftbLine.selectByPoint(pntManhole, 0.001, #VTAB_SELTYPE_NEW)\n    lstConnected = List.make\n    for each recLine in ftbLine.getSelection\n      if(lstProfileLines.findByValue(recLine) = (-1))then\n        numLineInvert = ftbLine.returnValue(fldLineDownstreamInvert, recLine)\n        numLineDiameter = ftbLine.returnValue(fldLineDiameter, recLine)\n        blnAdded = false\n        for each lstConnection in lstConnected\n          if
((numLineDiameter = lstConnection.get(1) and (numLineInvert = lstConnection.get(2))))then\n            lstConnection.set(0, lstConnection.get(0)+1)\n            blnAdded = true\n          end\n        end\n        if(blnAdded = false)then\n          lstConnected.add({1,numLineDiameter,numLineInvert})\n        end\n        shpCircle = Circle.make(Point.make(numX, numY+(numLineInvert*10)+(numLineDiameter/200)), numLineDiameter/200)\n        plgnCircle = shpCircle.asPolygon\n        pllCircle = plgnCircle.asPolyline\n   
     recCircle = ftbProfile.addRecord\n        ftbProfile.setValue(fldProfileShape, recCircle, pllCircle)\n        ftbProfile.setValue(fldProfileStyle, recCircle, \"normal\")\n      end\n    end\n    numHeight = 0\n    for each lstConnection in lstConnected\n      numConnections = lstConnection.get(0)\n      numLineDiameter = lstConnection.get(1)\n      numLineInvert = lstConnection.get(2)\n      pntConnection = Point.make(numX, numY+(numLineInvert*10)+(numLineDiameter/100))\n      pllMark = Line.make(pntConnection, pnt
Connection.clone.move(0, 35)).asPolyLine\n      pllMark = pllMark.returnUnion(Line.make(pntConnection, pntConnection.clone.move(-3, 4)).asPolyLine)\n      pllMark = pllMark.returnUnion(Line.make(pntConnection, pntConnection.clone.move(3, 4)).asPolyLine)\n      recProfile = ftbProfile.addRecord\n      ftbProfile.setValue(fldProfileShape, recProfile, pllMark)\n      ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n      pntIDLocation = Point.make(numX, numY+10+(numElevation*10)+numHeight)\n      numPositi
on = numX\n      strConnectionText = \"DN \"+numLineDiameter.asString+NL+numLineInvert.asString\n      if(numConnections <> 1)then\n        strConnectionText = numConnections.asString++strConnectionText\n      end\n      gtxIDLabel = GraphicText.make(strConnectionText, pntIDLocation)\n      gtxIDLabel.setAngle(90)\n      viewProfile.getGraphics.add(gtxIDLabel)\n      tpsID = TextPositioner.make(Point)\n      tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n      tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_TOP)\n      tpsID.Ca
lculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n      numHeight = numHeight + gtxIDLabel.getExtent.getY + 3\n      gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n      for each symText in gtxIDLabel.returnSymbols\n        viewProfile.getDisplay.hookupSymbol(symText)\n      end\n    end\n  end\n  \n  if(i < lstProfileLines.count)then\n    numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n  end\nend\n\n' draw lines\n\nnumMinInvertElevation = 9999\nnumMaxGroundElevation = -9999\n\nnumX = 1000.0\nf
or each i in 0..(lstProfileLines.count-1)\n  recProfile = ftbProfile.addRecord\n  recLine = lstProfileLines.get(i)\n  recUpstreamManhole = lstProfileManholes.get(i)\n  recDownstreamManhole = lstProfileManholes.get(i+1)\n  numLineDiameter = ftbLine.returnValue(fldLineDiameter, recLine)\n  numUpstreamManholeDiameter = ftbManhole.returnValue(fldManholeDiameter, recUpstreamManhole)\n  numDownstreamManholeDiameter = ftbManhole.returnValue(fldManholeDiameter, recDownstreamManhole)\n  numUpstreamInvertLevel = ftbLine.retu
rnValue(fldLineUpstreamInvert, recLine)\n  numDownstreamInvertLevel = ftbLine.returnValue(fldLineDownstreamInvert, recLine)\n  numMinInvertElevation = numMinInvertElevation.min(numUpstreamInvertLevel.min(numDownstreamInvertLevel)).clone\n  pllLine = ftbLine.returnValue(fldLineShape, recLine)\n  numLineLength = pllLine.returnLength\n  pntUpstreamInvert = Point.make(numX+(numUpstreamManholeDiameter/2000), numY+(numUpstreamInvertLevel*10))\n  pntDownstreamInvert=Point.make(numX+numLineLength-(numDownstreamManholeDia
meter/2000), numY+(numDownstreamInvertLevel*10))\n  pllInvert = Polyline.make({{pntUpstreamInvert, pntDownstreamInvert}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllInvert)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n  recProfile = ftbProfile.addRecord\n  pntUpstreamUpperLevel = pntUpstreamInvert+Point.make(0,numLineDiameter/100)\n  pntDownstreamUpperLevel = pntDownstreamInvert+Point.make(0,numLineDiameter/100)\n  pllUpper = Polyline.make({{pntUpstreamUpperLevel, pntDownstreamUpperLev
el}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllUpper)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n  recProfile = ftbProfile.addRecord\n  numUpstreamElevation = ftbManhole.returnValue(fldManholeElevation, recUpstreamManhole)\n  numDownstreamElevation = ftbManhole.returnValue(fldManholeElevation, recDownstreamManhole)\n  numMaxGroundElevation = numMaxGroundElevation.max(numUpstreamElevation.max(numDownstreamElevation)).clone\n  pntUpstreamElevation = Point.make(numX+(numUpstreamManhol
eDiameter/2000), numY+(numUpstreamElevation*10))\n  pntDownstreamElevation = Point.make(numX+numLineLength-(numDownstreamManholeDiameter/2000), numY+(numDownstreamElevation*10))\n  pllElevation = Polyline.make({{pntUpstreamElevation, pntDownstreamElevation}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllElevation)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n  strDcId = ftbLine.returnValue(fldLineDcId, recLine)\n  ftbProfile.setValue(fldProfileDcId, recProfile, strDcId)\n  \n  numX = numX 
+ numLineLength\nend\n\n' Draw manhole center lines\nnumX = 1000.0\nfor each i in 0..(lstProfileManholes.count-1)\n  recManhole = lstProfileManholes.get(i)\n  numElevation = ftbManhole.returnValue(fldManholeElevation, recManhole)\n  recProfile = ftbProfile.addRecord\n  pntCenterlineStart = Point.make(numX, numY+(numElevation*10))\n  pntCenterlineEnd = Point.make(numX, numY+(numMinInvertElevation*10)-12-numAdjustment)\n  pllManholeCenterline = Polyline.make({{pntCenterlineStart, pntCenterlineEnd}})\n  ftbProfile.setValu
e(fldProfileShape, recProfile, pllManholeCenterline)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  if(i < lstProfileLines.count)then\n    numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n  end\n \nend\n\nnumTotalLength = numX - 1000.0\nnumX = 1000.0\nnumY = numY + (numMinInvertElevation*10)-12-numAdjustment\n\nfor each lstFreeField in lstFreeManholeFields\n  fldFree = ftbManhole.findField(lstFreeField.get(0))\n  if(fldFree <> nil)then\n    numY = av.run(\"DCSewerDesign
.Profile.ManholeDataBox.create\", {ftbProfile, ftbLine, ftbManhole, viewProfile, 1000.0, numY, fldFree, lstFreeField.get(2), lstProfileManholes, lstProfileLines, lstFreeField.get(1), true, lstFreeField.get(3), lstFreeField.get(4)})\n  else\n    System.echo(\"Could not find field \"+lstFreeField.get(0)+\" in manhole table.\")\n  end\nend\n\nfor each lstFreeField in lstFreeLineFields\n  fldFree = ftbLine.findField(lstFreeField.get(0))\n  if(fldFree <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.LineDataBox.create\", 
{ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldFree, lstFreeField.get(2), lstProfileLines, lstFreeField.get(1),lstFreeField.get(3), lstFreeField.get(4)})\n  else\n    System.echo(\"Could not find field \"+lstFreeField.get(0)+\" in line table.\")\n  end\nend\n\nfor each lstFreeField in lstFreeCumulativeLineFields\n  fldFree = ftbLine.findField(lstFreeField.get(0))\n  if(fldFree <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.CumulativeLineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldFre
e, lstFreeField.get(2), lstProfileLines, lstFreeField.get(1),lstFreeField.get(3), lstFreeField.get(4)})\n  else\n    System.echo(\"Could not find field \"+lstFreeField.get(0)+\" in line table.\")\n  end\nend\n \n' draw bounding box\n\nnumBoundingBoxTop = 1000 + (numMinInvertElevation*10)-8-numAdjustment  \npntBoundingBoxOrigin = Point.make(1000-60, numY)\npntBoundingBoxSize = Point.make(numTotalLength+60+20, numBoundingBoxTop-numY-4)\npllBoundingBox = Rect.make(pntBoundingBoxOrigin, pntBoundingBoxSize).asPolygon.asPolylin
e\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllBoundingBox)\nftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n' draw datum lines if necessary\nif((intDatumInterval.asString <> \"nil\")and(numMinInvertElevation < numMaxGroundElevation))then\n  numFirstDatumLine = ((numMinInvertElevation/intDatumInterval).truncate)*intDatumInterval\n  numLastDatumLine = (((numMaxGroundElevation/intDatumInterval).truncate)*intDatumInterval)+intDatumInterval\n  for each numDatumLine in
 numFirstDatumLine..numLastDatumLine by intDatumInterval\n    ' The next line should use numY instead of 1000\n    pllDatum = Polyline.make({{1000@((numDatumLine*10)+1000), (1000+numTotalLength)@((numDatumLine*10)+1000)}})\n    recDatum = ftbProfile.addRecord\n    ftbProfile.setValue(fldProfileShape, recDatum, pllDatum)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  \n    ' Datum Label\n    pntIDLocation = Point.make(999, (numDatumLine*10)+1000)\n    gtxIDLabel = GraphicText.make(numDatumLine.asS
tring, pntIDLocation)\n'      gtxIDLabel.setAngle(90)\n      viewProfile.getGraphics.add(gtxIDLabel)\n      tpsID = TextPositioner.make(Point)\n      tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_LEFT)\n      tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n      tpsID.Calculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n      gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n      for each symText in gtxIDLabel.returnSymbols\n        viewProfile.getDisplay.hookupSymbol(symText)\n      end\n  end \n  ' draw side lines\n  pllDatum = Polylin
e.make({{1000@((numFirstDatumLine*10)+1000), (1000)@((numLastDatumLine*10)+1000)}})\n  recDatum = ftbProfile.addRecord\n  ftbProfile.setValue(fldProfileShape, recDatum, pllDatum)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  pllDatum = Polyline.make({{(1000+numTotalLength)@((numFirstDatumLine*10)+1000), (1000+numTotalLength)@((numLastDatumLine*10)+1000)}})\n  recDatum = ftbProfile.addRecord\n  ftbProfile.setValue(fldProfileShape, recDatum, pllDatum)\n  ftbProfile.setValue(fldProfileStyle, recPro
file, \"normal\")\nend\n\nftbProfile.setEditable(false)\nthmProfile = FTheme.make(ftbProfile)\nviewProfile.addTheme(thmProfile)\nlgdProfile = thmProfile.getLegend\nlgdProfile.setLegendType(#LEGEND_TYPE_UNIQUE)\nlgdProfile.unique(thmProfile, \"style\")\nfor each symUnique in lgdProfile.getSymbols\n  symUnique.setColor(Color.getBlack)\nend\nlgdProfile.getSymbols.get(0).setSize(1)\nthmProfile.updateLegend\n\n' Add manholes with given legend if \"Manhole.Legend\" was given in configuration file\nif(strManholeLegend <> nil)then\n  av.
run(\"DCSewerDesign.ComplexProfile.addManholeLegend\", {viewProfile, ftbManhole, strManholeLegend, lstProfileManholes, fldManholeInvertLevel, ftbLine, lstProfileLines})\nend\n\nav.clearStatus\nthmProfile.setVisible(true) \nrctExtent = viewProfile.returnExtent\nviewProfile.getDisplay.setExtent(rctExtent.Scale(1.1))\n\nav.getProject.setModified(true)  "
	SearchStr:	"get"
	FontSize:	1
)

(DocWin.31
	Owner:	30
	W:	837
	H:	400
)

(CSMgr.32
)

(DocAct.33
	Doc:	30
)

(SEd.34
	Name:	"DCSewerDesign.ComplexProfile.selectConfigurationFile"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 18:49:38"
	GUIName:	"Script"
	Win:	35
	CSMgr:	36
	DocExts:	37
	Source:	"' DCSewerDesign.ComplexProfile.selectConfigurationFile\n\n' (c) 2004 DORSCH Consult\n\n' select the configuration file and save it as a preference\n\n' information about the configuration file\nMsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"Manhole.ID=???    Manhole.Diameter=???\"+NL+\n  \"Manhole.InvertLevel = ??? Manhole.Elevation = ???\"+NL+\n  \"Line.Diameter=???, Line.Gradient=???, Line.MaximumFlow=???\"\n  ,\"Complex Field Configuration File\")\n\n\nlstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text File
s (*.txt)\"},\"Select Configuration File\",0)\nif(lstConfFiles.count = 0 )then\n  exit\nend\nstrFile = lstConfFiles.get(0).asString\nextSewer = Extension.find(\"DC Sewer Design\")\ndicPreferences = extSewer.getPreferences\ndicPreferences.set(\"strComplexProfileConfigurationFile\", strFile)\n\n"
	FontSize:	1
)

(DocWin.35
	Owner:	34
	X:	837
	Y:	400
	W:	837
	H:	400
)

(CSMgr.36
)

(DocAct.37
	Doc:	34
)

(SEd.38
	Name:	"DCSewerDesign.createDbfSewerCalculation"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 30. Mai 2000 12:27:29"
	GUIName:	"Script"
	Win:	39
	CSMgr:	40
	DocExts:	41
	Source:	"' DCSewerDesign.createDbfSewerCalculation\n\n' Create an Dbf table containing the Sewerage Calculation\n\n' (c) 2000, 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied 
warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nblnDebug = false\n\n' Try to find configuration file in preferences\n\nextSewer = Extension.find(\"DC Sewer Design\")\n\ndicPreferences = extSewer.getPreferences\n \nstrDbfCalcu
lationConfig = dicPreferences.get(\"strDbfCalculationConfig\")\nflnConfiguration = nil\nif(strDbfCalculationConfig = nil)then \n  ' Information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n    \"PipeID=???    Diameter=??? PerPerson=???\"+NL+\n    \"Gradient=???    Roughness=???\"+NL+\n    \"AccumulatedPopulation=???   PeakFactor=???\"\n    ,\"Field Configuration File\")\n    \n  'get the configuration file\n    lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"S
elect Configuration File\",0)\n   if(lstConfFiles.count = 0 )then\n     exit\n   end\n   flnConfiguration = lstConfFiles.get(0)\n   dicPreferences.set(\"strDbfCalculationConfig\", flnConfiguration.getFullName)\nelse\n  flnConfiguration = FileName.make(strDbfCalculationConfig)\nend\n\n' Get the table\n  viewActive = av.getActiveDoc \n  \nstrLineTheme = dicPreferences.get(\"strDbfCalculationTheme\")\nif(strLineTheme = nil)then\n  themeList = viewActive.getThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes
\", themeList)\n  LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  strLineTheme = LineTheme.asString\n  dicPreferences.set(\"strDbfCalculationTheme\", strLineTheme)\nend\n  thmLine = viewActive.findTheme(strLineTheme)   \n  ftbLine = thmLine.getFTab \n\n 'open the configuration file\n lnfConfiguration = LineFile.make(flnConfiguration, #FILE_PERM_READ)\n\n fldPipeID=nil\n fldDiameter=nil\n fldGradient=nil\n fldRoughness=nil\n fl
dPopulation=nil\n strPeakFactorFormula=\"1\"\n strLitersPerDayAndPerson=nil\n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"pipeid\")then\n        fldPipeID=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"diameter\")t
hen\n        fldDiameter=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"gradient\")then\n        fldGradient=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"roughness\")then\n        fldRoughness=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"accumulatedpopulation\")then\n        fldPopulation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"peakfactor\")then\n        if(strTableFieldName.isNumber
)then\n          strPeakFactorFormula=strTableFieldName\n        else\n          if(strTableFieldName.ucase =\"BAUMANN\")then\n            strPeakFactorFormula = \"BAUMANN\" \n          elseif(strTableFieldName.ucase = \"BABITT\")then\n            strPeakFactorFormula = \"BABITT\" \n          else\n            Msgbox.info(\"Unknown Peak Factor Formula.\"+NL+\n            \"Baumann and Babitt are valid.\"+NL+\n            \"Using constant peak factor 1.\",\"DC Sewer Design\")\n          end\n        end\n      end\n      if(strScriptFiel
dName = \"perperson\")then\n        strLitersPerDayAndPerson = strTableFieldName\n      end\n    end\n    strLine = lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n \n 'get information\n 'strLitersPerDayAndPerson = MsgBox.input(\"Sewage flow per person and day\",\"DC Sewer Design\",\"120\")\n 'if(strLitersPerDayAndPerson = nil)then\n '  exit\n 'end\n \n 'check if configuration was successful\n  if((fldPipeID=nil)or(fldDiameter=nil)or(fldGradient=nil)or(fldRoughness=nil)\n  or(fldPopulation
=nil)or(strLitersPerDayAndPerson=nil))then\n    MsgBox.error(\"Field matching not successful. Check your table and configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n\n' Request approval\n\nblnApproval = MsgBox.LongYesNo(\"Create a calculation for \"+strLineTheme.quote+\n  \" using the configuration from \"+flnConfiguration.getFullName.quote+\n  \". Selecting no will allow you to select the configuration again.\", \"DC Sewer Design\", true)\nif(blnApproval.not)then\n  dicPreferences.remove(\"strDbfCalculationConfig\")\n  d
icPreferences.remove(\"strDbfCalculationTheme\")\nend\n ' create DBF-File\n  flnDbfFile = FileDialog.put(\"\".asFilename.makeTmp(\"sewer_calculation\",\"dbf\"), \"*.dbf\", \"Save Calculation file\")\n  if(flnDbfFile = nil )then\n   exit\n  end\n  vtbCalc = vtab.makeNew(flnDbfFile, dBase) \n  vtbCalc.setEditable(true)\n  \n  \n  'create fields\n  \n  List lstFields = List.make\n  \n  lstFields.add(Field.make(\"Pipe_ID\", fldPipeID.getType, fldPipeID.getWidth, fldPipeID.getPrecision))\n  lstFields.add(Field.make(\"DN\", #FIELD_SHORT, 4, 0))
\n  lstFields.add(Field.make(\"I\", #FIELD_DECIMAL, 16, 10))\n  lstFields.add(Field.make(\"roughness\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"Popul\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"f_peak\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"flow\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"max_flow\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"v_full\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"v_free\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.mak
e(\"used\", #FIELD_DECIMAL, 16, 8))\n\n  vtbCalc.addFields(lstFields)\n  \n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n'calculation data\n \n 'give the user a chance to kill script\n av.showStopButton \n  \n  numLitersPerDayAndPerson = strLitersPerDayAndPerson.asNumber\n  \n'run over all records in the table\n  for each recLine in ftbLine\n    strRowNumber = (numCounter+3).asString.Trim\n    strRow=\"R\"+strRowNumber\n  \n    recCalc = vtbCalc.addRecord\n    \n    vtbCalc.setValue(lstFields.
get(0), recCalc, ftbLine.returnValue(fldPipeID,recLine))     \n    numDiameter = ftbLine.returnValue(fldDiameter,recLine)\n    vtbCalc.setValue(lstFields.get(1), recCalc, numDiameter)    ' B\n    numGradient = ftbLine.returnValue(fldGradient,recLine)\n    vtbCalc.setValue(lstFields.get(2), recCalc, numGradient)    ' C\n    numRoughness = ftbLine.returnValue(fldRoughness,recLine)\n    vtbCalc.setValue(lstFields.get(3), recCalc, numRoughness)   ' D\n    numPopulation = ftbLine.returnValue(fldPopulation,recLine)\n    
vtbCalc.setValue(lstFields.get(4), recCalc, numPopulation)  ' E\n    \n    ' peak factor calculation\n    strPeakFactor= strPeakFactorFormula\n    if(strPeakFactorFormula = \"BABITT\")then\n      numPeakFactor = 4.5.min(5/((numPopulation/1000)^(1/6)))\n    else \n      if(strPeakFactorFormula = \"BAUMANN\")then\n        numPeakFactor = 2.5.min(1+(14/(4+((numPopulation/1000).sqrt))))\n      else\n        numPeakFactor = strPeakFactorFormula.asNumber\n      end\n    end\n    vtbCalc.setValue(lstFields.get(5), recCalc, numPeak
Factor)                        ' F\n    \n'    sheet.poke(strRow+\"C7\", ftbLine.returnValue(fldFlow,recLine))       ' G\n'    sheet.poke(strRow+\"C7\", \"=E\"+strRowNumber+\"*F\"+strRowNumber+\"*\"+strLitersPerDayAndPerson+\"/3600/24\")\n    numFlow = numPopulation*numPeakFactor*numLitersPerDayAndPerson/3600/24\n    vtbCalc.setValue(lstFields.get(6), recCalc, numFlow)\n'    sheet.poke(strRow+\"C9\", \"=-2*LOG10(2.51*1.31/(1000000*numDiameter/1000)* ((2*9.80665*(B\"+strRowNumber+\"/1000)*C\"+strRowNumber+\").sqrt))+D\"+strRowNumber+
\"/(1000*3.71*(B\"+strRowNumber+\"/1000)))*SQRT(2*9.80665*(B\"+strRowNumber+\"/1000)*C\"+strRowNumber+\")\")    \n    numSquareRoot2 = (2*9.81*numDiameter/1000*numGradient).sqrt\n    numVelocityFullboard = -2*(((2.51*1.31/(1000000*numDiameter/1000)*((2*9.80665*(numDiameter/1000)*numGradient)).sqrt)+(numRoughness/(1000*3.71*(numDiameter/1000)))).log(10))*numSquareRoot2\n    vtbCalc.setValue(lstFields.get(8), recCalc, numVelocityFullboard)\n'    sheet.poke(strRow+\"C8\", \"=I\"+strRowNumber+\"*PI()*B\"+strRowNumber+\"^2/4000\") 
   \n    numFlowCapacity = numVelocityFullboard * Number.getPi * (numDiameter*numDiameter)/4000\n    vtbCalc.setValue(lstFields.get(7), recCalc, numFlowCapacity)\n\n    numPercentUsed = numFlow/numFlowCapacity*100\n    vtbCalc.setValue(lstFields.get(10), recCalc, numPercentUsed)\n\n    'sheet.poke(strRow+\"C10\", \"=((K\"+strRowNumber+\"/35)^0.305-0.0024*K\"+strRowNumber+\")*I\"+strRowNumber)    \n    numVelocityFreeSurface = (((numPercentUsed/35)^0.305)-(0.0024*numPercentUsed))*numVelocityFullboard\n    vtbCalc.setValue(ls
tFields.get(9), recCalc, numVelocityFreeSurface)\n\n    'sheet.poke(strRow+\"C11\", \"=G\"+strRowNumber+\"/H\"+strRowNumber+\"*100\")    \n    \n    'update status display\n    if(av.setStatus((numCounter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n  \n  vtbCalc.setEditable(false) \n\n ' join Results to table\n ftbLine.unjoinAll\n ftbLine.join(fldPipeID, vtbCalc, lstFields.get(0))\n \n 'clean up\n av.clearStatus"
	FontSize:	1
)

(DocWin.39
	Owner:	38
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.40
)

(DocAct.41
	Doc:	38
)

(SEd.42
	Name:	"DCSewerDesign.createXlsSewerCalculation"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:00:32 AM"
	GUIName:	"Script"
	Win:	43
	CSMgr:	44
	DocExts:	45
	Source:	"'DCSewerDesign.createXlsSewerCalculation\n'Create an Excel table containing the Sewerage Calculation\n'(c) 2000 DORSCH Consult\n \n'information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"PipeID=???    Diameter=???\"+NL+\n  \"Gradient=???    Roughness=???\"+NL+\n  \"AccumulatedPopulation=???   PeakFactor=???\"\n  ,\"Field Configuration File\")\n  \n'get the configuration file\n  lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"Select Configuration File\",0
)\n if(lstConfFiles.count = 0 )then\n   exit\n end\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n 'open the configuration file\n lnfConfiguration = LineFile.make(lstConfFiles.get(0), #FILE_PERM_READ)\n\n fldPipeID=nil\n fldDiameter=nil\n fldGradient=nil
\n fldRoughness=nil\n fldPopulation=nil\n strPeakFactorFormula=\"1\"\n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"pipeid\")then\n        fldPipeID=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"diameter\")then\n    
    fldDiameter=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"gradient\")then\n        fldGradient=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"roughness\")then\n        fldRoughness=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"accumulatedpopulation\")then\n        fldPopulation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"peakfactor\")then\n        if(strTableFieldName.isNumber)then\n  
        strPeakFactorFormula=strTableFieldName\n        else\n          if(strTableFieldName.ucase =\"BAUMANN\")then\n            strPeakFactorFormula = \"min(2.5; 1+14/(4+SQRT((E/1000))))\"\n          elseif(strTableFieldName.ucase = \"BABITT\")then\n            strPeakFactorFormula = \"min(4.5; 5/(E/1000)^(1/6))\"\n          else\n            Msgbox.info(\"Unknown Peak Factor Formula.\"+NL+\n            \"Baumann and Babitt are valid.\"+NL+\n            \"Using constant peak factor 1.\",\"DC Sewer Design\")\n          end\n        
end\n      end\n    end\n    strLine = lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n \n 'get information\n strLitersPerDayAndPerson = MsgBox.input(\"Sewage flow per person and day\",\"DC Sewer Design\",\"120\")\n if(strLitersPerDayAndPerson = nil)then\n   exit\n end\n \n 'check if configuration was successful\n  if((fldPipeID=nil)or(fldDiameter=nil)or(fldGradient=nil)or(fldRoughness=nil)\n  or(fldPopulation=nil))then\n    MsgBox.error(\"Field matching not successful. Check your table a
nd configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n\n 'start Excel, establish a DDE connection\n  system.execute(\"c:\\program files\\msoffice\\office\\excel.exe\") \n  sysClient = DDEClient.Make( \"Excel\",\"System\") \n  if (sysClient.HasError) then \n    MsgBox.error( sysClient.GetErrorMsg, \"\") \n    exit \n  end \n\n  fulltopic = sysClient.Request(\"selection\") 'returns [BookN]SheetN!RnCn:RnCn \n\n  sysClient.Close \n  topiclist=fulltopic.AsTokens(\"!:\") \n  \n  sheetname = topiclist.get(0)  \n  \n 'connect again\n sheet = D
DEClient.Make( \"Excel\", sheetname ) \n  \n'msgbox.info(sheet.request(\"NAME\"),\"info\")\n\n'write the table header\n sheet.poke(\"R1C1\", \"Pipe ID\")\n sheet.poke(\"R2C1\", \"String\")\n sheet.poke(\"R1C2\", \"Diameter DN\")\n sheet.poke(\"R2C2\", \"mm\")\n sheet.poke(\"R1C3\", \"Gradient I\")\n sheet.poke(\"R2C3\", \" - \")\n sheet.poke(\"R1C4\", \"Roughness kb\")\n sheet.poke(\"R2C4\", \"mm\")\n sheet.poke(\"R1C5\", \"Population\")\n sheet.poke(\"R2C5\", \"person\")\n sheet.poke(\"R1C6\", \"Peak Factor\")\n sheet.poke(\"R2C6\", \" - \")\n sheet.poke(\"R1C7\", \"Actual Flow\"
)\n sheet.poke(\"R2C7\", \"l/s\")\n sheet.poke(\"R1C8\", \"Flow Capacity\")\n sheet.poke(\"R2C8\", \"l/s\")\n sheet.poke(\"R1C9\", \"Fullboard Velocity\")\n sheet.poke(\"R2C9\", \"m/s\")\n sheet.poke(\"R1C10\", \"Free Surface Velocity\")\n sheet.poke(\"R2C10\", \"m/s\")\n sheet.poke(\"R1C11\", \"Percent used\")\n sheet.poke(\"R2C11\", \" % \")\n\n\n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n'calculation data\n \n 'give the user a chance to kill script\n av.showStopButton \n  \n'run over all records in the table\n  for eac
h recLine in ftbLine\n    strRowNumber = (numCounter+3).asString.Trim\n    strRow=\"R\"+strRowNumber\n    \n    sheet.poke(strRow+\"C1\", ftbLine.returnValue(fldPipeID,recLine))      ' A\n    sheet.poke(strRow+\"C2\", ftbLine.returnValue(fldDiameter,recLine))    ' B\n    sheet.poke(strRow+\"C3\", ftbLine.returnValue(fldGradient,recLine))    ' C\n    sheet.poke(strRow+\"C4\", ftbLine.returnValue(fldRoughness,recLine))   ' D\n    sheet.poke(strRow+\"C5\", ftbLine.returnValue(fldPopulation,recLine))  ' E\n    \n    ' peak factor ca
lculation\n    strPeakFactor= strPeakFactorFormula\n    if(strPeakFactor.isNumber.not)then\n      strPeakFactor = strPeakFactor.asTokens(\"E\").get(0) +\"E\"+ strRowNumber+strPeakFactor.asTokens(\"E\").get(1)\n    end\n    sheet.poke(strRow+\"C6\", \"=\"+strPeakFactor)                               ' F\n    \n'    sheet.poke(strRow+\"C7\", ftbLine.returnValue(fldFlow,recLine))       ' G\n    sheet.poke(strRow+\"C7\", \"=E\"+strRowNumber+\"*F\"+strRowNumber+\"*\"+strLitersPerDayAndPerson+\"/3600/24\") 'G\n    sheet.poke(strRow+\"C8\", \"=I\"+
strRowNumber+\"*PI()*B\"+strRowNumber+\"^2/4000\")    'H\n    sheet.poke(strRow+\"C9\", \"=-2*LOG10(2.51*1.31/(1000000* (B\"+strRowNumber+\"/1000) *SQRT(2*9.80665* (B\"+strRowNumber+\"/1000) *C\"+strRowNumber+\"))+D\"+strRowNumber+\"/(1000*3.71*(B\"+strRowNumber+\"/1000)))*SQRT(2*9.80665*(B\"+strRowNumber+\"/1000)*C\"+strRowNumber+\")\")    'I\n    sheet.poke(strRow+\"C10\", \"=((K\"+strRowNumber+\"/35)^0.305-0.0024*K\"+strRowNumber+\")*I\"+strRowNumber)    'J\n    sheet.poke(strRow+\"C11\", \"=G\"+strRowNumber+\"/H\"+strRowNumber+\"*100\")    'K\n
    \n    'update status display\n    if(av.setStatus((numCounter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n \n 'close the DDE connection\n sheet.close    \n \n 'clean up\n av.clearStatus"
	FontSize:	1
)

(DocWin.43
	Owner:	42
	X:	19
	Y:	549
	W:	1547
	H:	365
)

(CSMgr.44
)

(DocAct.45
	Doc:	42
)

(SEd.46
	Name:	"DCSewerDesign.enforceDrainage"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 29. Juni 2004 15:38:51"
	GUIName:	"Script"
	Win:	47
	CSMgr:	48
	DocExts:	49
	Source:	"' DCSewerDesign.EnforceDrainage\n\n' (c) 2004 DORSCH Consult\n\n' trace downstream and make sure that flow can reach next section\n' If upstream invert of downstream section > downstream invert,\n' move downstream section down\n' connecting lines with different diameters will have different invert levels\n  \nviewActive = av.GetActiveDoc\nthemeList = viewActive.GetThemes\nlstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\nLineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", 
\"Select a Theme\") \nif (LineTheme.asString = \"nil\") then\n  exit\nend\nthmLine = viewActive.FindTheme(LineTheme.AsString)\nftbLine = thmLine.GetFTab \n\n' information about the configuration file\nMsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"MaxUpstream=??? MaxDownstream=???\"+NL+\n  \"DesDownstream=???, DesUpstream=???, (optional) Diameter=???\"+NL+\n  \"DesDownstream and DesUpstream will be overwritten\"\n  ,\"Field Configuration File\")\n\n\nlstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"
},\"Select Configuration File\",0)\nif(lstConfFiles.count = 0 )then\n  exit\nend\nstrConfigurationFile = lstConfFiles.get(0).asString\n\nfldMaxUpstream = nil\nfldMaxDownstream = nil\nfldDesUpstream = nil\nfldDesDownstream = nil\nfldDiameter = nil\n\n' Read configuration file\nlnfConfiguration = LineFile.make(strConfigurationFile.asFilename, #FILE_PERM_READ)\nstrLine=lnfConfiguration.readElt\nwhile (not (strLine=nil ))\n  lstConfTokens = strLine.asTokens(\"=\")\n  if(lstConfTokens.count=2)then\n    strScriptFieldName = lstConfTok
ens.get(0).trim.lcase\n    strTableFieldName = lstConfTokens.get(1).trim.lcase\n    if(strScriptFieldName = \"MaxUpstream\")then\n      fldMaxUpstream=ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"MaxDownstream\")then\n      fldMaxDownstream=ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"DesUpstream\")then\n      fldDesUpstream = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"DesDownstream\")then\n      fldDesDownstream = ftbLine.findFie
ld(strTableFieldName)\n    end\n    if(strScriptFieldName = \"Diameter\")then\n      fldDiameter = ftbLine.findField(strTableFieldName)\n    end\n  end\n  strLine = lnfConfiguration.readElt\nend\nlnfConfiguration.close\n\nftbLine.setEditable(true)\n\n' set design invert levels to 0\n\nfor each recLine in ftbLine\n  ftbLine.setValue(fldDesDownstream, recLine, 0)\n  ftbLine.setValue(fldDesUpstream, recLine, 0)\nend\n\n' The queue of lines for which the connections will be searched\nstkQueue = Stack.make\n\nnumCounter = 0\n\nnumTotal =
 ftbLine.getNumRecords\nav.showStopButton\n  \n' run over all records in the table, find lines where all upstream information is defined\nwhile(numCounter < numTotal)\n  numOldCounter = numCounter\n  for each recLine in ftbLine\n    numDesDownstream = ftbLine.returnValue(fldDesDownstream, recLine)\n    if(numDesDownstream = 0)then\n      ' check if line has upstream lines\n      lstUpstream = av.run(\"DCSewerDesign.Line.findUpstreamLines\", {ftbLine, recLine})\n      blnReady = true\n      numMinUpstream = 1000000\n      
for each recUpstream in lstUpstream\n        numUpstream = ftbLine.returnValue(fldDesDownstream, recUpstream)\n        if(numUpstream = 0)then\n          blnReady = false\n          break\n        else\n          numDiameter = 0\n          if(fldDiameter <> nil)then\n            numDiameter = ftbLine.returnValue(fldDiameter, recUpstream)\n          end\n          numMinUpstream = numMinUpstream.min(numUpstream+(numDiameter/1000))\n        end\n      end\n      if(blnReady)then\n        numMaxUpstream = ftbLine.returnValu
e(fldMaxUpstream, recLine)\n        numMaxDownstream = ftbLine.returnValue(fldMaxDownstream, recLine)\n        if(numMinUpstream = 1000000)then\n          ftbLine.setValue(fldDesUpstream, recLine, numMaxUpstream)\n          ftbLine.setValue(fldDesDownstream, recLine, numMaxDownstream)\n        else\n          numDiameter = 0\n          if(fldDiameter <> nil)then\n            numDiameter = ftbLine.returnValue(fldDiameter, recLine)\n          end\n          numShift = numMaxUpstream - (numMaxUpstream.min(numMinUpstream
 - (numDiameter/1000))) \n          ftbLine.setValue(fldDesDownstream, recLine, numMaxDownstream-numShift)\n          ftbLine.setValue(fldDesUpstream, recLine, numMaxUpstream-numShift)\n        end\n        numCounter = numCounter+1\n       end\n     end\n  end\n  ' update status display\n       if(av.setStatus((numCounter/numTotal)*100).not)then\n        ' user hit the stop button\n         exit\n       end\n  if(numCounter = numOldCounter)then\n    Msgbox.info(\"Loop run did not improve result. System might not be fully
 connected.\", \"DC Sewer Design\")\n    exit\n  end\nend\n \nftbLine.setEditable(false)\nav.clearStatus"
	FontSize:	1
)

(DocWin.47
	Owner:	46
	W:	801
	H:	533
)

(CSMgr.48
)

(DocAct.49
	Doc:	46
)

(SEd.50
	Name:	"DCSewerDesign.exportBasysFile"
	Creator:	"sdteffen"
	CreationDate:	"Sunday, March 12, 2000 08:49:09"
	GUIName:	"Script"
	Win:	51
	CSMgr:	52
	DocExts:	53
	Source:	"' DCSewerDesign.exportBaSysFile\n' (c) 2000 DORSCH Consult\n\n'information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"LineID=???   Length=???  Diameter=??? FromX=???\"+NL+\n  \"FromY=???  ToX=???    ToY=???    Flow=????\"+NL+\n  \"UpstreamInvertLevel=???   DownstreamInvertLevel=???\"\n  ,\"Field Configuration File\")\n  \n'get the configuration file\n  lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"Select Configuration File\",0)\n if(lstConfFiles.count 
= 0 )then\n   exit\n end\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n 'open the configuration file\n lnfConfiguration = LineFile.make(lstConfFiles.get(0), #FILE_PERM_READ)\n\n fldLength=nil\n fldDiameter=nil\n fldFromX=nil\n fldFromY=nil\n fldToX=nil\n 
fldToY=nil\n fldFlow=nil\n fldUpstreamElevation=nil\n fldDownstreamElevation=nil\n fldLineID=nil\n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"length\")then\n        fldLength=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFie
ldName = \"diameter\")then\n        fldDiameter=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"fromx\")then\n        fldFromX=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"fromy\")then\n        fldFromY = ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"tox\")then\n        fldToX=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"toy\")then\n        fldToY=ftbLine.findField(strTableFieldName)\n      en
d\n      if(strScriptFieldName = \"flow\")then\n        fldFlow=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"upstreaminvertlevel\")then\n        fldUpstreamElevation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"downstreaminvertlevel\")then\n        fldDownstreamElevation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"lineid\")then\n        fldLineID=ftbLine.findField(strTableFieldName)\n      end\n    end    \n    strLine = 
lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n  \n 'check if configuration was successful\n  if((fldLength=nil)or(fldDiameter=nil)or(fldFromX=nil)or(fldFromY=nil)or(fldLineID=nil)\n  or(fldToX=nil)or(fldToY=nil)or(fldFlow=nil)or(fldUpstreamElevation=0)or(fldDownstreamElevation=nil))then\n    MsgBox.error(\"Field matching not successful. Check your table and configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n \n flnOutputFile = FileDialog.put(\"basysfile.txt\".asFilename,
\"*.txt\", \"Create BaSys File\")\n if(flnOutputFile = nil )then\n   exit\n end\n\n  av.showStopButton\n  numCounter=0\n  numTotal = ftbLine.getNumRecords\n\n lnfOutput = LineFile.make(flnOutputFile, #FILE_PERM_WRITE)\n\n' run over all records in the table\n  for each recLine in ftbLine\n  strLine = ftbLine.returnValue(fldLineID,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldLength,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldDiameter,recLine).asString+\",\"\n  strLine = strLine + ftbL
ine.returnValue(fldFromX,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldFromY,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldToX,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldToY,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldFlow,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldUpstreamElevation,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldDownstreamElevation,recLine).asString\n  lnfOutpu
t.writeElt(strLine)\n    \n    'update status display\n    if(av.setStatus((numCounter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n \n \n 'clean up\n lnfOutput.close\n av.clearStatus"
	FontSize:	1
)

(DocWin.51
	Owner:	50
	X:	-4
	Y:	-4
	W:	1038
	H:	675
)

(CSMgr.52
)

(DocAct.53
	Doc:	50
)

(SEd.54
	Name:	"DCSewerDesign.Fields.returnNumberFields"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 08. Juni 2000 12:16:18"
	GUIName:	"Script"
	Win:	55
	CSMgr:	56
	DocExts:	57
	Source:	"' DCSewerDesign.Fields.returnNumberFields\n\n' expects a list of fields as the argument,\n' returns a list with all the numerical fields contained\n' in that list\n\n' (c) 2000 DORSCH Consult\n\nlstFields = self\nlstNumberFields = List.make\nfor each fldCheck in lstFields\n  if(fldCheck.isTypeNumber)then\n    lstNumberFields.add(fldCheck)\n  end\nend   \n\nreturn lstNumberFields.clone"
	FontSize:	1
)

(DocWin.55
	Owner:	54
	X:	20
	Y:	20
	W:	1245
	H:	328
)

(CSMgr.56
)

(DocAct.57
	Doc:	54
)

(SEd.58
	Name:	"DCSewerDesign.flipLinesToFlowDirection"
	Creator:	"sdteffen"
	CreationDate:	"Sunday, February 27, 2000 12:28:44 PM"
	GUIName:	"Script"
	Win:	59
	CSMgr:	60
	DocExts:	61
	Source:	"' DCSewerDesign.flipLinesToFlowDirection\n' (c) 2000 DORSCH Consult\n\n' runs over all the lines of a Sewer Theme and makes sure that they're all\n' running from the upstream point to the downstream point\n\n\n' get the table\n viewActive = av.GetActiveDoc\n themeList = viewActive.GetThemes\n LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\") \n if (LineTheme.asString = \"nil\") then\n    exit\n end\n thmLine = viewActive.FindTheme(LineTheme.AsString)\n ftbLine = thmLine.GetFTab\n \n 'get the 
elevation fields\n lstFields = thmLine.getFTab.getFields\n fldDownstreamElevation = Msgbox.choice(lstFields, \"Select the Downstream Elevation Field.\",\"Select a Field\")\n if(fldDownstreamElevation.asString = \"nil\")then\n  exit\n end\n' fldUpstreamElevation = Msgbox.choice(lstFields, \"Select the Upstream Elevation Field.\",\"Select a Field\")\n 'if(fldUpstreamElevation.asString = \"nil\")then\n ' exit\n 'end\n\n fldShape = ftbLine.findField(\"Shape\")\n  \n 'data for status display\n numCounter = 0 \n numTotal = ftbLine.GetNumReco
rds\n numFlipCount = 0\n bmpFlipped = Bitmap.make(numTotal)\n bmpFlipped.clearAll\n \n'give the user a chance to kill script\n av.showStopButton \n ftbLine.setEditable(true)\n  \n'run over all lines\n  for each recLine in ftbLine\n   lstConnectedLines = av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine, recLine})\n   numDownstreamElevation = ftbLine.returnValue(fldDownstreamElevation, recLine)\n   pllLine = ftbLine.returnValue(fldShape, recLine)\n   pntStart = pllLine.asList.get(0).get(0)\n   \n   blnPntIsUpstream = 
true\n   if(lstConnectedLines.count = 0)then\n     Msgbox.info(\"No connected Lines\",\"DC Sewer Design\")\n   end\n   for each recConnectedLine in lstConnectedLines\n     pllConnectedLine = ftbLine.returnValue(fldShape, recConnectedLine)\n     if(ftbLine.returnValue(fldDownstreamElevation,recConnectedLine) < numDownstreamElevation )then   \n       blnPntIsUpstream = false\n       break\n     end\n   end\n \n   if(blnPntIsUpstream)then\n     'connected line is upstream of recLine, Connection Point is upstream manhole\n     \n
    'check for correct snapping\n     if(pllLine.PointIntersection(pllConnectedLine).asList.count=0)then\n       msgbox.info(\"No Intersection.\",\"DC Sewer Design\")\n       av.clearStatus\n       bmpFlipped.clearAll\n       bmpFlipped.set(recLine)\n       ftbLine.setSelection(bmpFlipped)\n     end\n     \n     pntUpstreamManhole = pllLine.PointIntersection(pllConnectedLine).asList.get(0)\n     if(pntStart.intersects(pntUpstreamManhole).not)then\n       ftbLine.setValue(fldShape, recLine, pllLine.clone.flip)\n       numFl
ipCount = numFlipCount+1\n       bmpFlipped.set(recLine)\n     end\n   else\n    'connected Line downstream, Connection Point downstream manhole\n\n     'check for correct snapping\n     if(pllLine.PointIntersection(pllConnectedLine).asList.count=0)then\n       msgbox.info(\"No Intersection\",\"DC Sewer Design\")\n       av.clearStatus\n       bmpFlipped.clearAll\n       bmpFlipped.set(recLine)\n       ftbLine.setSelection(bmpFlipped)\n     end\n     \n     pntDownstreamManhole = pllLine.PointIntersection(pllConnectedLine).as
List.get(0)\n     \n     if(pntStart.intersects(pntDownstreamManhole))then\n       ftbLine.setValue(fldShape, recLine, pllLine.clone.flip)\n       numFlipCount = numFlipCount+1\n       bmpFlipped.set(recLine)\n     end\n   end\n   \n   'update status display\n   numCounter = NumCounter+1\n   if(av.setStatus((numCounter/numTotal)*100).not)then\n    'user hit the stop button\n     exit\n   end\n\n  end \n\nftbLine.setEditable(false)\nav.clearStatus\nMsgBox.info(\"Flipped \"+numFlipCount.asString+\" Lines.\",\"DC Sewer Design\")\nftbLin
e.setSelection(bmpFlipped)"
	FontSize:	1
)

(DocWin.59
	Owner:	58
	X:	564
	Y:	151
	W:	1034
	H:	643
)

(CSMgr.60
)

(DocAct.61
	Doc:	58
)

(SEd.62
	Name:	"DCSewerDesign.Help.openCHM"
	Creator:	"sdteffen"
	CreationDate:	"Montag, 01. Mrz 2004 20:30:53"
	GUIName:	"Script"
	Win:	63
	CSMgr:	64
	DocExts:	65
	Source:	"' DCSewerDesign.Help.openCHM\n\n' (c) 2004 DORSCH Consult\n\n\nsystem.execute(\"hh.exe\".quote++\"$AVHOME\\HELP\\dcsewerdesign.chm\".asFilename.getFullName.quote)"
	FontSize:	1
)

(DocWin.63
	Owner:	62
	X:	801
	W:	801
	H:	533
)

(CSMgr.64
)

(DocAct.65
	Doc:	62
)

(SEd.66
	Name:	"DCSewerDesign.i18n.returnTranslation"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 25. Mai 2000 15:54:04"
	GUIName:	"Script"
	Win:	67
	CSMgr:	68
	DocExts:	69
	Source:	"' DCSewerDesign.i18n.returnTranslation\n\n' argument 1: strToBeTranslated ( in English ) \n' the Translation will be done through the dictionaries\n\n' (c) 2000 DORSCH Consult\n\n' NOTE: right now this is a dummy functions that returns argument 1\n\nreturn self"
	FontSize:	1
)

(DocWin.67
	Owner:	66
	X:	293
	Y:	326
	W:	712
	H:	426
)

(CSMgr.68
)

(DocAct.69
	Doc:	66
)

(SEd.70
	Name:	"DCSewerDesign.Line.findConnectedLines"
	Creator:	"sdteffem"
	CreationDate:	"Saturday, February 26, 2000 10:01:23 AM"
	GUIName:	"Script"
	Win:	71
	CSMgr:	72
	DocExts:	73
	Source:	"' DCSewerDesign.Line.findConnectedLines\n' Arguments: The Line FTab and a record in it\n' Returns the records of all Lines that are connected to the Line\n' 0.1 m snapping interval\n' (c) 2000 DORSCH Consult\n\nftb_Lines = self.get(0)\nrec_Line = self.get(1)\n\nfna_LineShape = ftb_Lines.findField(\"Shape\")\n\n  pll_Line = ftb_Lines.returnValue(fna_LineShape, rec_Line)\n\n  'increases the speed, because it uses ArcView's spatial index\n  ftb_Lines.selectByPolyline(pll_Line, #VTAB_SELTYPE_NEW) \n\n  lst_LineNodes = pll_Line.a
sList.get(0)\n  pnt_Start = lst_LineNodes.get(0)\n  pnt_End = lst_LineNodes.get(lst_LineNodes.count -1 )\n\nlst_Lines = List.make\nbmp_Lines = ftb_Lines.getSelection\nbmp_Lines.clear(rec_Line)\n\n\n'second run is necessary because selectByPolyline returns also Lines that\n'cross the Line rather than start at it\nlstUpstream = List.make\nlstDownstream = List.make\nfor each rec_ConnectedLine in bmp_Lines\n  pll_Line = ftb_Lines.returnValue(fna_LineShape, rec_ConnectedLine)\n  lst_LineNodes = pll_Line.asList.get(0)\n  \n'  pnt
_StartLine = lst_LineNodes.get(0)\n'  pnt_EndLine = lst_LineNodes.get(lst_LineNodes.count -1 )\n ' num_LastNode = lst_LineNodes.count-1\n  for each i in {0, 100}\n    if(pnt_Start.distance(pll_Line.along(i)) < 0.1) then\n      lstUpstream.add(rec_ConnectedLine.clone)\n    elseif(pnt_End.distance(pll_Line.along(i)) < 0.1) then\n      lstUpstream.add(rec_ConnectedLine.clone)\n    end\n  end\nend\nlst_Lines = lstUpstream+lstDownstream\nreturn lst_Lines.deepclone"
	FontSize:	1
)

(DocWin.71
	Owner:	70
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.72
)

(DocAct.73
	Doc:	70
)

(SEd.74
	Name:	"DCSewerDesign.Line.findManholes"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 26. Mai 2000 10:13:31"
	GUIName:	"Script"
	Win:	75
	CSMgr:	76
	DocExts:	77
	Source:	"' DCSewerDesign.Line.findManholes\n' Arguments: The Line FTab, the Manhole FTab and a record in the line ftab\n' Returns the records of all Manholes that are connected to the Line\n\n' (c) 2000 DORSCH Consult\n\nftb_Lines = self.get(0)\nftbManholes = self.get(1)\nrec_Line = self.get(2)\n\nfna_LineShape = ftb_Lines.findField(\"Shape\")\n\npll_Line = ftb_Lines.returnValue(fna_LineShape, rec_Line)\n\nlstManholes = List.make\n\nfor each i in {0,100}\n  pntManhole = pll_Line.along(i)\n  ftbManholes.selectByPoint(pntManhole, 0.1, #V
TAB_SELTYPE_NEW)\n  bmpManholes = ftbManholes.getSelection\n  for each recManhole in bmpManholes\n    lstManholes.add(recManhole.clone)\n  end\nend\nreturn lstManholes.deepclone"
	FontSize:	1
)

(DocWin.75
	Owner:	74
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.76
)

(DocAct.77
	Doc:	74
)

(SEd.78
	Name:	"DCSewerDesign.Line.findUpstreamLines"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 29. Juni 2004 16:02:23"
	GUIName:	"Script"
	Win:	79
	CSMgr:	80
	DocExts:	81
	Source:	"' DCSewerDesign.Line.findUpstreamLines\n' Arguments: The Line FTab and a record in it\n' Returns the records of all Lines that are connected to the Line\n' 0.1 m snapping interval\n' (c) 2000,2004 DORSCH Consult\n\nftb_Lines = self.get(0)\nrec_Line = self.get(1)\n\nfna_LineShape = ftb_Lines.findField(\"Shape\")\n\npll_Line = ftb_Lines.returnValue(fna_LineShape, rec_Line)\n\n'increases the speed, because it uses ArcView's spatial index\nftb_Lines.selectByPolyline(pll_Line, #VTAB_SELTYPE_NEW) \n\npnt_Start = pll_Line.along(0)\n
\nlst_Lines = List.make\nbmp_Lines = ftb_Lines.getSelection\nbmp_Lines.clear(rec_Line)\n\n' second run is necessary because selectByPolyline returns also Lines that\n' cross the Line rather than start at it\nlstUpstream = List.make\nfor each rec_ConnectedLine in bmp_Lines\n  pll_Line = ftb_Lines.returnValue(fna_LineShape, rec_ConnectedLine)\n  if(pnt_Start.distance(pll_Line.along(100)) < 0.1) then\n      lstUpstream.add(rec_ConnectedLine.clone)\n  end\nend\nreturn lstUpstream.deepclone"
	FontSize:	1
)

(DocWin.79
	Owner:	78
	X:	489
	Y:	456
	W:	928
	H:	484
)

(CSMgr.80
)

(DocAct.81
	Doc:	78
)

(SEd.82
	Name:	"DCSewerDesign.Lines.takeoverManholeData"
	Creator:	"sdteffen"
	CreationDate:	"Sonntag, 28. Mai 2000 20:04:04"
	GUIName:	"Script"
	Win:	83
	CSMgr:	84
	DocExts:	85
	Source:	"' DCSewerDesign.Lines.takeoverManholeData\n\n' lets the Lines take over data for the upstream and downstream\n' manholes\n' REQUIRES that the lines are flipped to flow direction\n\n' (c) 2000,2004 DORSCH Consult\n\n  Msgbox.info(\"Make sure that the lines are flipped to flow direction.\", \"DC Sewer Design\")\n\n'get the line table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  thmLine = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (thmLine.asString = \"nil\") then\n
    exit\n  end\n  ftbLine = thmLine.GetFTab \n\n'get the manhole table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  thmManhole = Msgbox.Choice (themeList, \"Select a Point Theme.\", \"Select a Theme\")   \n  if (thmManhole.asString = \"nil\") then\n    exit\n  end\n  ftbManhole = thmManhole.GetFTab \n\n ' get the manhole data field\n lstManholeFields = ftbManhole.getFields.clone\n lstManholeFields.remove(0)\n fldManholeData = Msgbox.choice(lstManholeFields, \"Select the Manhole Data Field.\",\"Select a 
Field\")\n if(fldManholeData.asString = \"nil\")then\n  exit\n end\n\n ' get the upstream and downstream data field\n lstLineFields = ftbLine.getFields.clone\n lstLineFields.remove(0)\n fldUpstreamData = Msgbox.choice(lstLineFields, \"Select the Upstream Data Field.\",\"Select a Field\")\n if(fldUpstreamData.asString = \"nil\")then\n  exit\n end\n\n if(fldUpstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Upstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldDownstreamData = M
sgbox.choice(lstLineFields, \"Select the Downstream Data Field.\",\"Select a Field\")\n if(fldDownstreamData.asString = \"nil\")then\n  exit\n end\n\n if(fldDownstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Downstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldLineShape = ftbLine.findField(\"Shape\") \n ftbLine.setEditable(true)\n numTotal = ftbLine.getNumRecords\n numComplete = 0\n av.showStopButton\n  \n for each recLine in ftbLine\n   pllLine = ftbLine.returnValue(fl
dLineShape, recLine)\n   pntUpstream = pllLine.asList.get(0).get(0)\n   lstLine = pllLine.asList\n   if(lstLine.count > 1)then\n     System.echo(\"Error: Multipart polylines are not allowed.\")\n   else\n     lstLine = lstLine.get(0)\n     pntDownstream = lstLine.get(lstLine.count-1)\n    \n     ftbManhole.selectByPoint(pntUpstream, 0.1, #VTAB_SELTYPE_NEW) \n     bmpManholes = ftbManhole.getSelection\n     for each recManhole in bmpManholes\n       recUpstream = recManhole\n     end\n     objUpstream = ftbManhole.returnVal
ue(fldManholeData, recUpstream)\n     ftbLine.setValue(fldUpstreamData, recLine, objUpstream)\n     \n     ftbManhole.selectByPoint(pntDownstream, 0.1, #VTAB_SELTYPE_NEW) \n     bmpManholes = ftbManhole.getSelection\n     for each recManhole in bmpManholes\n       recDownstream = recManhole\n     end\n     objDownstream = ftbManhole.returnValue(fldManholeData, recDownstream)\n     ftbLine.setValue(fldDownstreamData, recLine, objDownstream)\n   end\n   ' update status display   \n   numComplete = numComplete + 1\n   if(a
v.setStatus((numComplete/numTotal)*100).not)then\n     'user hit the stop button\n     exit\n   end\n end   \n \n ftbLine.setEditable(false)\n av.clearStatus"
	FontSize:	1
)

(DocWin.83
	Owner:	82
	X:	190
	Y:	-9
	W:	1290
	H:	899
)

(CSMgr.84
)

(DocAct.85
	Doc:	82
)

(SEd.86
	Name:	"DCSewerDesign.Lines.takeoverMinimumValuesFromBuffer"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 12:41:39"
	GUIName:	"Script"
	Win:	87
	CSMgr:	88
	DocExts:	89
	Source:	"' DCSewerDesign.Lines.takeoverMinimumValuesFromBuffer\n\n' (c) 2004 DORSCH Consult\n\n' create a buffer around the line and find the minimum\n' elevation from a point theme\n' requires pipe thene (polyline)\n' require spot elevation theme (point)\n\n'get the line table\nviewActive = av.GetActiveDoc \nthemeList = viewActive.GetThemes \nlstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\nthmLine = Msgbox.Choice (lstLineThemes, \"Select the Line Theme.\", \"DC Sewer Design\")   \nif (thmLine.asString 
= \"nil\") then\n  exit\nend\nftbLine = thmLine.GetFTab \n\n'get the  table\nviewActive = av.GetActiveDoc \nthemeList = viewActive.GetThemes \nlstPointThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\nthmPoint = Msgbox.Choice (lstpointThemes, \"Select the Point Theme.\", \"DC Sewer Design\")   \nif(thmPoint.asString = \"nil\") then\n  exit\nend\nftbPoint = thmPoint.GetFTab \n\n' get the point data field\nlstPointFields = ftbpoint.getFields.clone\nlstPointFields.remove(0)\nfldPointData = Msgbox.choice(lstpointF
ields, \"Select the Point Data Field.\",\"Select a Field\")\nif(fldPointData.asString = \"nil\")then\n  exit\nend\n\n' get the line data field\nlstLineFields = ftbLine.getFields.clone\nlstLineFields.remove(0)\nfldLineData = Msgbox.choice(lstLineFields, \"Select the Line Data Field.\",\"Select a Field\")\nif(fldLineData.asString = \"nil\")then\n  exit\nend\n\nif(fldLineData.getType <> fldpointData.getType)then\n Msgbox.info(\"Upstream Data Type doesn't match point Data Type\", \"DC Sewer Design\")\n exit\nend\n\nstrBufferDistance = MsgBox.in
put(\"Specify the Buffer Distance:\",\"DC Sewer Design\",\"5.0\")\nif((strBufferDistance.asString = \"nil\")or(strBufferDistance.isNumber.not))then\n  exit\nend\nnumBufferDistance = strBufferDistance.asNumber\n\nfldLineShape = ftbLine.findField(\"Shape\") \nfldPointShape = ftbpoint.findField(\"Shape\")\nftbLine.setEditable(true)\nnumTotal = ftbLine.getNumRecords\nnumComplete = 0\nav.showStopButton\n\nfor each recLine in ftbLine\n pllLine = ftbLine.returnValue(fldLineShape, recLine)\n plgnBuffer = pllLine.returnBuffered(numBufferDista
nce)\n ftbPoint.selectByPolygon(plgnBuffer, #VTAB_SELTYPE_NEW)\n numMinimumValue = Number.makeNull\n for each recPoint in ftbPoint.getSelection\n   numValue = ftbPoint.returnValue(fldPointData, recPoint)\n   if((numMinimumValue.isNull) or (numValue < numMinimumValue))then\n     numMinimumValue = numValue\n   end\n end\n ftbLine.setValue(fldLineData, recLine, numMinimumValue)\n \n ' update status display   \n numComplete = numComplete + 1\n if(av.setStatus((numComplete/numTotal)*100).not)then\n   'user hit the stop button
\n   exit\n end\nend   \n \nftbpoint.setEditable(false)\nav.clearStatus\n\n\n"
	SearchStr:	"manhole"
	FontSize:	1
)

(DocWin.87
	Owner:	86
	X:	5
	Y:	5
	W:	790
	H:	733
)

(CSMgr.88
)

(DocAct.89
	Doc:	86
)

(SEd.90
	Name:	"DCSewerDesign.Lines.validate"
	Creator:	"sdteffen"
	CreationDate:	"Thursday, March 23, 2000 09:26:45"
	GUIName:	"Script"
	Win:	91
	CSMgr:	92
	DocExts:	93
	Source:	"' DCSewerDesign.Lines.validate\n\n' checks if the lines only have one vertex\n\n' (c) 2000 DORSCH Consult\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n \n fldShape = ftbLine.findField(\"Shape\")\n \n 'data for status display\n  numCounter = 0 \n  numTotal 
= ftbLine.GetNumRecords \n  \n 'give the user a chance to kill script\n av.showStopButton \n  \nbmpInvalid = Bitmap.make(ftbLine.getNumRecords)\nbmpInvalid.clearAll\n    \n' run over all records in the table\n  for each recLine in ftbLine\n\n   ' get the Upstream Manhole\n    pllLine = ftbLine.returnValue(fldShape, recLine)\n    if((pllLine.asList.count <> 1)or(pllLine.asList.get(0).count <> 2)or(pllLine.returnLength < 1))then\n      bmpInvalid.set(recLine)\n    end\n\n    'update status display\n    if(av.setStatus((numCoun
ter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n\n  ftbLine.setSelection(bmpInvalid)\n  ftbLine.updateSelection\n  Msgbox.info(\"The Theme contains \"+bmpInvalid.count.asString+\" invalid features.\", \"DC Sewer Design\")\n  \n av.clearStatus"
	FontSize:	1
)

(DocWin.91
	Owner:	90
	X:	126
	Y:	151
	W:	1063
	H:	612
)

(CSMgr.92
)

(DocAct.93
	Doc:	90
)

(SEd.94
	Name:	"DCSewerDesign.List.flip"
	Creator:	"sdteffen"
	CreationDate:	"Samstag, 27. Mai 2000 17:42:13"
	GUIName:	"Script"
	Win:	95
	CSMgr:	96
	DocExts:	97
	Source:	"' DCSewerDesign.List.flip\n\n' returns the List given as argument in reverse order\n\n' (c) 2000 DORSCH Consult\n\nlstNormal = self\n\nlstFlip = List.make\n\nfor each i in (lstNormal.count-1)..0\n  lstFlip.add(lstNormal.get(i).clone)\nend\n\nreturn lstFlip.deepclone"
	FontSize:	1
)

(DocWin.95
	Owner:	94
	X:	-4
	Y:	-4
	W:	1690
	H:	911
)

(CSMgr.96
)

(DocAct.97
	Doc:	94
)

(SEd.98
	Name:	"DCSewerDesign.Manhole.findDownstreamLine"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 08. November 2002 06:55:14"
	GUIName:	"Script"
	Win:	99
	CSMgr:	100
	DocExts:	101
	Source:	"' DCSewerDesign.Manhole.findDownstreamLine\n' Arguments: The Line FTab and a Point (at the location of the manhole)\n' Returns the record of the line downstream of the manhole\n\n' 0.1 map units snap tolerance\n\n' (c) 2000, 2002 DORSCH Consult\n\nftbLines = self.get(0)\npntManhole = self.get(1)\n\n'increases the speed, because it uses ArcView's spatial index\nftbLines.selectByPoint(pntManhole, 1.0, #VTAB_SELTYPE_NEW)\nbmpLines = ftbLines.getSelection\nlstLines = List.make\nfldLineShape = ftbLines\nfor each recConnectedLin
e in bmpLines\n  pllConnectedLine = ftbLines.returnValue(ftbLines.findField(\"Shape\"),recConnectedLine)\n  nLastVertex = pllConnectedLine.asList.get(0).count-1\n  if(pllConnectedLine.asList.get(0).get(0).distance(pntManhole) <= 0.1)then\n    return recConnectedLine\n  end\nend\n\nreturn nil"
	FontSize:	1
)

(DocWin.99
	Owner:	98
	X:	572
	Y:	307
	W:	870
	H:	420
)

(CSMgr.100
)

(DocAct.101
	Doc:	98
)

(SEd.102
	Name:	"DCSewerDesign.Manhole.findUpstreamLines"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, March 04, 2000 11:29:31 AM"
	GUIName:	"Script"
	Win:	103
	CSMgr:	104
	DocExts:	105
	Source:	"' DCSewerDesign.Manhole.findUpstreamLines\n' Arguments: The Line FTab and a Point (at the location of the manhole)\n' Returns the records of all Lines that are connected to the Line\n\n' 0.1 map units snap tolerance\n\n' (c) 2000, 2002 DORSCH Consult\n\nftbLines = self.get(0)\npntManhole = self.get(1)\n\n'increases the speed, because it uses ArcView's spatial index\nftbLines.selectByPoint(pntManhole, 1.0, #VTAB_SELTYPE_NEW)\nbmpLines = ftbLines.getSelection\nlstLines = List.make\nfldLineShape = ftbLines\nfor each recConnec
tedLine in bmpLines\n  pllConnectedLine = ftbLines.returnValue(ftbLines.findField(\"Shape\"),recConnectedLine)\n  nLastVertex = pllConnectedLine.asList.get(0).count-1\n  if(pllConnectedLine.asList.get(0).get(nLastVertex).distance(pntManhole) <= 0.1)then\n    lstLines.add(recConnectedLine.clone)\n  end\nend\n\nreturn lstLines.deepclone"
	FontSize:	1
)

(DocWin.103
	Owner:	102
	X:	606
	Y:	427
	W:	766
	H:	533
)

(CSMgr.104
)

(DocAct.105
	Doc:	102
)

(SEd.106
	Name:	"DCSewerDesign.Manholes.takeoverLineData"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 07. Juni 2000 10:47:44"
	GUIName:	"Script"
	Win:	107
	CSMgr:	108
	DocExts:	109
	Source:	"' DCSewerDesign.Manholes.takeoverLineData\n\n' lets the Manholes take over data from the upstream and downstream\n' fields of the lines\n' REQUIRES that the lines are flipped to flow direction\n\n' (c) 2000 DORSCH Consult\n\n  Msgbox.info(\"Make sure that the lines are flipped to flow direction.\", \"DC Sewer Design\")\n\n'get the line table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  thmLine = Msgbox.Choice (lstLine
Themes, \"Select the Line Theme.\", \"DC Sewer Design\")   \n  if (thmLine.asString = \"nil\") then\n    exit\n  end\n  ftbLine = thmLine.GetFTab \n\n'get the manhole table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstManholeThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\n  thmManhole = Msgbox.Choice (lstManholeThemes, \"Select the Manhole Theme.\", \"DC Sewer Design\")   \n  if (thmManhole.asString = \"nil\") then\n    exit\n  end\n  ftbManhole = thmManhole.GetFTab \n\n ' get th
e manhole data field\n lstManholeFields = ftbManhole.getFields.clone\n lstManholeFields.remove(0)\n fldManholeData = Msgbox.choice(lstManholeFields, \"Select the Manhole Data Field.\",\"Select a Field\")\n if(fldManholeData.asString = \"nil\")then\n  exit\n end\n\n ' get the upstream and downstream data field\n lstLineFields = ftbLine.getFields.clone\n lstLineFields.remove(0)\n fldUpstreamData = Msgbox.choice(lstLineFields, \"Select the Upstream Data Field.\",\"Select a Field\")\n if(fldUpstreamData.asString = \"nil\")then\n  exit\n
 end\n\n if(fldUpstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Upstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldDownstreamData = Msgbox.choice(lstLineFields, \"Select the Downstream Data Field.\",\"Select a Field\")\n if(fldDownstreamData.asString = \"nil\")then\n  exit\n end\n\n if(fldDownstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Downstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldLineShape = ftb
Line.findField(\"Shape\") \n fldManholeShape = ftbManhole.findField(\"Shape\")\n ftbManhole.setEditable(true)\n numTotal = ftbManhole.getNumRecords\n numComplete = 0\n av.showStopButton\n  \n for each recManhole in ftbManhole\n   pntManhole = ftbManhole.returnValue(fldManholeShape, recManhole)\n   ftbLine.selectByPoint(pntManhole, 0.1, #VTAB_SELTYPE_NEW)\n   objValue = nil\n   for each recLine in ftbLine.getSelection\n     pllLine = ftbLine.returnValue(fldLineShape, recLine)\n     if(pntManhole.distance(pllLine.asList.get(0
).get(0)) < 0.1)then\n       objValue = ftbLine.returnValue(fldUpstreamData, recLine)\n     else\n       lstLine = pllLine.asList\n       if(lstLine.count > 1)then\n         System.echo(\"Error: Multipart polylines are not allowed.\")\n       else\n         lstLine = lstLine.get(0)\n         pntDownstream = lstLine.get(lstLine.count-1)\n         if(pntDownstream.distance(pntManhole) < 0.1)then\n           objValue = ftbLine.returnValue(fldDownstreamData, recLine)\n         end\n       end\n     end\n\n     break\n   end\n   f
tbManhole.setValue(fldManholeData, recManhole, objValue)\n   \n   ' update status display   \n   numComplete = numComplete + 1\n   if(av.setStatus((numComplete/numTotal)*100).not)then\n     'user hit the stop button\n     exit\n   end\n end   \n \n ftbManhole.setEditable(false)\n av.clearStatus"
	FontSize:	1
)

(DocWin.107
	Owner:	106
	X:	20
	Y:	20
	W:	761
	H:	706
)

(CSMgr.108
)

(DocAct.109
	Doc:	106
)

(SEd.110
	Name:	"DCSewerDesign.NetworkCalculator.calculate"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 28. Januar 2005 21:56:31"
	GUIName:	"Script"
	Win:	111
	CSMgr:	112
	DocExts:	113
	Source:	"'DCSewerDesign.NetworkCalculator.calculate\n\n' Calculate a table column using upstream and downstream values\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied
 warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nblnDebug = false\n\nstrFormula = MsgBox.input(\"Please insert your network calculator formula:\", \"DC Network Calculator\", \"\")\nif(strFormula.is(String).not)then\n  exit\nen
d\n\n' TODO: Speed up if \"Downstream.\" and \"Upstream.\" are not used => use standard calculator\n\n' Lowercase copy of the formula to make syntax case-independent\nstrLCaseFormula = strFormula.clone\nstrLCaseFormula = strLCaseFormula.lcase\n\n' Calculation can be upstream or downstream\nblnUpstream = MsgBox.yesNoCancel(\"Perform upstream calculation? (Selecting No will perform calculations in downstream direction)\", \"DC Network Calculator\", true)\nif(blnUpstream = nil)then\n  ' User selected cancel\n  exit\nend\n\ntableNetw
ork = av.getActiveDoc\nftbNetwork = tableNetwork.getVTab\nif(ftbNetwork.is(FTab).not)then\n  MsgBox.error(\"Fatal Error: Function getVTab() did not return an FTab.\",\"DCSewerDesign.NetworkCalculator.calculate()\")\n  exit\nend\nfldNetwork = tableNetwork.getActiveField\n\n' Remember the original selection\n\nbmSelection = ftbNetwork.getSelection.clone\nbmWork = bmSelection.clone\n\n' Handle case where no records are selected\nif(bmWork.count = 0)then\n  bmWork.setAll\nend\n\nbmOne = bmWork.clone\nbmOne.clearAll\n\n' Ordererd list\nl
stOrdered = List.make\n\n' Unordered list as copied from Bitmap\nlstUnordered = List.make\n\nfldNetworkShape = ftbNetwork.findField(\"shape\")\n\n' Prevent endless loops\nnumDeadlock = bmWork.count*bmWork.count\n\n' Loop over all selected records\nfor each recWork in bmWork\n  lstUnordered.add(recWork.clone)\nend\n\nnumToGo = bmWork.count * 2\nnumDone = 0\n\n' Try to order the list\nnumI = 0\nwhile(lstUnordered.count > 0)\n  recWork = lstUnordered.get(0)\n  pntDownstream = ftbNetwork.returnValue(fldNetworkShape, recWork).along(100
)\n  recDownstream = av.run(\"DCSewerDesign.Manhole.findDownstreamLine\", {ftbNetwork, pntDownstream})\n  if(recDownstream = nil)then\n    lstOrdered.insert(recWork.clone)\n    lstUnordered.remove(0)\n    numDone = numDone + 1\n  elseif(lstUnordered.findByValue(recDownstream) = -1)then\n    recWorkClone = recWork.clone\n    lstOrdered.insert(recWorkClone)\n    intPosition = lstOrdered.findByValue(recDownstream)\n    numDone = numDone + 1 \n    if(intPosition <> -1)then\n      lstOrdered.shuffle(recWorkClone, intPosition+
1)\n    end\n    lstUnordered.remove(0)\n  else\n    lstUnordered.shuffle(recWork, lstUnordered.count)\n  end\n  numI = numI+1\n  if(numI = numDeadlock)then\n    MsgBox.error(\"FATAL ERROR: System leads to endless loop. Aborting\", \"DC Sewer Design\")\n    exit\n  end\nend\n\nnumCount = lstOrdered.count\nif(blnUpstream)then\n  numStart = 0\n  numEnd = numCount-1\n  numStep = 1\nelse\n  numStart = numCount-1\n  numEnd = 0\n  numStep = -1\nend\n' TODO: Speed up by caching downstream IDs\nfor each numI in numStart..numEnd by numStep\n  r
ecWork = lstOrdered.get(numI)\n  ' Rewrite Formula\n  strLCaseFormulaEat = strLCaseFormula.clone\n  strFormulaEat = strFormula.clone\n  strFormulaRewrite = \"\"\n  blnNil = false\n  ' TODO: Refactor\n  ' Replace Downstream values\n  while(strFormulaEat.count > 0)\n    numPos = strLCaseFormulaEat.indexOf(\"downstream.[\")\n    if(numPos <> -1)then\n      strFormulaRewrite = strFormulaRewrite+strFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 12\n      strLCaseFormulaEat = strLCaseFormulaEat.right(
numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      numPos = strLCaseFormulaEat.indexOf(\"]\")\n      if(numPos < 1)then\n        MsgBox.error(\"Syntax Error: Could not find \"+\"[\".quote,\"DC Network Calculator\")\n        exit\n      end\n      strField = strFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 1\n      strLCaseFormulaEat = strLCaseFormulaEat.right(numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      ' Evaluate downstream part of formula\n      pntDownstream 
= ftbNetwork.returnValue(fldNetworkShape, recWork).along(100)\n      recDownstream = av.run(\"DCSewerDesign.Manhole.findDownstreamLine\", {ftbNetwork, pntDownstream})\n      if(recDownstream = nil)then\n        blnNil = true\n      else\n        fldField = ftbNetwork.findField(strField)\n        if(fldField = nil)then\n          MsgBox.error(\"FATAL ERROR: Could not find field \"+strField.quote, \"DC Network Calculator\")\n          exit\n        end\n        strValue = ftbNetwork.returnValue(fldField, recDownstream).asStr
ing\n        strFormulaRewrite = strFormulaRewrite + strValue\n      end\n    else\n      strFormulaRewrite = strFormulaRewrite + strFormulaEat\n      strFormulaEat = \"\"\n      strLCaseFormulaEat = \"\"\n    end\n  end\n  if(blnDebug)then\n    System.echo(strFormulaRewrite)\n  end\n  strLCaseFormulaEat = strLCaseFormula.clone\n  strLCaseFormulaEat = strLCaseFormulaEat.lcase\n  strFormulaEat = strFormulaRewrite.clone\n  strFormulaRewrite = \"\"\n  ' TODO: Refactor\n  ' Replace upstream values\n  while(strFormulaEat.count > 0)\n   
 numPos = strLCaseFormulaEat.indexOf(\"upstream.[\")\n    if(numPos <> -1)then\n      strFormulaRewrite = strFormulaRewrite+strFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 10\n      strLCaseFormulaEat = strLCaseFormulaEat.right(numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      numPos = strLCaseFormulaEat.indexOf(\"]\")\n      if(numPos < 1)then\n        MsgBox.error(\"Syntax Error: Could not find \"+\"[\".quote,\"DC Network Calculator\")\n        exit\n      end\n      strField = s
trFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 1\n      strLCaseFormulaEat = strLCaseFormulaEat.right(numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      ' Evaluate Upstream part of formula\n      pntUpstream = ftbNetwork.returnValue(fldNetworkShape, recWork).along(0)\n      lstUpstream = av.run(\"DCSewerDesign.Manhole.findUpstreamLines\", {ftbNetwork, pntUpstream})\n      if(lstUpstream.count < 0)then\n        blnNil = true\n      else\n        ' TODO: Allow to use maximum/
minimum upstream values\n        recUpstream = lstUpstream.get(0)\n        if(blnDebug)then\n            System.echo(\"Upstream ID: \"+ftbNetwork.returnValue(ftbNetwork.findField(\"dc_id\"), recUpstream))\n        end\n        fldField = ftbNetwork.findField(strField)\n        if(fldField = nil)then\n          MsgBox.error(\"FATAL ERROR: Could not find field \"+strField.quote, \"DC Network Calculator\")\n          exit\n        end\n        strValue = ftbNetwork.returnValue(fldField, recUpstream).asString\n        strFormulaR
ewrite = strFormulaRewrite + strValue\n      end\n    else\n      strFormulaRewrite = strFormulaRewrite + strFormulaEat\n      strFormulaEat = \"\"\n      strLCaseFormulaEat = \"\"\n    end\n  end\n\n  ' Write or calculate values  \n  if(blnNil)then\n    ftbNetwork.setValue(fldNetwork, recWork, nil)\n    if(blnDebug)then\n      System.echo(\"Writing nil value.\")\n    end\n  else\n    if(blnDebug)then\n      System.echo(strFormulaRewrite)\n    end\n    bmOne.clearAll\n    bmOne.set(recWork)\n    ftbNetwork.setSelection(bmOne)\n    ftb
Network.updateSelection\n    if(ftbNetwork.calculate(strFormulaRewrite, fldNetwork).not)then\n      MsgBox.error(\"Calculation of formula \"+strFormulaRewrite.quote+\" failed.\", \"DC Network Calculator\")\n      exit\n    end\n  end\n  if(blnDebug)then\n    System.echo(ftbNetwork.returnValue(ftbNetwork.findField(\"dc_id\"), recWork))\n  end\n  ' Update status display\n  if(av.setStatus((numDone/numToGo)*100).not)then\n    ' User hit the stop button\n    exit\n  end\n\n  numDone = numDone + 1\n  ' Update status display\n  if(av.set
Status((numDone/numToGo)*100).not)then\n    ' User hit the stop button\n    exit\n  end  \nend\n\n' Restore the original selection\nftbNetwork.setSelection(bmSelection)\nftbNetwork.updateSelection"
	SearchStr:	"field"
	FontSize:	1
)

(DocWin.111
	Owner:	110
	X:	-4
	Y:	-4
	W:	1690
	H:	911
)

(CSMgr.112
)

(DocAct.113
	Doc:	110
)

(SEd.114
	Name:	"DCSewerDesign.NetworkCalculator.update"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 28. Januar 2005 21:58:39"
	GUIName:	"Script"
	Win:	115
	CSMgr:	116
	DocExts:	117
	Source:	"'DCSewerDesign.NetworkCalculator.update\n\n' Enable the NetworkCalculator if the table belongs to a line theme and is\n' editable\n\n' (c) 2004, 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY;
 without even the implied warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\n' Update script for menu\n' No arguments\n' Returns nothing\n\ntableActive = av.getActiveDoc\nblnEnabled = false\nif(tableActive.getVTab.isEditable
)then\n  if(tableActive.getActiveField <> nil)then\n    if(tableActive.getVTab.findField(\"Shape\")<>nil)then\n      if(tableActive.getVTab.findField(\"Shape\").getType = #FIELD_SHAPELINE)then\n        blnEnabled = true\n      end\n    end\n  end\nend\nself.setEnabled(blnEnabled)\n\n"
	FontSize:	1
)

(DocWin.115
	Owner:	114
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.116
)

(DocAct.117
	Doc:	114
)

(SEd.118
	Name:	"DCSewerDesign.Profile.buildLineList"
	Creator:	"sdteffen"
	CreationDate:	"04 August 2005 11:44:33"
	GUIName:	"Script"
	Win:	119
	CSMgr:	120
	DocExts:	121
	Source:	"' DCSewerDesign.Profile.buildLineList\n\n' Order a sequence of line segments according to the line direction\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied 
warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nftbLine = self.get(0)\nfldLineDcId = self.get(1)\n\nif(ftbLine.is(FTab).not)then\n  System.echo(\"DCSewerDesign.Profile.builLineList() ERROR: First argument is not an FTab\"
)\n  exit  \nend\n\nif(fldLineDcId.is(Field).not)then\n  System.echo(\"DCSewerDesign.Profile.builLineList() ERROR: Second argument is not a Field.\")\n  exit\nend\n\nfldLineShape = ftbLine.findField(\"Shape\")\n\n' Get one selected line\nbmpSelectedLines = ftbLine.getSelection.clone\nif(bmpSelectedLines.count < 2)then\n  MsgBox.info(\"Please select the Lines for which the Profile should be created\",\"DC Sewer Design\")\n  exit\nend\nrecTrace = bmpSelectedLines.getNextSet(-1)\nlstConnectedLines=av.run(\"DCSewerDesign.Line.findConnect
edLines\",{ftbLine,recTrace})\nlstConnectedSelected = List.make\nfor each recConnected in lstConnectedLines\n  if(bmpSelectedLines.get(recConnected))then\n    lstConnectedSelected.add(recConnected)\n  end\nend\n\nav.showStopButton\nnumSelected = bmpSelectedLines.count\n\n' trace to end section (of selection)\nnumFreezePrevent = 0\nlstTried = List.make\nwhile(lstConnectedSelected.count = 2)\n    if((recTrace = lstConnectedSelected.get(0))or(lstTried.findByValue(recTrace)<>(-1)))then\n    recTrace = lstConnectedSelected.get(1
)\n  else\n    recTrace = lstConnectedSelected.get(0)\n  end\n  if(lstConnectedSelected.findByValue(recTrace) = -1)then\n    lstConnectedSelected.add(recTrace)\n  end\n  lstConnectedSelected = List.make\n  strControl = \"\"\n  lstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\n  if(Number.makeRandom(0,1) > 0.5)then\n    lstConnectedLines.sort(true)\n  else\n    lstConnectedLines.sort(false)\n  end\n  for each recConnected in lstConnectedLines\n    if((bmpSelectedLines.get(recConnected)and(l
stConnectedSelected.find(recConnected) = -1)))then\n      lstConnectedSelected.add(recConnected)\n      lstTried.add(recConnected)\n      strControl = strControl ++ftbLine.returnValue(fldLineDcId, recConnected).asString\n    end\n  end\n  numFreezePrevent = numFreezePrevent+1\n  if(numFreezePrevent = 10000)then\n    System.echo(strControl)\n    MsgBox.info(\"Went into endless loop. Check the Topology.\", \"DC Sewer Design\")\n    exit\n  end\n  if(av.setStatus(0).not)then\n    exit\n  end\nend\nif(lstConnectedSelected.count>2)
then\n  MsgBox.info(\"Can't draw Profile for forks. Please check the selection.\",\"DC Sewer Design\")\n  exit\nend\n\n' bounce: start the real trace to other end of selection\n\nlstProfileLines = List.make\nlstProfileLines.add(recTrace)\n\nrecTrace = lstConnectedSelected.get(0)\nlstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\nlstConnectedSelected = List.make\nfor each recConnected in lstConnectedLines\n  if(bmpSelectedLines.get(recConnected))then\n    lstConnectedSelected.add(recConnecte
d)\n  end\nend\nlstProfileLines.add(recTrace)\n\nwhile(lstConnectedSelected.count = 2)\n  if(lstProfileLines.findByValue(lstConnectedSelected.get(0)) <> -1)then\n    recTrace = lstConnectedSelected.get(1)\n  else\n    recTrace = lstConnectedSelected.get(0)\n  end\n  lstProfileLines.add(recTrace)\n  lstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\n  lstConnectedSelected = List.make\n  for each recConnected in lstConnectedLines\n    if(bmpSelectedLines.get(recConnected))then\n      lstCon
nectedSelected.add(recConnected)\n    end\n  end\n  if(av.setStatus(lstProfileLines.count/numSelected*100).not)then\n    exit\n  end\nend\nif(lstConnectedSelected.count>2)then\n  MsgBox.info(\"Can't draw profile for forks. Please check the selection.\",\"DC Sewer - Complex Profile\")\n  exit\nend\nif(lstProfileLines.count <> bmpSelectedLines.count)then\n  MsgBox.info(\"Selected lines are not fully connected. Please check.\",\"DC Sewer - Complex Profile\")\n  exit\nend\n\nftbLine.setSelection(bmpSelectedLines)\n\n' Reverse list if ne
cessary\n\npllLine = ftbLine.returnValue(fldLineShape, lstProfileLines.get(0))\npllSecondLine = ftbLine.returnValue(fldLineShape, lstProfileLines.get(1))\nif(pllSecondLine.distance(pllLine.along(100)) > 0.1)then\n   lstProfileLines = av.run(\"DCSewerDesign.List.flip\", lstProfileLines)\nend\n\nreturn lstProfileLines"
	FontSize:	1
)

(DocWin.119
	Owner:	118
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.120
)

(DocAct.121
	Doc:	118
)

(SEd.122
	Name:	"DCSewerDesign.Profile.buildNodeList"
	Creator:	"sdteffen"
	CreationDate:	"04 August 2005 11:48:00"
	GUIName:	"Script"
	Win:	123
	CSMgr:	124
	DocExts:	125
	Source:	"' DCSewerDesign.Profile.buildNodeList\n\n' Build the list of nodes for a given sequence of line segments\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied warr
anty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nftbLine = self.get(0)\nftbManhole = self.get(1)\nlstProfileLines = self.get(2)\n\nif(ftbLine.is(FTab).not)then\n  System.echo(\"DCSewerDesign.Profile.buildNodeList() ERROR: Firs
t argument is not an FTab\")\n  exit  \nend\n\nif(ftbManhole.is(FTab).not)then\n  System.echo(\"DCSewerDesign.Profile.buildNodeList() ERROR: Second argument is not an FTab\")\n  exit  \nend\n\nif(lstProfileLines.is(List).not)then\n  System.echo(\"DCSewerDesign.Profile.buildNodeList() ERROR: Third argument is not a List\")\n  exit\nend\n\nlstProfileManholes = List.make\n\nlstPreviousManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,lstProfileLines.get(0)}).clone\nlstManholes = av.run(\"DCSewerDesign.Line.find
Manholes\",{ftbLine,ftbManhole,lstProfileLines.get(1)}).clone\nfor each recManhole in lstPreviousManholes\n  if(lstManholes.findByValue(recManhole) = -1)then\n    lstProfileManholes.add(recManhole)\n  end\nend\n\nfor each recLine in lstProfileLines\n  lstManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,recLine})\n  for each recManhole in lstManholes\n    if(lstProfileManholes.findByValue(recManhole) = -1)then\n      lstProfileManholes.add(recManhole)\n    end\n  end\nend\n\n' check if there are enough
 manholes\nif(lstProfileManholes.count <> (lstProfileLines.count + 1))then\n  MsgBox.info(\"Only found\"++lstProfileManholes.count.asString++\"manholes. Should find\"++(lstProfileLines.count+1).asString++\".\"+NL+\n              \"See the selection for details.\",\"DC Sewer - Complex Profile\")\n  bmpManholes = ftbManhole.getSelection\n  bmpManholes.clearAll\n  for each recManhole in lstProfileManholes\n    bmpManholes.set(recManhole.clone)\n  end\n  ftbManhole.setSelection(bmpManholes)\n  ftbManhole.updateSelection\n  exit\nend
\n\nreturn lstProfileManholes\n"
	FontSize:	1
)

(DocWin.123
	Owner:	122
	X:	837
	W:	837
	H:	400
)

(CSMgr.124
)

(DocAct.125
	Doc:	122
)

(SEd.126
	Name:	"DCSewerDesign.Profile.ConstantGradient.calculate"
	Creator:	"sdteffen"
	CreationDate:	"04 August 2005 11:37:10"
	GUIName:	"Script"
	Win:	127
	CSMgr:	128
	DocExts:	129
	Source:	"' DCSewerDesign.Profile.ConstantGradient.calculate\n\n' Calculate a constant gradient for a sequence of line segments\n\n' (c) 2000 - 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without e
ven the implied warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nextSewer = Extension.find(\"DC Sewer Design\")\n\nblnDebug = false\n \n' get the line table\n\nviewActive = av.getActiveDoc\nthmLine = viewActive.getEditableThe
me\nftbLine = thmLine.getFTab \nfldLineDcId = ftbLine.findField(\"dc_id\")\nfldLineShape = ftbLine.findField(\"Shape\")\nif(fldLineDcId.asString = \"nil\")then\n  MsgBox.error(\"Error: Field Line.DC_ID was not found.\",\"DC Sewer Design\")\n  exit\nend\n\nlstFields = ftbLine.getFields.deepclone\n\n' Search preferences for upstream/downstream fields\n\ndicPreferences = extSewer.getPreferences\n\nfldUpstream = nil\nstrUpstream = dicPreferences.get(\"strUpstreamField\")\nif(strUpstream <> nil)then\n  fldUpstream = ftbLine.findField(strUpst
ream)\nend\nfldDownstream = nil\nstrDownstream = dicPreferences.get(\"strDownstreamField\")\nif(strDownstream <> nil)then\n  fldDownstream = ftbLine.findField(strDownstream)\nend\n\nfldGradient = nil\nstrGradient = dicPreferences.get(\"strGradientField\")\nif(strGradient <> nil)then\n  fldGradient = ftbLine.findField(strGradient)\nend  \n\n' Let the user choose the fields if necessary\n\nif((fldUpstream = nil) or (fldDownstream = nil) or (fldGradient = nil))then\n  lstNumberFields = av.run(\"DCSewerDesign.Fields.returnNumberFiel
ds\",lstFields)\n  fldUpstream = MsgBox.choice(lstNumberFields, \"Select upstream field.\"+NL+\n                              \"This field will be overwritten for some records.\",\"DC Sewer Design\")\n  if(fldUpstream = nil)then\n    exit\n  end\n  fldDownstream = MsgBox.choice(lstNumberFields, \"Select downstream field.\"+NL+\n                              \"This field will be overwritten for some records.\",\"DC Sewer Design\")\n  if(fldDownstream = nil)then\n    exit\n  end\n  fldGradient = MsgBox.choice(lstNumberFields, \"Selec
t gradient field.\"+NL+\n    \"This field will be overwritten.\", \"DC Sewer Design\")\n  if(fldGradient = nil)then\n    exit\n  end  \n  strUpstream = fldUpstream.getName\n  dicPreferences.set(\"strUpstreamField\", strUpstream)\n  strDownstream = fldDownstream.getName\n  dicPreferences.set(\"strDownstreamField\", strDownstream)\n  strGradient = fldGradient.getName\n  dicPreferences.set(\"strGradientField\", strGradient)\nend\nif(blnDebug)then\n  System.echo(fldUpstream.getName)\n  System.echo(fldDownstream.getName)\nend\nfldUpstream
 = ftbLine.findField(fldUpstream.getName)\nfldDownstream = ftbLine.findField(fldDownstream.getName)\nfldGradient = ftbLine.findField(fldGradient.getName)\n\nlstProfileLines = av.run(\"DCSewerDesign.Profile.buildLineList\", {ftbLine, fldLineDcId})\nfor each recLine in lstProfileLines\n  if(blnDebug)then\n    System.echo(ftbLine.returnValue(fldLineDcId, recLine)+ftbLine.returnValue(fldUpstream, recLine).asString)\n  end\nend\n\n' Get first upstream value\n\nnumFirstUpstream = ftbLine.returnValue(fldUpstream, lstProfileLines
.get(0))\n\n' Get last downstream value\n\nnumLastDownstream = ftbLine.returnValue(fldDownstream, lstProfileLines.get(lstProfileLines.count-1))\n\n' Calculate segment, total length\n\nlstSegmentLength = List.make\nnumTotalLength = 0\nfor each recLine in lstProfileLines\n  pllShape = ftbLine.returnValue(fldLineShape, recLine)\n  numSegmentLength = pllShape.returnLength\n  numTotalLength = numTotalLength + numSegmentLength\n  lstSegmentLength.add(numSegmentLength)\nend\n\n' Calculate Gradient\nif(blnDebug)then\n  System.echo(\"F
irstUpstream: \"+numFirstUpstream.asString)\n  System.echo(\"Last Downstream: \"+numLastDownstream.asString)\n  System.echo(\"Total Length: \"+numTotalLength.asString)\nend\nnumGradient = (numFirstUpstream - numLastDownstream)/numTotalLength\n\n\n' Request approval\n\nblnApproval = MsgBox.yesNoCancel(\"Interpolate \"+strUpstream.quote+\",\"+strDownstream.quote+\" fields for \"+\n  lstProfileLines.count.asString+\" segments? Gradient \"+\n  numGradient.asString+\" will be written to \" + strGradient.quote+\n  \". Selecting \"\"No\"\" will 
allow to reselect the fields\",\"DC Sewer Design\", true)\n\nif(blnApproval = nil)then\n  exit\nend\n\nif(blnApproval.not)then\n  dicPreferences.remove(\"strUpstreamField\")\n  dicPreferences.remove(\"strDownstreamField\")\n  dicPreferences.remove(\"strGradientField\")\n  exit\nend\n\n' Interpolate\nif(numGradient.isNull)then\n  MsgBox.error(\"Gradient is Null\", \"DC Sewer Design\")\n  exit\nend\nnumElevation = numFirstUpstream\nnumI = 0\nfor each recLine in lstProfileLines\n  ftbLine.setValue(fldUpstream, recLine, numElevation)\n  ftbLine.
setValue(fldGradient, recLine, numGradient)\n  numSegmentLength = lstSegmentLength.get(numI)\n  numElevation = numElevation - (numSegmentLength*numGradient)\n  if(blnDebug)then\n    System.echo(numElevation.asString)\n  end  \n  ftbLine.setValue(fldDownstream, recLine, numElevation)\n  numI = numI + 1\nend\n\n' Control Result\nif((numElevation-numLastDownstream).abs > (numLastDownstream/1000))then\n  System.echo(\"DCSewerDesign.Profile.ConstantGradient.calculate(): More than 1/1000 difference in control.\")\nend"
	SearchStr:	"echo"
	FontSize:	1
)

(DocWin.127
	Owner:	126
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.128
)

(DocAct.129
	Doc:	126
)

(SEd.130
	Name:	"DCSewerDesign.Profile.ConstantGradient.update"
	Creator:	"sdteffen"
	CreationDate:	"07 August 2005 10:32:26"
	GUIName:	"Script"
	Win:	131
	CSMgr:	132
	DocExts:	133
	Source:	"' DCSewerDesign.Profile.ConstantGradient.update\n\n' Calculate a constant gradient for a sequence of line segments\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the im
plied warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nblnDebug = false\n\nviewActive = av.getActiveDoc\nblnEnabled = false\nthmEditable = viewActive.getEditableTheme\nif(thmEditable <> nil)then\n  ftbTheme = thmEditable.g
etFTab\n  if(ftbTheme <> nil)then\n    if(ftbTheme.getShapeClass.getClassName = \"Polyline\")then\n      bmpSelection = ftbTheme.getSelection\n      if(bmpSelection.count > 1)then\n        blnEnabled = true\n      else\n        if(blnDebug)then\n          System.echo(\"At least two records have to be selected.\")\n        end\n      end\n    else\n      if(blnDebug)then\n        System.echo(\"Wrong class name:\"+ftbTheme.getShapeClass.getClassName)\n      end\n    end\n  else\n    if(blnDebug)then\n      System.echo(\"No FTab\")\n   
 end  \n  end    \nelse\n  if(blnDebug)then\n    System.echo(\"No editable theme\")\n  end\nend\nself.setEnabled(blnEnabled)\n\n"
	FontSize:	1
)

(DocWin.131
	Owner:	130
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.132
)

(DocAct.133
	Doc:	130
)

(SEd.134
	Name:	"DCSewerDesign.Profile.CumulativeLineDataBox.create"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 18:43:37"
	GUIName:	"Script"
	Win:	135
	CSMgr:	136
	DocExts:	137
	Source:	"' DCSewerDesign.Profile.CumulativeLineDataBox.create\n\n' arguments: Profile FTab, Line FTab, active View, X-Coordinate, \n'            Y-Coordinate, Data Fieldname, Label String, Line Record List,\n'            Int Precision, Int Height\n\n' returns the new Y-Coordinate\n\n' (c) 2000 - 2004 DORSCH Consult\n\n' Parameter\nif(self.count <> 11)then\n  System.echo(\"DCSewerDesign.Profile.CumulativeLineDataBox.create: ERROR: Expected 11 arguments\")\n  exit\nend\nftbProfile = self.get(0)\nftbLine = self.get(1)\nviewActive = self.
get(2)\nnumX = self.get(3)\nnumY = self.get(4)\nfldData = self.get(5)\nstrLabel = self.get(6)\nlstLineRecords = self.get(7)\nnumPrecision = self.get(8)\nnumHeight = self.get(9)\nnumJustification = self.get(10)\n\nnumI = 0\nfor each objArgument in self\n  if(objArgument.asString=\"nil\")then\n    System.echo(\"DCSewerDesign.ProfileCumulativeLineDataBox.create: Argument\"++numI.asString++\"=nil\")\n  end\n  numI = numI+1\nend\n\nstrFormat = \"dd\"\nif(numPrecision > 0)then\n  strFormat = \"d.\"\n  for each i in 1..numPrecision\n     strForm
at = strFormat+\"d\"\n  end\nend\n\nfldProfileShape = ftbProfile.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\nfldProfileStyle = ftbProfile.findField(\"style\")\n\n' label the box\n\ngtxLabel = GraphicText.make(strLabel,Point.make(0,0))\nviewActive.getGraphics.add(gtxLabel)\n'numHeight = gtxLabel.getExtent.getY+1\ntpsLabel = TextPositioner.make(Point)\ntpsLabel.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\ntpsLabel.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\npntLabelLocation = Point.make(numX-58, numY-(numHeight/2)+1)\ntp
sLabel.calculate(pntLabelLocation, gtxLabel.GetExtent, 1, nil)\ngtxLabel.SetOrigin(tpsLabel.GetOrigin)\nfor each symText in gtxLabel.returnSymbols\n  viewActive.getDisplay.hookupSymbol(symText)\nend\n\nrecProfile = ftbProfile.addRecord\npntVerticalLineStart = Point.make(numX, numY)\npntVerticalLineEnd = Point.make(numX, numY-numHeight)\npllVerticalLine = Polyline.make({{pntVerticalLineStart, pntVerticalLineEnd}})\nftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\nftbProfile.setValue(fldProfileStyle, r
ecProfile, \"normal\")\n\nstrPreviousText = \" \"\nnumCumulativeLength = 0\n\n' draw data texts\nnumWidth = 0\nfor each i in 0..(lstLineRecords.count-1)\n  recLine = lstLineRecords.get(i)\n  numLength = ftbLine.returnValue(fldLineShape, recLine).returnLength\n  if(fldData.isTypeShape)then\n    strText = ftbLine.returnValue(fldData, recLine).returnLength.setFormat(strFormat).asString\n  else\n    strText = ftbLine.returnValue(fldData, recLine)\n    if(strText.is(Number))then\n      strText = strText.setFormat(strFormat).asStri
ng\n    end\n  end\n  if((strText = nil)or(strText=\"\"))then\n    strText = \" \"\n  end\n  if((strText <> strPreviousText) and(i<>0))then\n    pntTextLocation = Point.make(numX+numWidth-(numCumulativeLength/2),numY-(numHeight/2)+1)\n    if(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n      pntTextLocation = Point.make(numX+numWidth,numY-(numHeight/2)+1)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n      pntTextLocation = Point.make(numX,numY-(numHeight/2)+1)\n    end\n    gtxText = GraphicText.make(st
rPreviousText, pntTextLocation)\n    viewActive.getGraphics.add(gtxText)\n    tpsText = TextPositioner.make(Point)\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n    if(numJustification = #TEXTCOMPOSER_JUST_CENTER)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n      tpsTex
t.setHAlign(#TEXTPOSITIONER_HALIGN_LEFT)\n    end\n    tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n    gtxText.setOrigin(tpsText.getOrigin)\n    for each symText in gtxText.returnSymbols\n      viewActive.getDisplay.hookupSymbol(symText)\n    end\n    recProfile = ftbProfile.addRecord\n    pllVerticalLine.move(numCumulativeLength, 0)\n    ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n    numCumulativeLength = 0\n  en
d\n  numWidth = numWidth + numLength\n  numCumulativeLength = numCumulativeLength + numLength\n  strPreviousText = strText\nend\n\nif(strPreviousText <> \" \")then\n  pntTextLocation = Point.make(numX+numWidth-(numCumulativeLength/2),numY-(numHeight/2)+1)\n    if(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n      pntTextLocation = Point.make(numX+numWidth,numY-(numHeight/2)+1)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n      pntTextLocation = Point.make(numX,numY-(numHeight/2)+1)\n    end\n\n    gtxT
ext = GraphicText.make(strPreviousText, pntTextLocation)\n    viewActive.getGraphics.add(gtxText)\n    tpsText = TextPositioner.make(Point)\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n     if(numJustification = #TEXTCOMPOSER_JUST_CENTER)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\n    elseif(numJustification = #TEXTCOMPOSER_JU
ST_RIGHT)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_LEFT)\n    end\n    tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n    gtxText.setOrigin(tpsText.getOrigin)\n    for each symText in gtxText.returnSymbols\n      viewActive.getDisplay.hookupSymbol(symText)\n    end\nend\n\n'draw the box\npntBoxOrigin = Point.make(numX-60, numY-numHeight)\npntBoxSize = Point.make(numWidth+60+20, numHeight)\npllFrame = Rect.make(pntBoxOrigin, pntBoxSize).asPolygon.asPolyline\nrecProfile = ftbProfile.addRecord\nftb
Profile.setValue(fldProfileShape, recProfile, pllFrame)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\nreturn numY-numHeight\n"
	SearchStr:	"isTypeShape"
	FontSize:	1
)

(DocWin.135
	Owner:	134
	X:	-4
	Y:	-4
	W:	1690
	H:	911
)

(CSMgr.136
)

(DocAct.137
	Doc:	134
)

(SEd.138
	Name:	"DCSewerDesign.Profile.LineDataBox.create"
	Creator:	"sdteffen"
	CreationDate:	"Sonntag, 28. Mai 2000 10:04:47"
	GUIName:	"Script"
	Win:	139
	CSMgr:	140
	DocExts:	141
	Source:	"' DCSewerDesign.Profile.LineDataBox.create\n\n' arguments: Profile FTab, Line FTab, active View, X-Coordinate, \n'            Y-Coordinate, Data Fieldname, Label String, Line Record List,\n'            Int Precision, Int Height\n\n' returns the new Y-Coordinate\n\n' (c) 2000 DORSCH Consult\n\n' Parameter\nif(self.count <> 11)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: ERROR: Expected 11 arguments, got \"+self.count.asString)\n  exit\nend\nftbProfile = self.get(0)\nif(ftbProfile.is(FTab).not)then\n  System.
echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 0 is not an FTab\")\n  exit\nend\nftbLine = self.get(1)\nif(ftbLine.is(FTab).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 1 is not an FTab\")\n  exit\nend\nviewActive = self.get(2)\nif(viewActive.is(View).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 2 is not a View\")\n  exit\nend\nnumX = self.get(3)\nif(numX.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 3 is not a Nu
mber\")\n  exit\nend\nnumY = self.get(4)\nif(numY.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 4 is not a Number\")\n  exit\nend\nfldData = self.get(5)\nif(fldData.is(Field).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 5 is not a Field\")\n  exit\nend\nstrLabel = self.get(6)\nif(strLabel.is(String).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 6 is not a String\")\n  exit\nend\nlstLineRecords = self.get(7)\nif(lstLineRecords.is(
List).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 7 is not a Number\")\n  exit\nend\nnumPrecision = self.get(8)\nif(numPrecision.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 8 is not a Number\")\n  exit\nend\nnumHeight = self.get(9)\nif(numHeight.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 9 is not a Number\")\nend\nnumJustification = self.get(10)\nif(numJustification.is(EnumerationElt).not)then\n  System.echo
(\"DCSewerDesign.Profile.LineDataBox.create: Argument 10 is not a EnumerationElt but a \"+numJustification.getClass.getClassName)\nend\n\nstrFormat = \"dd\"\nif(numPrecision > 0)then\n  strFormat = \"d.\"\n  for each i in 1..numPrecision\n     strFormat = strFormat+\"d\"\n  end\nend\n\nfldProfileShape = ftbProfile.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\nfldProfileStyle = ftbProfile.findField(\"style\")\n\n' label the box\n\ngtxLabel = GraphicText.make(strLabel,Point.make(0,0))\nviewActive.getGraphics.add(gtxLabe
l)\n'numHeight = gtxLabel.getExtent.getY+1\ntpsLabel = TextPositioner.make(Point)\ntpsLabel.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\ntpsLabel.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\npntLabelLocation = Point.make(numX-58, numY-(numHeight/2)+1)\ntpsLabel.calculate(pntLabelLocation, gtxLabel.GetExtent, 1, nil)\ngtxLabel.SetOrigin(tpsLabel.GetOrigin)\nfor each symText in gtxLabel.returnSymbols\n  viewActive.getDisplay.hookupSymbol(symText)\nend\n\nrecProfile = ftbProfile.addRecord\npntVerticalLineStart = Point.make(numX, numY
)\npntVerticalLineEnd = Point.make(numX, numY-numHeight)\npllVerticalLine = Polyline.make({{pntVerticalLineStart, pntVerticalLineEnd}})\nftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\n' draw data texts\nnumWidth = 0\nfor each i in 0..(lstLineRecords.count-1)\n  recLine = lstLineRecords.get(i)\n  numLength = ftbLine.returnValue(fldLineShape, recLine).returnLength\n  if(fldData.isTypeShape)then\n    strText = ftbLine.returnValue(fldData, re
cLine).returnLength.setFormat(strFormat).asString\n  else\n    strText = ftbLine.returnValue(fldData, recLine)\n    if(strText.is(Number))then\n      strText = strText.setFormat(strFormat).asString\n    end\n  end\n  pntTextLocation = Point.make(numX+numWidth+(numLength/2), numY-(numHeight/2)+1)\n  if(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n    pntTextLocation = Point.make(numX+numWidth, numY-(numHeight/2)+1)\n  elseif(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n    pntTextLocation = Point.make(numX+num
Width+(numLength), numY-(numHeight/2)+1)\n  end\n  gtxText = GraphicText.make(strText, pntTextLocation)\n  viewActive.getGraphics.add(gtxText)\n  tpsText = TextPositioner.make(Point)\n  if(numJustification = #TEXTCOMPOSER_JUST_CENTER)then\n    tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n  elseif(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n    tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\n  elseif(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n    tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_LEFT)\n  end\n 
 tpsText.setVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  gtxText.setAlignment(numJustification)\n  tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n  gtxText.setOrigin(tpsText.getOrigin)\n  for each symText in gtxText.returnSymbols\n    viewActive.getDisplay.hookupSymbol(symText)\n  end\n  recProfile = ftbProfile.addRecord\n  pllVerticalLine.move(numLength, 0)\n  ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  numWidth = numWidth 
+ numLength\nend\n\n'draw the box\npntBoxOrigin = Point.make(numX-60, numY-numHeight)\npntBoxSize = Point.make(numWidth+60+20, numHeight)\npllFrame = Rect.make(pntBoxOrigin, pntBoxSize).asPolygon.asPolyline\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllFrame)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\nreturn numY-numHeight\n"
	SearchStr:	"format"
	FontSize:	1
)

(DocWin.139
	Owner:	138
	X:	-4
	Y:	-4
	W:	1690
	H:	911
)

(CSMgr.140
)

(DocAct.141
	Doc:	138
)

(SEd.142
	Name:	"DCSewerDesign.Profile.linkToLayout"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 17. November 2004 10:05:18"
	GUIName:	"Script"
	Win:	143
	CSMgr:	144
	DocExts:	145
	Source:	"' DCSewerDesign.Profile.linkToLayout\n\n' Establish a link from a designed profile back\n' to the layout via the dc_id field; use the minimum\n' error for the two x coordinates to establish the link\n\n' (c) 2004 DORSCH Consult\n\n' Called from menu.\n' No arguments.\n' Returns nothing.\n\nviewActive = av.getActiveDoc\nlstThemes = viewActive.getActiveThemes\nftbProfile = lstThemes.get(0).getFTab\nftbLine = lstThemes.get(1).getFTab\nif(lstThemes.get(0).getFTab.isEditable)then\n  ftbProfile = lstThemes.get(1).getFTab\n  ftbLin
e = lstThemes.get(0).getFTab\nend\nfldProfileDcId = ftbProfile.findField(\"dc_id\")\nif(fldProfileDcId.asString = \"nil\")then\n  MsgBox.error(\"Could not find field 'dc_id' in ground profile theme.\", \"DC Sewer Design\")\n  exit\nend\n\nfldLineDcId = ftbLine.findField(\"dc_id\")\nif(fldLineDcId.asString = \"nil\")then\n  lstFields = {Field.make(\"dc_id\", #FIELD_CHAR, 16, 0)}\n  ftbLine.addFields(lstFields)\n  fldLineDcId = ftbLine.findField(\"dc_id\")\nend\n\nfldLineUpstream = ftbLine.findField(\"upstream\")\nif(fldLineUpstream.asString 
= \"nil\")then\n  lstFields = {Field.make(\"upstream\", #FIELD_FLOAT, 16,3)}\n  ftbLine.addFields(lstFields)\n  fldLineUpstream = ftbLine.findField(\"upstream\")\nend\n\nfldLineDownstream = ftbLine.findField(\"downstream\")\nif(fldLineDownstream.asString = \"nil\")then\n  lstFields = {Field.make(\"downstream\", #FIELD_FLOAT, 16,3)}\n  ftbLine.addFields(lstFields)\n  fldLineDownstream = ftbLine.findField(\"downstream\")\nend\n\nfldLineShape = ftbLine.findField(\"shape\")\nfldProfileShape = ftbProfile.findField(\"shape\")\n\nfor each recLine 
in ftbLine\n  pllLine = ftbLine.returnValue(fldLineShape, recLine)\n  lstLinePoints = List.make\n  lstLinePoints.add(pllLine.along(0).clone)\n  lstLinePoints.add(pllLine.along(100).clone)\n  \n  ' ATTENTION: This implies a maximum trench depth of 20m\n  ftbProfile.selectByPoint(lstLinePoints.get(0), 200, #VTAB_SELTYPE_NEW)\n  \n  lstLineX = {lstLinePoints.get(0).getX, lstLinePoints.get(1).getX}\n  lstLineX.sort(true)\n  \n  bmpSelection = ftbProfile.getSelection\n  \n  ' Allow 10% error on each side\n  numMaxError = (lstL
ineX.get(1)-lstLineX.get(0))/2\n  numMinError = numMaxError\n  strDcId = nil\n  for each recProfile in bmpSelection\n    pllProfile = ftbProfile.returnValue(fldProfileShape, recProfile)\n    lstProfileX =  {pllProfile.along(0).getX, pllProfile.along(100).getX}\n    lstProfileX.sort(true)\n    numError = (lstProfileX.get(0)-lstLineX.get(0)).abs+(lstProfileX.get(1)-lstLineX.get(1)).abs\n    if(numError < numMinError)then\n      strDcId = ftbProfile.returnValue(fldProfileDcId, recProfile)\n      numMinError = numError\n 
   end\n  end\n  ftbLine.setValue(fldLineDcId, recLine, strDcId)\n  ftbLine.setValue(fldLineUpstream, recLine, (lstLinePoints.get(0).getY-1000)/10)\n  ftbLine.setValue(fldLineDownstream, recLine, (lstLinePoints.get(1).getY-1000)/10)\nend"
	FontSize:	1
)

(DocWin.143
	Owner:	142
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.144
)

(DocAct.145
	Doc:	142
)

(SEd.146
	Name:	"DCSewerDesign.Profile.linkToLayout.update"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 17. November 2004 10:12:23"
	GUIName:	"Script"
	Win:	147
	CSMgr:	148
	DocExts:	149
	Source:	"' DCSewerDesign.Profile.linkToLayout.update\n\n' (c) 2004 DORSCH Consult\n\n' Enable the \"Link Profile to Layout\" menu when two Polyline themes are\n' activated and one of them (the Profile theme) is editable\n\nviewActive = av.getActiveDoc\nlstThemes = viewActive.getActiveThemes\nblnEnabled = false\nif(lstThemes.count = 2)then\n  self.setEnabled(false)\n  if(((lstThemes.get(0).getFTab.getShapeClass.getClassName = \"Polyline\")and\n     (lstThemes.get(1).getFTab.getShapeClass.getClassName = \"Polyline\"))and\n     ((lstTheme
s.get(1).getFTab.isEditable)or(lstThemes.get(0).getFTab.isEditable)))then\n    blnEnabled = true\n  end\nend\n\nself.setEnabled(blnEnabled)\n"
	FontSize:	1
)

(DocWin.147
	Owner:	146
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.148
)

(DocAct.149
	Doc:	146
)

(SEd.150
	Name:	"DCSewerDesign.Profile.ManholeDataBox.create"
	CreationDate:	"Montag, 11. November 2002 07:24:23"
	GUIName:	"Script"
	Win:	151
	CSMgr:	152
	DocExts:	153
	Source:	"' DCSewerDesign.Profile.ManholeDataBox.create\n\n' arguments: Profile FTab, Line FTab, Manhole FTab, active View, X-Coordinate, \n'            Y-Coordinate, Data Fieldname, Label String, Manhole\n'             Record List, Line Record List,\n'            int Precision, boolean verticalText, number Height\n' returns the new Y-Coordinate\n\n' (c) 2000 - 2004 DORSCH Consult\n\n' Parameter\nif(self.count <> 14)then\n  System.echo(\"DCSewerDesign.Profile.ManholeDataBox.create: ERROR: Expected 14 arguments\")\n  exit\nend\nftbPro
file = self.get(0)\nftbLine = self.get(1)\nftbManhole = self.get(2)\nviewActive = self.get(3)\nnumX = self.get(4)\nnumY = self.get(5)\nfldData = self.get(6)\nstrLabel = self.get(7)\nlstManholeRecords = self.get(8)\nlstLineRecords = self.get(9)\nnumPrecision = self.get(10)\nblnVerticalText = self.get(11)\nnumHeight = self.get(12)\nnumJustification = self.get(13)\n\nfldProfileShape = ftbProfile.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\nfldProfileStyle = ftbProfile.findField(\"style\")\n\n' label the box\n\ngtxL
abel = GraphicText.make(strLabel,Point.make(0,0))\nviewActive.getGraphics.add(gtxLabel)\nif(numHeight = nil)then\n  numHeight = (gtxLabel.getExtent.getY*(numPrecision))\nend\ntpsLabel = TextPositioner.make(Point)\ntpsLabel.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\ntpsLabel.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\npntLabelLocation = Point.make(numX-58, numY-(numHeight/2)+1)\ntpsLabel.calculate(pntLabelLocation, gtxLabel.GetExtent, 1, nil)\ngtxLabel.SetOrigin(tpsLabel.GetOrigin)\nfor each symText in gtxLabel.returnSymbols\n 
 viewActive.getDisplay.hookupSymbol(symText)\nend\n\nrecProfile = ftbProfile.addRecord\npntVerticalLineStart = Point.make(numX, numY)\npntVerticalLineEnd = Point.make(numX, numY-numHeight)\npllVerticalLine = Polyline.make({{pntVerticalLineStart, pntVerticalLineEnd}})\n'ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\nstrFormat = \"dd\"\nif(numPrecision > 0)then\n  strFormat = \"d.\"\n  for each i in 1..numPrecision\n     strFormat = strFormat+\"d\"
\n  end\nend\n\n' draw data texts\nnumWidth = 0\nfor each i in 0..(lstManholeRecords.count-1)\n  recManhole = lstManholeRecords.get(i)\n  if(i < lstLineRecords.count) then\n    recLine = lstLineRecords.get(i)\n  end\n  numLength = ftbLine.returnValue(fldLineShape, recLine).returnLength\n  strText = ftbManhole.returnValue(fldData, recManhole)\n  if(strText.is(Number))then\n    strText = strText.setFormat(strFormat).asString\n  end\n  if(blnVerticalText)then\n    pntTextLocation = Point.make(numX+numWidth,numY-(numHeight/2))\n
    if(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n      pntTextLocation = Point.make(numX+numWidth, numY-numHeight)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n      pntTextLocation = Point.make(numX+numWidth, numY)\n    end\n  else\n    pntTextLocation = Point.make(numX+numWidth,numY-(numHeight/2)+1)\n    \n  end  \n  gtxText = GraphicText.make(strText, pntTextLocation)\n  if(blnVerticalText)then\n    gtxText.setAngle(90)\n  end\n  viewActive.getGraphics.add(gtxText)\n  tpsText = TextPositioner.m
ake(Point)\n  if(blnVerticalText)then\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n    if(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n      tpsText.setVAlign(#TEXTPOSITIONER_VALIGN_TOP)\n    elseif(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n      tpsText.setHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n      tpsText.setVAlign(#TEXTPOSITIONER_VALIGN_BOTTOM)\n    end\n  else\n    tpsText.SetHAlign(#TEX
TPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  end\n  tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n  gtxText.setOrigin(tpsText.getOrigin)\n  if(numJustification = #TEXTCOMPOSER_JUST_LEFT)then\n    gtxText.setAlignment(#TEXTCOMPOSER_JUST_RIGHT)\n  elseif(numJustification = #TEXTCOMPOSER_JUST_RIGHT)then\n    gtxText.setAlignment(#TEXTCOMPOSER_JUST_LEFT)\n  else\n    gtxText.setAlignment(#TEXTCOMPOSER_JUST_CENTER)\n  end\n  for each symText in gtxText.returnSymbols\n    vi
ewActive.getDisplay.hookupSymbol(symText)\n  end\n  recProfile = ftbProfile.addRecord\n  pllVerticalLine.move(numLength, 0)\n  'ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  if(i< lstLineRecords.count)then\n    numWidth = numWidth + numLength\n  end\nend\n\n'draw the dividing line\npntLineOrigin = Point.make(numX-60, numY)\npntLineEnd = pntLineOrigin.clone.move(numWidth+60+20, 0)\npllFrame = Line.make(pntLineOrigin, pntLineEnd).asPolylin
e\n\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllFrame)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\n\nreturn numY-numHeight\n"
	SearchStr:	"ftbLine"
	FontSize:	1
)

(DocWin.151
	Owner:	150
	X:	-4
	Y:	-4
	W:	1690
	H:	911
)

(CSMgr.152
)

(DocAct.153
	Doc:	150
)

(SEd.154
	Name:	"DCSewerDesign.ThemeList.returnLineThemes"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 30. Mai 2000 14:09:15"
	GUIName:	"Script"
	Win:	155
	CSMgr:	156
	DocExts:	157
	Source:	"' DCSewerDesign.ThemeList.returnLineThemes\n\n' expects a List of Themes as the Argument. Returns the Themes which contain Lines in a list\n\n' (c) 2000 DORSCH Consult\n\nlstThemes = self\n\nlstLineThemes = List.make\n\nfor each thmCheck in lstThemes\n  strSubName = thmCheck.getSrcName.getSubName\n  if((strSubName = \"Arc\")or(strSubName = \"ArcZ\")or(strSubName=\"line\")) then\n    lstLineThemes.add(thmCheck)\n  end\nend\n\nreturn lstLineThemes.deepclone\n"
	FontSize:	1
)

(DocWin.155
	Owner:	154
	X:	663
	Y:	586
	W:	772
	H:	409
)

(CSMgr.156
)

(DocAct.157
	Doc:	154
)

(SEd.158
	Name:	"DCSewerDesign.ThemeList.returnPointThemes"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 07. Juni 2000 08:16:37"
	GUIName:	"Script"
	Win:	159
	CSMgr:	160
	DocExts:	161
	Source:	"' DCSewerDesign.ThemeList.returnPointThemes\n\n' expects a List of Themes as the Argument. Returns the Themes which contain Points in a list\n\n' (c) 2000 DORSCH Consult\n\nlstThemes = self\n\nlstPointThemes = List.make\n\nfor each thmCheck in lstThemes\n  strSubName = thmCheck.getSrcName.getSubName\n  if((strSubName = \"Node\")or(strSubName=\"Point\")) then\n    lstPointThemes.add(thmCheck)\n  end\nend\n\nreturn lstPointThemes.deepclone\n"
	SearchStr:	"Line"
	FontSize:	1
)

(DocWin.159
	Owner:	158
	X:	65
	Y:	65
	W:	811
	H:	459
)

(CSMgr.160
)

(DocAct.161
	Doc:	158
)

(SEd.162
	Name:	"DCSewerDesignExtension.canUnload"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:09:10 AM"
	GUIName:	"Script"
	Win:	163
	CSMgr:	164
	DocExts:	165
	Source:	"'DCSewerDesignExtension.canUnload\n'return(System.canUnloadLibrary(self.getDependencies.get(0)))\nreturn(true)"
	FontSize:	1
)

(DocWin.163
	Owner:	162
	X:	-4
	Y:	-4
	W:	1034
	H:	643
)

(CSMgr.164
)

(DocAct.165
	Doc:	162
)

(SEd.166
	Name:	"DCSewerDesignExtension.install"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:10:27 AM"
	GUIName:	"Script"
	Win:	167
	CSMgr:	168
	DocExts:	169
	Source:	"'DCSewerDesignExtension.install\n'Make sure there is a project\nif (av.GetProject = nil) then\n  return nil\nend\n\n' The self object for this script is the extension\n\n'Add the menu after the view's Theme menu \ntheMenuBar = av.GetProject.FindGUI(\"View\").GetMenuBar\nm = theMenuBar.FindByLabel(\"Theme\")\nif (m <> nil) then\n  'DC Sewer Design menu\n  theMenuBar.Add(self.Get(0), theMenuBar.getControls.find(m))    \nelse\n'DC Sewer Design menu\n  theMenuBar.Add(self.get(0), 999)\nend\n\n' add the buttons at the end of the butto
n bar\ntheViewButtonBar = av.GetProject.FindGUI(\"View\").getButtonBar\n\n' profile creation button\ntheViewButtonBar.add(self.get(1), 999)\n\nmbTable = av.getProject.findGUI(\"Table\").getMenuBar\n\nmenuTable = mbTable.findByLabel(\"Table\")\nif(menuTable <> nil)then\n  mbTable.add(self.get(2), mbTable.getControls.find(menuTable))\nelse\n  mbTable.add(self.get(2), 999)\nend\n\n' Add the constant gradient calculation button\ntheViewButtonBar.add(self.get(3), 999)\n\nav.getProject.findGUI(\"View\").setModified(true)\nav.getProject.fin
dGUI(\"Table\").setModified(true)"
	FontSize:	1
)

(DocWin.167
	Owner:	166
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.168
)

(DocAct.169
	Doc:	166
)

(SEd.170
	Name:	"DCSewerDesignExtension.make"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:11:30 AM"
	GUIName:	"Script"
	Win:	171
	CSMgr:	172
	DocExts:	173
	Source:	"' DCSewerDesignExtension.make\n\nstrVersion = msgbox.input(\"Enter version\",\"Make DC Sewer Design Extension\",\"2.0.8\")\nif (strVersion=nil)then\n  exit\nend\nnumVersion=strVersion.asTokens(\".\").get(1).asNumber\nstrFileNameVersion = strVersion.asTokens(\".\").get(0)+\"_\"+strVersion.asTokens(\".\").get(1)\n\nmyExt = Extension.Make((\"$AVEXT\\dcsewdes.avx\").AsFileName,\n              \"DC Sewer Design\",\n              av.GetProject.FindScript(\"DCSewerDesignExtension.install\"),\n              av.GetProject.FindScript(\"DCSewerDesignE
xtension.uninstall\"),\n              {})\n\n\n'0\nmyExt.Add( av.GetProject.FindGUI(\"View\").GetMenuBar.findByLabel(\"DC Sewer\"))\n\n'1\nmyExt.Add( av.GetProject.FindGUI(\"View\").GetButtonBar.findByScript(\"DCSewerDesign.ComplexProfile.create\"))\n\n'2\nmyExt.add(av.getProject.findGUI(\"Table\").getMenuBar.findByLabel(\"DC Sewer\"))\n\n'3\nmyExt.add(av.getProject.findGUI(\"View\").getButtonBar.findByScript(\"DCSewerDesign.Profile.ConstantGradient.calculate\"))\n\n' Add to the extension the scripts that are attached to the menu items\n' T
he following line shows how this would work for one such scripts.\n' You may need several such lines.\nfor each d in av.getProject.getDocs\n  if (d.is(SEd) and (d.getName.left(\"DCSewerDesign\".count+1)=\"DCSewerDesign.\"))then\n    myExt.add(d.getScript)\n  end\nend\n\nmyExt.SetAbout(\"Sewer Design Extension \"+strVersion+NL+\"(c) 2000-2005 DORSCH Consult.\"+NL+\n\"This extension is helpful to design sewer networks\")\nmyExt.SetExtVersion(numVersion)\nmyExt.setUnloadScript(av.findScript(\"DCSewerDesignExtension.unload\"))\nmyExt.
setCanUnloadScript(av.findScript(\"DCSewerDesignExtension.canUnload\"))\nmyExt.Commit\n\nRFileName = FileName.make(\"$AVEXT/dcsewdes.avx\")\nWFileName = FileName.make(\"$AVEXT/dcsewdes.tmp\")\nRFile = LineFile.make(RFileName, #FILE_PERM_READ)\nWFile = LineFile.make(WFileName, #FILE_PERM_WRITE)\nWFile.setScratch(TRUE)\nwhile (RFile.isAtEnd.not)\n  buf = RFile.ReadElt\n  if ( buf.contains(\"ObjectTag:\").not) then\n    WFile.writeElt(buf)\n  end\nend\nRFile.close\nWFile.flush\nFile.copy(WFilename, RFilename)\nWFile.close"
	FontSize:	1
)

(DocWin.171
	Owner:	170
	Open:	1
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.172
)

(DocAct.173
	Doc:	170
)

(SEd.174
	Name:	"DCSewerDesignExtension.uninstall"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:15:13 AM"
	GUIName:	"Script"
	Win:	175
	CSMgr:	176
	DocExts:	177
	Source:	"'DCSewerDesignExtension.uninstall\n\n'Make sure there is a project\nif (av.GetProject = nil) then\n  return nil\nend\n\n'Uninstall only if the project is not closing\nif (av.GetProject.IsClosing) then\n  return nil\nend\n\n'The self object for this script is the extension\n'The first root is the menu\n'The second root is the view\n'\n'Remove the menu \ntheMenubar = av.GetProject.FindGUI(\"View\").GetMenuBar\ntheMenuBar.remove(self.Get(0))\n\ntheViewButtonBar = av.GetProject.FindGUI(\"View\").getButtonBar\ntheViewButtonBar.remove(se
lf.get(1))\n\nmbTable = av.getProject.findGUI(\"Table\").getMenuBar\nmbTable.remove(self.get(2))\n\ntheViewButtonBar.remove(self.get(3))\n\n"
	FontSize:	1
)

(DocWin.175
	Owner:	174
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.176
)

(DocAct.177
	Doc:	174
)

(SEd.178
	Name:	"DCSewerDesignExtension.unload"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:57:29 AM"
	GUIName:	"Script"
	Win:	179
	CSMgr:	180
	DocExts:	181
	FontSize:	1
)

(DocWin.179
	Owner:	178
	X:	-4
	Y:	-4
	W:	1682
	H:	903
)

(CSMgr.180
)

(DocAct.181
	Doc:	178
)

(SEd.182
	Name:	"Script.saveAllScripts"
	Creator:	"sdteffen"
	CreationDate:	"Montag, 01. Mrz 2004 11:23:03"
	GUIName:	"Script"
	Win:	183
	CSMgr:	184
	DocExts:	185
	Source:	"' Script.saveAllScripts\n\n' (c) 2004 DORSCH Consult\n\n' If the scripts are to be saved elsewhere, change the following line... \n\nstrSaveDir = \"c:\\wc\\cvs-ssh.sourceforge.net\\dcwaterdesign\\dcsewdes\"\n\nif (File.exists(strSaveDir.asFilename).Not) then\n  MsgBox.Error(\"Working directory:\"++strSaveDir++\"does not exist\", \"\")\n  exit \nend\n\nlstScripts = List.make\n\n' find all scripts\n\nfor each docObj in av.getProject.getDocs\n  if (docObj.is(SEd)) then\n    lstScripts.Add(docObj)\n  end\nend\n\n' Loop over all scripts, write to
 files\n\nblnOverwrite = nil\nnumWritten = 0\n	\nlstScriptsToWrite = List.make\n\nfor each sedScript in lstScripts\n\n  strSaveDir2 = strSaveDir.clone\n  strScriptName = sedScript.asString ' .substitute(\".\",\",\")\n   \n  flnScript = FileName.merge(strSaveDir2, strScriptName)\n  ' System.echo(flnScript.getFullName)\n  flnScript.setName(strScriptName+\".ave\")\n  if (flnScript.isFile) then\n    if(blnOverwrite = nil)then\n      blnOverwrite = MsgBox.YesNo(\"Overwrite files?\", \"Saving Scripts\", false)\n      if(blnOverwrite.not)the
n\n        continue \n      end\n    end\n      \n    ' check if file has been changed\n    txfScript = TextFile.make(flnScript, #FILE_PERM_READ)\n    strFileSource = txfScript.read(txfScript.getSize)\n    blnChanged = false\n    if(strFileSource <> sedScript.getSource)then\n      blnChanged = true\n    end\n    txfScript.close\n    if(blnChanged)then\n    '  File.delete(flnScript)\n    else\n     continue\n    end\n  end \n  \n  txfScript = TextFile.make(flnScript, #FILE_PERM_WRITE)\n  if (txfScript <> nil) then\n    txfScript.
write(sedScript.getSource, sedScript.getSource.count)\n    txfScript.close\n    numWritten = numWritten+1\n  else\n    MsgBox.warning(\"Unable to open file for writing:\"++flnScript.getFullName,\"Saving Scripts\")\n  end\nend\nMsgBox.info(numWritten.asString++\"Scripts were written.\", \"Saving Scripts\")\n"
	FontSize:	1
)

(DocWin.183
	Owner:	182
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.184
)

(DocAct.185
	Doc:	182
)

(LButn.186
	HelpTopic:	"New_button"
	Update:	"Doc.NewUpdate"
	Label:	"&New"
	Click:	"Script.New"
)

(LButn.187
	HelpTopic:	"Open_button"
	Update:	"Doc.OpenUpdate"
	Label:	"&Open"
	Click:	"Doc.Open"
)

(LButn.188
	HelpTopic:	"Run_button"
	Update:	"Script.ActionUpdate"
	Label:	"&Run"
	Click:	"Script.Action"
)

(FN.189
	Path:	"$AVEXT/script_tools_jen.avx"
)

(FN.190
	Path:	"$AVEXT/cadview.avx"
)

(FN.191
	Path:	"$AVEXT/geoproc.avx"
)

(NameDict.192
)

(NameDict.193
	Obj:	194
	Obj:	195
	Obj:	196
	Obj:	671
)

(AVDict.194
	InternalName:	"Table of Contents Defaults Dialog"
)

(AVDict.195
	InternalName:	"Dialog Designer"
)

(AVDict.196
	InternalName:	"_Thor_"
	Key:	197
	Value:	198
)

(AVStr.197
	S:	"DLOGS"
)

(NameDict.198
)

(AVDict.671
	InternalName:	"Geoprocessing"
	Key:	672
	Key:	673
	Value:	674
	Value:	675
)

(AVStr.672
	S:	"Loaded"
)

(AVStr.673
	S:	"Version"
)

(Bool.674
	Truth:	1
)

(Numb.675
	N:	3.10000000000000
)

(DocGUI.676
	Name:	"View"
	Type:	"View"
	Modified:	1
	Visible:	1
	MenuBar:	677
	ButnBar:	835
	Popups:	884
	ToolBar:	906
	NewScript:	"View.New"
	OpenScript:	"Doc.Open"
	ActionScript:	"Doc.Action"
	NewUpdateScript:	"Doc.NewUpdate"
	OpenUpdateScript:	"Doc.OpenUpdate"
	ActionUpdateScript:	"Doc.ActionUpdate"
	Title:	"Views"
	Icon:	983
)

(MenuBar.677
	Child:	678
	Child:	696
	Child:	716
	Child:	745
	Child:	763
	Child:	791
	Child:	809
	Child:	821
	Child:	826
)

(PMenu.678
	InternalName:	"File"
	Child:	679
	Child:	680
	Child:	681
	Child:	682
	Child:	683
	Child:	684
	Child:	686
	Child:	687
	Child:	688
	Child:	689
	Child:	690
	Child:	691
	Child:	692
	Child:	693
	Child:	694
	Child:	695
	Label:	"&File"
)

(Choice.679
	Help:	"Closes the active component"
	HelpTopic:	"Close"
	Label:	"&Close"
	Click:	"Project.CloseDoc"
	Shortcut:	"Keys.None"
)

(Choice.680
	Help:	"Closes all components"
	HelpTopic:	"Close_All"
	Label:	"Close &All"
	Click:	"Project.CloseAll"
	Shortcut:	"Keys.None"
)

(Space.681
)

(Choice.682
	Help:	"Allows you to specify the current working directory"
	HelpTopic:	"Set_Working_Directory"
	Label:	"Set &Working Directory..."
	Click:	"Project.SetProjectWorkDir"
	Shortcut:	"Keys.None"
)

(Choice.683
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.684
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.686
)

(Choice.687
	Help:	"Displays the Extensions dialog"
	HelpTopic:	"Extensions"
	Label:	"Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.688
)

(Choice.689
	Help:	"Prints the view"
	HelpTopic:	"Print"
	Label:	"&Print..."
	Click:	"View.Print"
	Shortcut:	"Keys.None"
)

(Choice.690
	Help:	"Edits the printer and the printing options"
	HelpTopic:	"Print_Setup"
	Label:	"P&rint Setup..."
	Click:	"Project.PrintSetup"
	Shortcut:	"Keys.None"
)

(Choice.691
	Help:	"Exports the view"
	HelpTopic:	"Export"
	Update:	"View.HasThemesUpdate"
	Label:	"&Export..."
	Click:	"View.ExportDisp"
	Shortcut:	"Keys.None"
)

(Space.692
)

(Choice.693
	Help:	"Displays the dialog box to delete, edit, and copy data sources"
	HelpTopic:	"Manage_Sources"
	Label:	"&Manage Data Sources..."
	Click:	"View.ManageSources"
	Shortcut:	"Keys.None"
)

(Space.694
)

(Choice.695
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.696
	InternalName:	"Edit"
	Child:	697
	Child:	698
	Child:	699
	Child:	700
	Child:	701
	Child:	702
	Child:	703
	Child:	704
	Child:	705
	Child:	706
	Child:	707
	Child:	708
	Child:	709
	Child:	710
	Child:	711
	Child:	712
	Child:	713
	Child:	714
	Child:	715
	Label:	"&Edit"
)

(Choice.697
	Help:	"Cuts the active themes to the clipboard"
	HelpTopic:	"Cut_Themes"
	Update:	"View.ActiveDeletableThemesUpdate"
	Label:	"Cut T&hemes"
	Click:	"View.CutThemes"
	Shortcut:	"Keys.None"
)

(Choice.698
	Help:	"Copies the active themes to the clipboard"
	HelpTopic:	"Copy_Themes"
	Update:	"View.ActiveThemesUpdate"
	Label:	"Cop&y Themes"
	Click:	"View.CopyThemes"
	Shortcut:	"Keys.None"
)

(Choice.699
	Help:	"Removes the active themes from the view"
	HelpTopic:	"Delete_Themes"
	Update:	"View.ActiveDeletableThemesUpdate"
	Label:	"De&lete Themes"
	Click:	"View.DeleteThemes"
	Shortcut:	"Keys.None"
)

(Space.700
)

(Choice.701
	Disabled:	1
	Help:	"Undo the last edit to graphics on a view"
	HelpTopic:	"Undo_Graphic_Edit_on_a_view"
	Update:	"View.UndoEditUpdate"
	Label:	"&Undo Graphic Edit"
	Click:	"View.UndoEdit"
	Shortcut:	"Keys.Ctrl+Z"
)

(Choice.702
	Disabled:	1
	Invisible:	1
	Help:	"Redo the last edit operation on a theme that was undone"
	HelpTopic:	"Redo_Feature_Edit_on_a_view"
	Update:	"View.RedoEditUpdate"
	Label:	"&Redo Feature Edit"
	Click:	"View.RedoEdit"
	Shortcut:	"Keys.Ctrl+Y"
)

(Space.703
)

(Choice.704
	Disabled:	1
	Help:	"Cuts the selected graphics to the clipboard"
	HelpTopic:	"Cut_Graphics"
	Update:	"View.CutUpdate"
	Label:	"Cu&t Graphics"
	Click:	"View.CutGraphics"
	Shortcut:	"Keys.Ctrl+X"
)

(Choice.705
	Disabled:	1
	Help:	"Copies the selected graphics to the clipboard"
	HelpTopic:	"Copy_Graphics"
	Update:	"View.CopyUpdate"
	Label:	"&Copy Graphics"
	Click:	"View.CopyGraphics"
	Shortcut:	"Keys.Ctrl+C"
)

(Choice.706
	Disabled:	1
	Help:	"Removes the selected graphics from the view"
	HelpTopic:	"Delete_Graphics"
	Update:	"View.DeleteUpdate"
	Label:	"&Delete Graphics"
	Click:	"View.DeleteGraphics"
	Shortcut:	"Keys.Del"
)

(Space.707
)

(Choice.708
	Disabled:	1
	Help:	"Combines the selected polygons"
	HelpTopic:	"Combine_Graphics"
	Update:	"View.CombineUpdate"
	Label:	"Com&bine Graphics"
	Click:	"View.CombineGraphics"
	Shortcut:	"Keys.None"
)

(Choice.709
	Disabled:	1
	Help:	"Unions the selected graphics to create a new graphic"
	HelpTopic:	"Union_Graphics"
	Update:	"View.UnionUpdate"
	Label:	"U&nion Graphics"
	Click:	"View.UnionGraphics"
	Shortcut:	"Keys.None"
)

(Choice.710
	Disabled:	1
	Help:	"Subtracts one selected polygon from the other selected polygon"
	HelpTopic:	"Subtract_Graphics"
	Update:	"View.SubtractUpdate"
	Label:	"&Subtract Graphics"
	Click:	"View.SubtractGraphics"
	Shortcut:	"Keys.None"
)

(Choice.711
	Disabled:	1
	Help:	"Creates a new polygon from the area  of overlap between the selected polygons"
	HelpTopic:	"Intersect_Graphics"
	Update:	"View.IntersectUpdate"
	Label:	"&Intersect Graphics"
	Click:	"View.IntersectGraphics"
	Shortcut:	"Keys.None"
)

(Space.712
)

(Choice.713
	Help:	"Inserts the contents of the clipboard"
	HelpTopic:	"Paste"
	Update:	"View.PasteUpdate"
	Label:	"&Paste"
	Click:	"View.Paste"
	Shortcut:	"Keys.Ctrl+V"
)

(Space.714
)

(Choice.715
	Disabled:	1
	Help:	"Selects all graphics in the view"
	HelpTopic:	"Select_All_Graphics"
	Update:	"View.HasGraphicsUpdate"
	Label:	"Select &All Graphics"
	Click:	"Graphic.SelectAll"
	Shortcut:	"Keys.None"
)

(PMenu.716
	InternalName:	"View"
	Child:	717
	Child:	718
	Child:	719
	Child:	720
	Child:	721
	Child:	722
	Child:	723
	Child:	724
	Child:	725
	Child:	731
	Child:	732
	Child:	733
	Child:	734
	Child:	735
	Child:	736
	Child:	737
	Child:	738
	Child:	739
	Child:	740
	Child:	741
	Child:	742
	Child:	743
	Child:	744
	Label:	"&View"
)

(Choice.717
	Help:	"Displays the dialog box to edit properties of the view"
	HelpTopic:	"View_Properties"
	Label:	"&Properties..."
	Click:	"View.Properties"
	Shortcut:	"Keys.None"
)

(Space.718
)

(Choice.719
	Help:	"Inserts themes into the view"
	HelpTopic:	"Add_Theme"
	Label:	"&Add Theme..."
	Click:	"View.Add"
	Shortcut:	"Keys.Ctrl+T"
)

(Choice.720
	Disabled:	1
	Help:	"Displays a dialog box to create a geocoded theme"
	HelpTopic:	"Geocode_Addresses"
	Update:	"View.GeocodeUpdate"
	Label:	"&Geocode Addresses..."
	Click:	"View.Geocode"
	Shortcut:	"Keys.None"
)

(Choice.721
	Help:	"Displays a dialog box to create an XY or dynamic segmentation event-based theme "
	HelpTopic:	"Add_Event_Theme"
	Update:	"View.AddEventUpdate"
	Label:	"Add &Event Theme..."
	Click:	"View.AddEvent"
	Shortcut:	"Keys.None"
)

(Choice.722
	Help:	"Creates a new theme"
	HelpTopic:	"New_Theme"
	Label:	"&New Theme..."
	Click:	"View.NewTheme"
	Shortcut:	"Keys.None"
)

(Choice.723
	Help:	"Makes all themes visible"
	HelpTopic:	"Themes_On_Themes_Off"
	Update:	"View.HasThemesUpdate"
	Label:	"&Themes On"
	Click:	"View.ThemesOn"
	Shortcut:	"Keys.None"
)

(Choice.724
	Help:	"Makes all themes invisible"
	HelpTopic:	"Themes_On_Themes_Off"
	Update:	"View.HasThemesUpdate"
	Label:	"T&hemes Off"
	Click:	"View.ThemesOff"
	Shortcut:	"Keys.None"
)

(Space.725
)

(Choice.731
	Help:	"Create a Layout from the View"
	HelpTopic:	"Layout_menu_choice"
	Update:	"View.HasThemesUpdate"
	Label:	"La&yout..."
	Click:	"View.Layout"
	Shortcut:	"Keys.None"
)

(Space.732
)

(Choice.733
	Help:	"Shows a dialog where you can change the style of the TOC"
	HelpTopic:	"TOC_Defaults"
	Update:	"TocDefs.ShowUpdate"
	Label:	"TOC Style..."
	Click:	"TocDefs.Show"
	Shortcut:	"Keys.None"
)

(Space.734
)

(Choice.735
	Help:	"Zooms to the extent of all themes"
	HelpTopic:	"Zoom_to_Full_Extent"
	Update:	"View.HasDataUpdate"
	Label:	"Full E&xtent"
	Click:	"View.ZoomFullExtent"
	Shortcut:	"Keys.None"
)

(Choice.736
	Help:	"Zooms in on the center of the display"
	HelpTopic:	"Zoom_In"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom &In"
	Click:	"View.ZoomIn"
	Shortcut:	"Keys.None"
)

(Choice.737
	Help:	"Zooms out from the center of the display"
	HelpTopic:	"Zoom_Out"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom &Out"
	Click:	"View.ZoomOut"
	Shortcut:	"Keys.None"
)

(Choice.738
	Help:	"Zooms to the extent of active themes"
	HelpTopic:	"Zoom_to_Active_Theme"
	Update:	"View.ActiveThemesUpdate"
	Label:	"&Zoom To Themes"
	Click:	"View.ZoomToThemes"
	Shortcut:	"Keys.None"
)

(Choice.739
	Help:	"Zooms to the extent of the selected features"
	HelpTopic:	"Zoom_to_Selected"
	Update:	"View.SelectableThemesUpdate"
	Label:	"Zoom To &Selected"
	Click:	"View.ZoomToSelected"
	Shortcut:	"Keys.None"
)

(Choice.740
	Help:	"Goes back to the previous extent you were viewing"
	HelpTopic:	"Zoom_Previous"
	Update:	"View.UndoZoomUpdate"
	Label:	"Zoom Pre&vious"
	Click:	"View.UndoZoom"
	Shortcut:	"Keys.None"
)

(Space.741
)

(Choice.742
	Help:	"Finds features in the active themes using the text you enter"
	HelpTopic:	"Find"
	Update:	"View.TabularThemesUpdate"
	Label:	"&Find..."
	Click:	"View.Find"
	Shortcut:	"Keys.Ctrl+F"
)

(Choice.743
	Disabled:	1
	Help:	"Locates an address in the active, matchable theme"
	HelpTopic:	"Locate_Address"
	Update:	"View.LocateUpdate"
	Label:	"&Locate Address..."
	Click:	"View.Locate"
	Shortcut:	"Keys.None"
)

(Choice.744
	InternalName:	"GeoProc"
	Help:	"Opens the GeoProcessing Wizard"
	HelpTopic:	"geoproc_choice"
	Tag:	"GeoProcessing"
	Update:	"GeoProc.Main.Show Update"
	Label:	"GeoProcessing Wizard..."
	Click:	"GeoProc.Show"
	Shortcut:	"Keys.None"
)

(PMenu.745
	Child:	746
	Child:	747
	Child:	748
	Child:	749
	Child:	750
	Child:	751
	Child:	752
	Child:	753
	Child:	754
	Child:	755
	Child:	756
	Child:	757
	Child:	758
	Child:	759
	Child:	760
	Child:	761
	Child:	762
	Label:	"DC Sewer"
)

(Choice.746
	Label:	"Create Excel calculation"
	Click:	"DCSewerDesign.createXlsSewerCalculation"
	Shortcut:	"Keys.None"
)

(Choice.747
	Help:	"calculates the population connected to every sewer section with a network trace"
	Label:	"Accumulate Population"
	Click:	"DCSewerDesign.accumulatePopulation"
	Shortcut:	"Keys.None"
)

(Choice.748
	Help:	"accumulates the maximum branch length for a tree of sewer lines"
	Label:	"Accumulate Branch Length"
	Click:	"DCSewerDesign.accumulateBranchLength"
	Shortcut:	"Keys.None"
)

(Choice.749
	Label:	"Calculate Minimum Elevation Differences"
	Click:	"DCSewerDesign.calculateMinimumElevationDifferences"
	Shortcut:	"Keys.None"
)

(Choice.750
	Label:	"Flip Lines to Flow Direction"
	Click:	"DCSewerDesign.flipLinesToFlowDirection"
	Shortcut:	"Keys.None"
)

(Choice.751
	Disabled:	1
	Help:	"Calculates the Maximum Manhole Elevations for each line based on minimum cover and a given gradient."
	Update:	"DCSewerDesign.calculateMaximumManholeElevations.update"
	Label:	"Calculate Maximum Manhole Elevations"
	Click:	"DCSewerDesign.calculateMaximumManholeElevations"
	Shortcut:	"Keys.None"
)

(Choice.752
	Label:	"Enforce Drainage"
	Click:	"DCSewerDesign.enforceDrainage"
	Shortcut:	"Keys.None"
)

(Choice.753
	Label:	"Export Basys Ascii File"
	Click:	"DCSewerDesign.exportBasysFile"
	Shortcut:	"Keys.None"
)

(Choice.754
	Help:	"checks if the Lines contain only two vertexes"
	Label:	"Validate Lines"
	Click:	"DCSewerDesign.Lines.validate"
	Shortcut:	"Keys.None"
)

(Choice.755
	Help:	"Create a profile (L-Section) for the selected lines.//Create a profile for the selected lines."
	Label:	"Create Profile"
	Click:	"DCSewerDesign.ComplexProfile.create"
	Shortcut:	"Keys.None"
)

(Choice.756
	Help:	"Select the profile configuration file"
	Label:	"Select Profile Configuration"
	Click:	"DCSewerDesign.ComplexProfile.selectConfigurationFile"
	Shortcut:	"Keys.None"
)

(Choice.757
	Disabled:	1
	Update:	"DCSewerDesign.Profile.linkToLayout.update"
	Label:	"Link Profile to Layout"
	Click:	"DCSewerDesign.Profile.linkToLayout"
	Shortcut:	"Keys.None"
)

(Choice.758
	Help:	"transfer Manhole Data Fields to Upstream/Downstream Fields in the Line Table"
	Label:	"Manhole Data  to Line"
	Click:	"DCSewerDesign.Lines.takeoverManholeData"
	Shortcut:	"Keys.None"
)

(Choice.759
	Help:	"transfer data from the line theme to the manhole theme"
	Label:	"Line Data to Manholes"
	Click:	"DCSewerDesign.Manholes.takeoverLineData"
	Shortcut:	"Keys.None"
)

(Choice.760
	Label:	"Create Dbf Sewer Calculation"
	Click:	"DCSewerDesign.createDbfSewerCalculation"
	Shortcut:	"Keys.None"
)

(Choice.761
	Label:	"Assign Minimum Values from Points to Lines using Buffer"
	Click:	"DCSewerDesign.Lines.takeoverMinimumValuesFromBuffer"
	Shortcut:	"Keys.None"
)

(Choice.762
	Help:	"DC Sewer Design Extension Help//DC Sewer Design Extension Help"
	Label:	"Help"
	Click:	"DCSewerDesign.Help.openCHM"
	Shortcut:	"Keys.None"
)

(PMenu.763
	InternalName:	"Theme"
	Child:	764
	Child:	765
	Child:	766
	Child:	767
	Child:	768
	Child:	769
	Child:	770
	Child:	771
	Child:	772
	Child:	773
	Child:	774
	Child:	776
	Child:	777
	Child:	778
	Child:	779
	Child:	780
	Child:	781
	Child:	782
	Child:	783
	Child:	784
	Child:	785
	Child:	786
	Label:	"&Theme"
)

(Choice.764
	Help:	"Displays the dialog box to edit properties of the active theme"
	HelpTopic:	"Theme_Properties"
	Update:	"View.ActiveThemesUpdate"
	Label:	"&Properties..."
	Click:	"View.ThemeProperties"
	Shortcut:	"Keys.None"
)

(Space.765
)

(Choice.766
	Help:	"Starts or stops editing of shapefile"
	HelpTopic:	"Start_Stop_Editing_in_a_view"
	Update:	"View.ToggleEditingUpdate"
	Label:	"Start &Editing"
	Click:	"View.ToggleEditing"
	Shortcut:	"Keys.None"
)

(Choice.767
	Disabled:	1
	Help:	"Save edits to the source shapefile"
	HelpTopic:	"Save_edits_theme"
	Update:	"View.SaveEditsUpdate"
	Label:	"Save Ed&its"
	Click:	"View.SaveEdits"
	Shortcut:	"Keys.None"
)

(Choice.768
	Disabled:	1
	Help:	"Saves edits to a new shapefile"
	HelpTopic:	"Save_edits_as_theme"
	Update:	"View.SaveEditsUpdate"
	Label:	"Save E&dits As..."
	Click:	"View.SaveEditsAs"
	Shortcut:	"Keys.None"
)

(Choice.769
	Help:	"Converts a theme to a shapefile"
	HelpTopic:	"Convert_to_Shapefile"
	Update:	"View.ExportUpdate"
	Label:	"Convert to &Shapefile..."
	Click:	"View.Export"
	Shortcut:	"Keys.None"
)

(Space.770
)

(Choice.771
	Help:	"Displays the legends of the active themes"
	HelpTopic:	"Edit_Legend"
	Update:	"View.ActiveThemesUpdate"
	Label:	"Edit &Legend..."
	Click:	"View.EditLegendClick"
	Shortcut:	"Keys.None"
)

(Choice.772
	Help:	"Shows or hides the active themes' legends"
	HelpTopic:	"Hide_show_Legend"
	Update:	"View.ActiveThemesUpdate"
	Label:	"&Hide/Show Legend"
	Click:	"View.ToggleLegend"
	Shortcut:	"Keys.None"
)

(Space.773
)

(Choice.774
	Disabled:	1
	Help:	"Displays the Re-match dialog for re-matching addresses"
	HelpTopic:	"Re_match_Addresses"
	Update:	"View.EditMatchUpdate"
	Label:	"&Re-match Addresses..."
	Click:	"View.EditMatch"
	Shortcut:	"Keys.None"
)

(Space.776
)

(Choice.777
	Help:	"Labels features in active, visible themes"
	HelpTopic:	"Auto_label"
	Update:	"View.LabelThemesUpdate"
	Label:	"&Auto-label..."
	Click:	"View.LabelThemes"
	Shortcut:	"Keys.Ctrl+L"
)

(Choice.778
	Disabled:	1
	Help:	"Removes any labels from active themes"
	HelpTopic:	"Remove_Labels"
	Update:	"View.RemoveThemeLabelsUpdate"
	Label:	"Rem&ove Labels"
	Click:	"View.RemoveThemeLabels"
	Shortcut:	"Keys.Ctrl+R"
)

(Choice.779
	Disabled:	1
	Help:	"Removes the overlapping labels from active themes, if they are still green."
	HelpTopic:	"Remove_Overlapping_Labels"
	Update:	"View.RemoveOverlapThemeLabelsUpdate"
	Label:	"Remove Overlappi&ng Labels"
	Click:	"View.RemoveOverlapThemeLabels"
	Shortcut:	"Keys.None"
)

(Choice.780
	Disabled:	1
	Help:	"Converts selected overlapping labels to symbol of selected good label"
	HelpTopic:	"Convert_Overlapping_Labels"
	Update:	"View.ConvertOverlapLabelsUpdate"
	Label:	"&Convert Overlapping Labels"
	Click:	"View.ConvertOverlapLabels"
	Shortcut:	"Keys.Ctrl+O"
)

(Space.781
)

(Choice.782
	Help:	"Opens the tables of the active themes"
	HelpTopic:	"Open_Theme_Table"
	Update:	"View.TabularThemesUpdate"
	Label:	"&Table..."
	Click:	"View.ShowTable"
	Shortcut:	"Keys.None"
)

(Choice.783
	Help:	"Displays the Query Builder to select features with a logical expression"
	HelpTopic:	"Query_Builder"
	Update:	"View.AttributeThemesUpdate"
	Label:	"&Query..."
	Click:	"View.Query"
	Shortcut:	"Keys.Ctrl+Q"
)

(Choice.784
	Help:	"Selects features in the active themes using another theme's features"
	HelpTopic:	"Select_By_Theme"
	Update:	"View.SelectableThemesUpdate"
	Label:	"Select &By Theme..."
	Click:	"View.SelectByTheme"
	Shortcut:	"Keys.None"
)

(Choice.785
	Help:	"Creates buffers around features"
	HelpTopic:	"Create_Buffer_Choice"
	Update:	"WizardBuffer.OpenDialogUpdate"
	Label:	"Create Buffers..."
	Click:	"WizardBuffer.OpenDialog"
	Shortcut:	"Keys.None"
)

(Choice.786
	Help:	"Unselects the selected features of all active themes"
	HelpTopic:	"Clear_Selected_Features"
	Update:	"View.AttributeThemesUpdate"
	Label:	"Clear Selected &Features"
	Click:	"View.ClearSelect"
	Shortcut:	"Keys.None"
)

(PMenu.791
	InternalName:	"Graphics"
	Child:	792
	Child:	793
	Child:	794
	Child:	795
	Child:	796
	Child:	797
	Child:	798
	Child:	799
	Child:	800
	Child:	803
	Child:	804
	Child:	805
	Child:	806
	Child:	807
	Child:	808
	Label:	"&Graphics"
)

(Choice.792
	Disabled:	1
	Help:	"Displays the property editor for the selected graphic"
	HelpTopic:	"Graphic_Properties"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"&Properties..."
	Click:	"Graphic.Edit"
	Shortcut:	"Keys.None"
)

(Space.793
)

(Choice.794
	Help:	"Shows a dialog where you can set the default values for the label and text tools"
	HelpTopic:	"Default_settings_for_text_and_label_tools"
	Label:	"&Text and Label Defaults..."
	Click:	"Graphic.Label Defaults Show"
	Shortcut:	"Keys.None"
)

(Space.795
)

(Choice.796
	Disabled:	1
	Help:	"Displays a dialog box to adjust size and position of selected graphic"
	HelpTopic:	"Size_and_Position"
	Update:	"Graphic.SingleSelectionUpdate"
	Label:	"&Size and Position..."
	Click:	"Graphic.SizePos"
	Shortcut:	"Keys.None"
)

(Choice.797
	Disabled:	1
	Help:	"Aligns the selected graphics"
	HelpTopic:	"Align"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"&Align..."
	Click:	"Graphic.Align"
	Shortcut:	"Keys.Ctrl+A"
)

(Space.798
)

(Choice.799
	Disabled:	1
	Help:	"Moves selected graphics in front of other graphics"
	HelpTopic:	"Bring_to_Front_on_a_view"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"Bring to &Front"
	Click:	"Graphic.ToFront"
	Shortcut:	"Keys.None"
)

(Choice.800
	Disabled:	1
	Help:	"Moves selected graphics behind other graphics"
	HelpTopic:	"Send_to_Back_on_a_view"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"Send to &Back "
	Click:	"Graphic.ToBack"
	Shortcut:	"Keys.None"
)

(Choice.803
	Disabled:	1
	Help:	"Groups selected graphics"
	HelpTopic:	"Group_on_a_view"
	Update:	"Graphic.GroupUpdate"
	Label:	"&Group"
	Click:	"Graphic.Group"
	Shortcut:	"Keys.Ctrl+G"
)

(Choice.804
	Disabled:	1
	Help:	"Ungroups selected graphics"
	HelpTopic:	"Ungroup_on_a_view"
	Update:	"Graphic.UngroupUpdate"
	Label:	"&Ungroup"
	Click:	"Graphic.Ungroup"
	Shortcut:	"Keys.Ctrl+U"
)

(Space.805
)

(Choice.806
	Disabled:	1
	Help:	"Associates selected graphics with active themes"
	HelpTopic:	"Attach_Graphics"
	Update:	"View.AddGraphicsUpdate"
	Label:	"A&ttach Graphics"
	Click:	"View.AddGraphics"
	Shortcut:	"Keys.None"
)

(Choice.807
	Disabled:	1
	Help:	"Removes association between graphics and active themes"
	HelpTopic:	"Detach_Graphics"
	Update:	"View.ClearGraphicsUpdate"
	Label:	"&Detach Graphics"
	Click:	"View.ClearGraphics"
	Shortcut:	"Keys.None"
)

(Space.808
)

(PMenu.809
	InternalName:	"Window"
	Child:	810
	Child:	811
	Child:	812
	Child:	813
	Child:	814
	Child:	816
	Child:	818
	Child:	819
	Child:	820
	Label:	"&Window"
)

(Choice.810
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.811
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.812
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.813
)

(Choice.814
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.816
	ObjectTag:	817
	Update:	"WindowMenuUpdate"
)

(AVStr.817
	S:	"dcsewerdesign.apr DCSewerDesign.NetworkCalculator.calculate View1"
)

(Choice.818
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.819
	Help:	"Activates DCSewerDesign.NetworkCalculator.calculate"
	Label:	"&2 DCSewerDesign.NetworkCalculator.calculate"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.820
	Help:	"Activates View1"
	Label:	"&3 View1"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.821
	InternalName:	"Help"
	Child:	822
	Child:	823
	Child:	824
	Child:	825
	Label:	"&Help"
)

(Choice.822
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.823
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help..."
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.824
)

(Choice.825
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(PMenu.826
	Label:	"More Tools"
)

(ButnBar.835
	Child:	836
	Child:	838
	Child:	839
	Child:	841
	Child:	842
	Child:	844
	Child:	846
	Child:	848
	Child:	849
	Child:	851
	Child:	853
	Child:	855
	Child:	856
	Child:	858
	Child:	860
	Child:	862
	Child:	864
	Child:	866
	Child:	868
	Child:	873
	Child:	875
	Child:	877
	Child:	878
	Child:	880
	Child:	882
)

(Butn.836
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	837
	Click:	"Project.Save"
)

(AVIcon.837
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.838
)

(Butn.839
	Help:	"Add Theme//Inserts themes into the view"
	HelpTopic:	"Add_Theme"
	Icon:	840
	Click:	"View.Add"
)

(AVIcon.840
	Name:	"AddTheme"
	Res:	"Icons.AddTheme"

)

(Space.841
)

(Butn.842
	Help:	"Theme Properties//Displays the dialog box to edit properties of the active theme"
	HelpTopic:	"Theme_Properties"
	Update:	"View.ActiveThemesUpdate"
	Icon:	843
	Click:	"View.ThemeProperties"
)

(AVIcon.843
	Name:	"Props"
	Res:	"Icons.Props"

)

(Butn.844
	Help:	"Edit Legend//Displays the legends of the active themes"
	HelpTopic:	"Edit_Legend"
	Update:	"View.ActiveThemesUpdate"
	Icon:	845
	Click:	"View.EditLegendClick"
)

(AVIcon.845
	Name:	"Legend"
	Res:	"Icons.Legend"

)

(Butn.846
	Help:	"Open Theme Table//Opens the tables of the active themes"
	HelpTopic:	"Open_Theme_Table"
	Update:	"View.TabularThemesUpdate"
	Icon:	847
	Click:	"View.ShowTable"
)

(AVIcon.847
	Name:	"Table"
	Res:	"Icons.Table"

)

(Space.848
)

(Butn.849
	Help:	"Find//Finds features in the active themes using the text you enter"
	HelpTopic:	"Find"
	Update:	"View.TabularThemesUpdate"
	Icon:	850
	Click:	"View.Find"
)

(AVIcon.850
	Name:	"Find"
	Res:	"Icons.Find"

)

(Butn.851
	Disabled:	1
	Help:	"Locate Address//Locates an address in the active, matchable theme"
	HelpTopic:	"Locate_Address"
	Update:	"View.LocateUpdate"
	Icon:	852
	Click:	"View.Locate"
)

(AVIcon.852
	Name:	"AddMatch"
	Res:	"Icons.AddMatch"

)

(Butn.853
	Help:	"Query Builder//Displays the Query Builder to select features with a logical expression"
	HelpTopic:	"Query_Builder"
	Update:	"View.AttributeThemesUpdate"
	Icon:	854
	Click:	"View.Query"
)

(AVIcon.854
	Name:	"QueryBuilder"
	Res:	"Icons.QueryBuilder"

)

(Space.855
)

(Butn.856
	Help:	"Zoom to Full Extent//Zooms to the extent of all themes"
	HelpTopic:	"Zoom_to_Full_Extent"
	Update:	"View.HasDataUpdate"
	Icon:	857
	Click:	"View.ZoomFullExtent"
)

(AVIcon.857
	Name:	"ZoomView"
	Res:	"Icons.ZoomView"

)

(Butn.858
	Help:	"Zoom to Active Theme(s)//Zooms to the extent of active themes"
	HelpTopic:	"Zoom_to_Active_Theme"
	Update:	"View.ActiveThemesUpdate"
	Icon:	859
	Click:	"View.ZoomToThemes"
)

(AVIcon.859
	Name:	"ZoomTheme"
	Res:	"Icons.ZoomTheme"

)

(Butn.860
	Help:	"Zoom to Selected//Zooms to the extent of the selected features"
	HelpTopic:	"Zoom_to_Selected"
	Update:	"View.SelectableThemesUpdate"
	Icon:	861
	Click:	"View.ZoomToSelected"
)

(AVIcon.861
	Name:	"ZoomToSelected"
	Res:	"Icons.ZoomToSelected"

)

(Butn.862
	Help:	"Zoom In//Zooms in on the center of the display"
	HelpTopic:	"Zoom_In"
	Update:	"View.HasDataUpdate"
	Icon:	863
	Click:	"View.ZoomIn"
)

(AVIcon.863
	Name:	"ZoomIn"
	Res:	"Icons.ZoomIn"

)

(Butn.864
	Help:	"Zoom Out//Zooms out from the center of the display"
	HelpTopic:	"Zoom_Out"
	Update:	"View.HasDataUpdate"
	Icon:	865
	Click:	"View.ZoomOut"
)

(AVIcon.865
	Name:	"ZoomOut"
	Res:	"Icons.ZoomOut"

)

(Butn.866
	Help:	"Zoom to Previous Extent//Goes back to the previous extent you were viewing"
	HelpTopic:	"Zoom_Previous"
	Update:	"View.UndoZoomUpdate"
	Icon:	867
	Click:	"View.UndoZoom"
)

(AVIcon.867
	Name:	"ZoomPrevious"
	Res:	"Icons.ZoomPrevious"

)

(Space.868
)

(Butn.873
	Disabled:	1
	Help:	"Select Features Using Graphic//Selects features in active themes using selected graphics"
	HelpTopic:	"Select_Features_Using_Graphic"
	Update:	"View.SpatialSelectUpdate"
	Icon:	874
	Click:	"View.SpatialSelect"
)

(AVIcon.874
	Name:	"SpatialSelect"
	Res:	"Icons.SpatialSelect"

)

(Butn.875
	Help:	"Clear Selected Features//Unselects the selected features of all active themes"
	HelpTopic:	"Clear_Selected_Features"
	Update:	"View.AttributeThemesUpdate"
	Icon:	876
	Click:	"View.ClearSelect"
)

(AVIcon.876
	Name:	"SelectNone"
	Res:	"Icons.SelectNone"

)

(Space.877
)

(Butn.878
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	879
	Click:	"Help.Tool"
)

(AVIcon.879
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(Butn.880
	Help:	"Create Profile//Create a longitudinal section of the selected lines"
	Icon:	881
	Click:	"DCSewerDesign.ComplexProfile.create"
)

(AVIcon.881
	Name:	"Profile"
	Res:	"Icons.Profile"

)

(Butn.882
	Help:	"Calculate Constant Gradient//Calculate a constant gradient over the selected lines"
	Update:	"DCSewerDesign.Profile.ConstantGradient.update"
	Icon:	883
	Click:	"DCSewerDesign.Profile.ConstantGradient.calculate"
)

(AVIcon.883
	Name:	"SelectLine"
	Res:	"Icons.SelectLine"

)

(PopupSet.884
	Child:	885
)

(Popup.885
	Child:	886
	Child:	887
	Child:	888
	Child:	889
	Child:	890
	Child:	891
	Child:	892
	Child:	893
	Child:	894
	Child:	895
	Child:	896
	Child:	897
	Child:	898
	Child:	899
	Child:	900
	Child:	901
	Child:	902
	Child:	903
	Child:	904
	Child:	905
	Label:	"Menu"
)

(Choice.886
	Disabled:	1
	Invisible:	1
	Help:	"Deletes the last entered point on the line or polygon being drawn"
	Update:	"View.DelLastPointUpdate"
	Label:	"Delete Last Point"
	Click:	"View.DeleteLastPoint"
	Shortcut:	"Keys.None"
)

(Choice.887
	Disabled:	1
	Help:	"Undo the last edit to features in a theme"
	HelpTopic:	"Undo_Feature_Edit_on_a_view"
	Update:	"View.UndoEditUpdate"
	Label:	"Undo Feature Edit"
	Click:	"View.UndoEdit"
	Shortcut:	"Keys.None"
)

(Choice.888
	Disabled:	1
	Help:	"Redo the last edit operation on a theme that was undone"
	Update:	"View.RedoEditUpdate"
	Label:	"Redo Feature Edit"
	Click:	"View.RedoEdit"
	Shortcut:	"Keys.None"
)

(Space.889
)

(Choice.890
	Help:	"Turns general snapping on"
	Update:	"View.ToggleGeneralSnapUpdate"
	Label:	"Enable General Snapping"
	Click:	"View.ToggleGeneralSnap"
	Shortcut:	"Keys.None"
)

(Choice.891
	Help:	"Turns interactive snapping on"
	Update:	"View.ToggleInteractiveSnapUpdate"
	Label:	"Enable Interactive Snapping"
	Click:	"View.ToggleInteractiveSnap"
	Shortcut:	"Keys.None"
)

(Choice.892
	Help:	"Turns snap tolerance cursor off"
	Update:	"View.ToggleTolCursorUpdate"
	Label:	"Hide Snap Tolerance Cursor"
	Click:	"View.ToggleTolCursor"
	Shortcut:	"Keys.None"
)

(Space.893
)

(Choice.894
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest vertex within the user tolerance"
	Update:	"View.InteractiveSnapUpdate"
	Label:	"Snap to Vertex"
	Click:	"View.SnapToVertex"
	Shortcut:	"Keys.None"
)

(Choice.895
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest line segment"
	Update:	"View.InteractiveSnapUpdate"
	Label:	"Snap to Boundary"
	Click:	"View.SnapToBoundary"
	Shortcut:	"Keys.None"
)

(Choice.896
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest node common to two or more features"
	Update:	"View.InteractiveSnapUpdate"
	Label:	"Snap to Intersection"
	Click:	"View.SnapToIntersection"
	Shortcut:	"Keys.None"
)

(Choice.897
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest endpoint of an existing line"
	Update:	"View.SnapToEndPointUpdate"
	Label:	"Snap to Endpoint"
	Click:	"View.SnapToEndPoint"
	Shortcut:	"Keys.None"
)

(Space.898
)

(Choice.899
	Help:	"Unselects the selected features in all active themes"
	Update:	"View.AttributeThemesUpdate"
	Label:	"Clear Selection"
	Click:	"View.ClearSelect"
	Shortcut:	"Keys.None"
)

(Choice.900
	Help:	"Zooms in at point where you click to bring up popup menu"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom In"
	Click:	"View.PopupZoomIn"
	Shortcut:	"Keys.None"
)

(Choice.901
	Help:	"Zooms out from point where you click to bring up popup menu"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom Out"
	Click:	"View.PopupZoomOut"
	Shortcut:	"Keys.None"
)

(Choice.902
	Help:	"Zooms to the extent of the selected features"
	Update:	"View.SelectableThemesUpdate"
	Label:	"Zoom to Selected"
	Click:	"View.ZoomToSelected"
	Shortcut:	"Keys.None"
)

(Choice.903
	Help:	"Centers display on point where you click to bring up popup"
	Update:	"View.HasDataUpdate"
	Label:	"Pan"
	Click:	"View.PopupPan"
	Shortcut:	"Keys.None"
)

(Space.904
)

(Choice.905
	Help:	"Opens the shape properties window for editing vertex locations"
	Update:	"ShapeWin.PopUp Update"
	Label:	"Shape Properties"
	Click:	"ShapeWin.PopUp Open"
	Shortcut:	"Keys.None"
)

(ToolBar.906
	Child:	907
	Child:	909
	Child:	911
	Child:	913
	Child:	915
	Child:	917
	Child:	919
	Child:	921
	Child:	923
	Child:	925
	Child:	927
	Child:	946
	Child:	959
	Child:	978
)

(Tool.907
	Help:	"Identify//Provides information about a feature"
	HelpTopic:	"Identify_tool"
	Update:	"View.IdentifyUpdate"
	Icon:	908
	Cursor:	"Cursors.ID"
	Apply:	"View.Identify"
)

(AVIcon.908
	Name:	"ID"
	Res:	"Icons.ID"

)

(Tool.909
	Help:	"Pointer//Selects, moves, and resizes graphics"
	HelpTopic:	"Pointer_tool"
	Update:	"View.HasDataUpdate"
	Icon:	910
	Cursor:	"Cursors.Select"
	Apply:	"View.Select"
	Click:	"View.SelectTool"
)

(AVIcon.910
	Name:	"Select"
	Res:	"Icons.Select"

)

(Tool.911
	Disabled:	1
	Help:	"Vertex Edit//Adds, moves, and deletes vertices of features and graphics"
	HelpTopic:	"Vertex_Edit_tool"
	Update:	"View.SelectToEditUpdate"
	Icon:	912
	Cursor:	"Cursors.SelectEdit"
	Apply:	"View.SelectToEdit"
	Click:	"View.SelectToEditTool"
)

(AVIcon.912
	Name:	"SelectEdit"
	Res:	"Icons.SelectEdit"

)

(Tool.913
	Help:	"Select Feature//Selects features in the active themes by pointing or dragging"
	HelpTopic:	"Select_Feature_tool"
	Update:	"View.SelectableThemesUpdate"
	Icon:	914
	Cursor:	"Cursors.Default"
	Apply:	"View.SelectPoint"
)

(AVIcon.914
	Name:	"FeatureSelect"
	Res:	"Icons.FeatureSelect"

)

(Tool.915
	Help:	"Zoom In//Zooms in at a point you click or zooms in on a rectangle you drag"
	HelpTopic:	"Zoom_In_tool"
	Update:	"View.HasDataUpdate"
	Icon:	916
	Cursor:	"Cursors.ZoomIn"
	Apply:	"View.ZoomInTool"
)

(AVIcon.916
	Name:	"ZoomInTool"
	Res:	"Icons.ZoomInTool"

)

(Tool.917
	Help:	"Zoom Out//Zooms out from a point you click or zooms out to include a rectangle you drag"
	HelpTopic:	"Zoom_Out_tool"
	Update:	"View.HasDataUpdate"
	Icon:	918
	Cursor:	"Cursors.ZoomOut"
	Apply:	"View.ZoomOutTool"
)

(AVIcon.918
	Name:	"ZoomOutTool"
	Res:	"Icons.ZoomOutTool"

)

(Tool.919
	Help:	"Pan//Drags the display in the direction you move the cursor"
	HelpTopic:	"Pan_tool"
	Update:	"View.HasDataUpdate"
	Icon:	920
	Cursor:	"Cursors.Pan"
	Apply:	"View.Pan"
)

(AVIcon.920
	Name:	"Pan"
	Res:	"Icons.Pan"

)

(Tool.921
	Help:	"Measure//Measures distance"
	HelpTopic:	"Measure_tool"
	Update:	"View.HasDataUpdate"
	Icon:	922
	Cursor:	"Cursors.Measure"
	Apply:	"View.Measure"
)

(AVIcon.922
	Name:	"Measure"
	Res:	"Icons.Measure"

)

(Tool.923
	Disabled:	1
	Help:	"Hot Link//Follows a hot link in the active themes"
	HelpTopic:	"Hot_Link_tool"
	Update:	"View.HotLinkUpdate"
	Icon:	924
	Cursor:	"Cursors.Media"
	Apply:	"View.HotLink"
)

(AVIcon.924
	Name:	"Media"
	Res:	"Icons.Media"

)

(Tool.925
	Disabled:	1
	Help:	"Area of Interest//Sets the view's Area Of Interest for library-based themes"
	HelpTopic:	"Area_Of_Interest_tool"
	Update:	"View.AOIToolUpdate"
	Icon:	926
	Cursor:	"Cursors.Default"
	Apply:	"View.AOITool"
)

(AVIcon.926
	Name:	"AOI"
	Res:	"Icons.AOI"

)

(ToolMenu.927
	Help:	"Label//Labels a feature in the active theme with data from its table"
	HelpTopic:	"Label_Tool"
	Update:	"View.LabelToolUpdate"
	Icon:	928
	Cursor:	"Cursors.Tag"
	Apply:	"View.LabelTool"
	Child:	929
	Child:	930
	Child:	932
	Child:	934
	Child:	936
	Child:	938
	Child:	940
	Child:	942
	Child:	944
)

(AVIcon.928
	Name:	"Tag"
	Res:	"Icons.Tag"

)

(Tool.929
	Help:	"Label//Labels a feature in the active theme with data from its table"
	HelpTopic:	"Label_Tool"
	Update:	"View.LabelToolUpdate"
	Icon:	928
	Cursor:	"Cursors.Tag"
	Apply:	"View.LabelTool"
)

(Tool.930
	Help:	"Callout Label//Click on a feature and drag in the direction you want the label to appear"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	931
	Cursor:	"Cursors.Tag"
	Apply:	"View.CalloutLabelTool"
)

(AVIcon.931
	Name:	"CallOutLabel1"
	Res:	"Icons.CallOutLabel1"

)

(Tool.932
	Help:	"Bullet Leader Label//Click on a feature and drag in the direction you want the label to appear"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	933
	Cursor:	"Cursors.Tag"
	Apply:	"View.BulletLeaderLabelTool"
)

(AVIcon.933
	Name:	"CallOutLabel2"
	Res:	"Icons.CallOutLabel2"

)

(Tool.934
	Help:	"Banner Label//Click on a feature you want to label"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	935
	Cursor:	"Cursors.Tag"
	Apply:	"View.ShadowBoxLabelTool"
)

(AVIcon.935
	Name:	"CallOutLabel3"
	Res:	"Icons.CallOutLabel3"

)

(Tool.936
	Help:	"U.S. Interstate//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	937
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway1 Apply"
)

(AVIcon.937
	Name:	"BW US Interstate"
	Res:	"Icons.BW US Interstate"

)

(Tool.938
	Help:	"U.S. Route//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	939
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway2 Apply"
)

(AVIcon.939
	Name:	"USRoute"
	Res:	"Icons.USRoute"

)

(Tool.940
	Help:	"Generic State Hwy//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	941
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway3 Apply"
)

(AVIcon.941
	Name:	"GenericStateHighway"
	Res:	"Icons.GenericStateHighway"

)

(Tool.942
	Help:	"Generic Square Hwy//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	943
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway4 Apply"
)

(AVIcon.943
	Name:	"GenericHighway1"
	Res:	"Icons.GenericHighway1"

)

(Tool.944
	Help:	"Generic Oval Hwy//Click where you want to place a highway shield"
	Update:	"View.CalloutUpdate"
	Icon:	945
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway5 Apply"
)

(AVIcon.945
	Name:	"GenericHighway2"
	Res:	"Icons.GenericHighway2"

)

(ToolMenu.946
	Help:	"Text//Creates text on the display"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	947
	Cursor:	"Cursors.Text"
	Apply:	"View.TextTool"
	Click:	"SymWin.DisplayFontPanel"
	Child:	948
	Child:	949
	Child:	951
	Child:	953
	Child:	955
	Child:	957
)

(AVIcon.947
	Name:	"Text"
	Res:	"Icons.Text"

)

(Tool.948
	Help:	"Text//Creates text on the display"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	947
	Cursor:	"Cursors.Text"
	Apply:	"View.TextTool"
	Click:	"SymWin.DisplayFontPanel"
)

(Tool.949
	Help:	"Callout Text//Click and drag to where you want your text to appear, then enter the text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	950
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.CalloutTextTool"
)

(AVIcon.950
	Name:	"CallOutText1"
	Res:	"Icons.CallOutText1"

)

(Tool.951
	Help:	"Bullet Leader Text//Click and drag to where you want your text to appear, then enter the text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	952
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.BulletLeaderTextTool"
)

(AVIcon.952
	Name:	"CallOutText2"
	Res:	"Icons.CallOutText2"

)

(Tool.953
	Help:	"Banner Text//Click where you want your label to appear and enter your text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	954
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.ShadowBoxTextTool"
)

(AVIcon.954
	Name:	"CallOutText3"
	Res:	"Icons.CallOutText3"

)

(Tool.955
	Help:	"Drop-Shadow Text//Click where you want your text to appear and enter your text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	956
	Cursor:	"Cursors.Target"
	Apply:	"View.CreateDropShadowText"
)

(AVIcon.956
	Name:	"DropShadowText"
	Res:	"Icons.DropShadowText"

)

(Tool.957
	Help:	"Spline Text//Adds text that is aligned to a splined baseline"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	958
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.SplineText"
)

(AVIcon.958
	Name:	"TextAligned"
	Res:	"Icons.TextAligned"

)

(ToolMenu.959
	Help:	"Draw Point//Creates a point on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PointToolUpdate"
	Icon:	960
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PointTool"
	Click:	"SymWin.DisplayMarkerPanel"
	Child:	961
	Child:	962
	Child:	964
	Child:	966
	Child:	968
	Child:	970
	Child:	972
	Child:	974
	Child:	976
)

(AVIcon.960
	Name:	"Point"
	Res:	"Icons.Point"

)

(Tool.961
	Help:	"Draw Point//Creates a point on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PointToolUpdate"
	Icon:	960
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PointTool"
	Click:	"SymWin.DisplayMarkerPanel"
)

(Tool.962
	Help:	"Draw Straight Line//Creates a line on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.GraphicToolUpdate"
	Icon:	963
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.LineTool"
	Click:	"SymWin.DisplayPenPanel"
)

(AVIcon.963
	Name:	"SelectLine"
	Res:	"Icons.SelectLine"

)

(Tool.964
	Help:	"Draw Line//Creates a line with two or more points on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyLineToolUpdate"
	Icon:	965
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PolyLineTool"
	Click:	"SymWin.DisplayPenPanel"
)

(AVIcon.965
	Name:	"Lines"
	Res:	"Icons.Lines"

)

(Tool.966
	Help:	"Draw Rectangle//Creates a rectangle on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyToolUpdate"
	Icon:	967
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.RectTool"
	Click:	"SymWin.DisplayFillPanel"
)

(AVIcon.967
	Name:	"Rect"
	Res:	"Icons.Rect"

)

(Tool.968
	Help:	"Draw Circle//Creates a circle on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyToolUpdate"
	Icon:	969
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.CircleTool"
	Click:	"SymWin.DisplayFillPanel"
)

(AVIcon.969
	Name:	"Disk"
	Res:	"Icons.Disk"

)

(Tool.970
	Help:	"Draw Polygon//Creates a polygon on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyToolUpdate"
	Icon:	971
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PolyTool"
	Click:	"SymWin.DisplayFillPanel"
)

(AVIcon.971
	Name:	"Poly"
	Res:	"Icons.Poly"

)

(Tool.972
	Disabled:	1
	Help:	"Draw Line to Split Feature//Creates a line to split line features"
	HelpTopic:	"Draw_tool"
	Update:	"View.SplitLineToolUpdate"
	Icon:	973
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.SplitTool"
)

(AVIcon.973
	Name:	"SplitLine"
	Res:	"Icons.SplitLine"

)

(Tool.974
	Disabled:	1
	Help:	"Draw Line to Split Polygon//Creates a line to split polygon features"
	HelpTopic:	"Draw_tool"
	Update:	"View.SplitPolyToolUpdate"
	Icon:	975
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.SplitTool"
)

(AVIcon.975
	Name:	"SplitPoly"
	Res:	"Icons.SplitPoly"

)

(Tool.976
	Disabled:	1
	Help:	"Draw Line to Append Polygon//Appends a new polygon adjacent to other polygons"
	HelpTopic:	"Draw_tool"
	Update:	"View.AutoCompleteUpdate"
	Icon:	977
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.AutoCompleteTool"
)

(AVIcon.977
	Name:	"AutoComplete"
	Res:	"Icons.AutoComplete"

)

(ToolMenu.978
	Disabled:	1
	Invisible:	1
	Help:	"Snap//Sets the general snapping tolerance for the editable theme"
	HelpTopic:	"Snap_tools"
	Update:	"View.SnapToolUpdate"
	Icon:	979
	Cursor:	"Cursors.Default"
	Apply:	"View.SnapTool"
	Child:	980
	Child:	981
)

(AVIcon.979
	Name:	"SnapTool"
	Res:	"Icons.SnapTool"

)

(Tool.980
	Disabled:	1
	Invisible:	1
	Help:	"Snap//Sets the general snapping tolerance for the editable theme"
	HelpTopic:	"Snap_tools"
	Update:	"View.SnapToolUpdate"
	Icon:	979
	Cursor:	"Cursors.Default"
	Apply:	"View.SnapTool"
)

(Tool.981
	Disabled:	1
	Invisible:	1
	Help:	"Snap//Sets the interactive snapping tolerance for the editable theme"
	HelpTopic:	"Snap_tools"
	Update:	"View.InteractiveSnapToolUpdate"
	Icon:	982
	Cursor:	"Cursors.Default"
	Apply:	"View.InteractiveSnapTool"
)

(AVIcon.982
	Name:	"SnapFeatureTool"
	Res:	"Icons.SnapFeatureTool"

)

(AVIcon.983
	Name:	"Icon"
	Res:	"View.Icon"

)

(DocGUI.984
	Name:	"Table"
	Type:	"Table"
	Modified:	1
	Visible:	1
	MenuBar:	985
	ButnBar:	1072
	Popups:	1121
	ToolBar:	1122
	NewScript:	"Table.New"
	OpenScript:	"Doc.Open"
	ActionScript:	"Table.Action"
	NewUpdateScript:	"Doc.NewUpdate"
	OpenUpdateScript:	"Doc.OpenUpdate"
	ActionUpdateScript:	"Table.ActionUpdate"
	Title:	"Tables"
	Icon:	1129
)

(MenuBar.985
	Child:	986
	Child:	1001
	Child:	1020
	Child:	1042
	Child:	1052
	Child:	1064
	Child:	1069
)

(PMenu.986
	InternalName:	"File"
	Child:	987
	Child:	988
	Child:	989
	Child:	990
	Child:	991
	Child:	993
	Child:	994
	Child:	995
	Child:	996
	Child:	997
	Child:	998
	Child:	999
	Child:	1000
	Label:	"&File"
)

(Choice.987
	Help:	"Closes the active component"
	HelpTopic:	"Close"
	Label:	"&Close"
	Click:	"Project.CloseDoc"
	Shortcut:	"Keys.None"
)

(Choice.988
	Help:	"Closes all components"
	HelpTopic:	"Close_All"
	Label:	"Close &All"
	Click:	"Project.CloseAll"
	Shortcut:	"Keys.None"
)

(Space.989
)

(Choice.990
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.991
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.993
)

(Choice.994
	Help:	"Displays the Extensions Dialog"
	HelpTopic:	"Extensions"
	Label:	"Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.995
)

(Choice.996
	Help:	"Prints the table"
	HelpTopic:	"Print"
	Label:	"&Print..."
	Click:	"Doc.Print"
	Shortcut:	"Keys.None"
)

(Choice.997
	Help:	"Edits the printer and the printing options"
	HelpTopic:	"Print_Setup"
	Update:	"PrintSetupUpdate"
	Label:	"P&rint Setup..."
	Click:	"Project.PrintSetup"
	Shortcut:	"Keys.None"
)

(Choice.998
	Help:	"Exports the current table to a dBASE, INFO, or text file"
	HelpTopic:	"Export_Table"
	Update:	"Table.ExportUpdate"
	Label:	"&Export..."
	Click:	"Table.Export"
	Shortcut:	"Keys.None"
)

(Space.999
)

(Choice.1000
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.1001
	InternalName:	"Edit"
	Child:	1002
	Child:	1003
	Child:	1004
	Child:	1005
	Child:	1006
	Child:	1007
	Child:	1008
	Child:	1009
	Child:	1010
	Child:	1011
	Child:	1012
	Child:	1013
	Child:	1014
	Child:	1015
	Child:	1016
	Label:	"&Edit"
)

(Choice.1002
	Disabled:	1
	Help:	"Cuts the selected cell to the clipboard"
	HelpTopic:	"Cut"
	Update:	"Table.CutUpdate"
	Label:	"Cu&t"
	Click:	"Table.Cut"
	Shortcut:	"Keys.Ctrl+X"
)

(Choice.1003
	Disabled:	1
	Help:	"Copies the selected cell to the clipboard"
	HelpTopic:	"Copy"
	Update:	"Table.CutUpdate"
	Label:	"&Copy"
	Click:	"Table.Copy"
	Shortcut:	"Keys.Ctrl+C"
)

(Choice.1004
	Disabled:	1
	Help:	"Inserts the contents of the Clipboard into the active cell"
	HelpTopic:	"Paste"
	Update:	"Table.CutUpdate"
	Label:	"&Paste"
	Click:	"Table.Paste"
	Shortcut:	"Keys.Ctrl+V"
)

(Space.1005
)

(Choice.1006
	Disabled:	1
	Help:	"Undo the last edit operation on the Table"
	HelpTopic:	"Undo_Edit_on_a_table"
	Update:	"Table.UndoEditUpdate"
	Label:	"&Undo Edit"
	Click:	"Table.UndoEdit"
	Shortcut:	"Keys.Ctrl+Z"
)

(Choice.1007
	Disabled:	1
	Help:	"Redo the last undone operation on the Table"
	HelpTopic:	"Redo_Edit_on_a_table"
	Update:	"Table.RedoEditUpdate"
	Label:	"Red&o Edit"
	Click:	"Table.RedoEdit"
	Shortcut:	"Keys.Ctrl+Y"
)

(Space.1008
)

(Choice.1009
	Disabled:	1
	Help:	"Adds a new field to the table"
	HelpTopic:	"Add_Field"
	Update:	"Table.AddFieldUpdate"
	Label:	"Add &Field..."
	Click:	"Table.AddField"
	Shortcut:	"Keys.None"
)

(Choice.1010
	Disabled:	1
	Help:	"Adds a new record at the bottom of the table"
	HelpTopic:	"Add_Record"
	Update:	"Table.AddRecordUpdate"
	Label:	"Add &Record"
	Click:	"Table.AddRecord"
	Shortcut:	"Keys.Ctrl+A"
)

(Choice.1011
	Disabled:	1
	Help:	"Deletes the active field from the table"
	HelpTopic:	"Delete_Field"
	Update:	"Table.DeleteFieldUpdate"
	Label:	"&Delete Field"
	Click:	"Table.DeleteField"
	Shortcut:	"Keys.None"
)

(Choice.1012
	Disabled:	1
	Help:	"Deletes the selected records from the table"
	HelpTopic:	"Delete_Records"
	Update:	"Table.DeleteRecordsUpdate"
	Label:	"D&elete Records"
	Click:	"Table.DeleteRecords"
	Shortcut:	"Keys.None"
)

(Space.1013
)

(Choice.1014
	Help:	"Selects all records in the table"
	HelpTopic:	"Select_All"
	Label:	"Select &All"
	Click:	"Table.SelectAll"
	Shortcut:	"Keys.None"
)

(Choice.1015
	Help:	"Unselects all records in the table"
	HelpTopic:	"Select_None_in_a_table"
	Label:	"Select &None"
	Click:	"Table.UnselectAll"
	Shortcut:	"Keys.None"
)

(Choice.1016
	Help:	"Toggles selected and unselected records in the table"
	HelpTopic:	"Switch_Selection"
	Label:	"&Switch Selection"
	Click:	"Table.SwitchSelection"
	Shortcut:	"Keys.None"
)

(PMenu.1020
	InternalName:	"Table"
	Child:	1021
	Child:	1022
	Child:	1023
	Child:	1024
	Child:	1025
	Child:	1026
	Child:	1027
	Child:	1028
	Child:	1029
	Child:	1030
	Child:	1031
	Child:	1032
	Child:	1033
	Child:	1034
	Child:	1035
	Child:	1036
	Child:	1037
	Label:	"&Table"
)

(Choice.1021
	Help:	"Displays the dialog box to edit properties of the table"
	HelpTopic:	"Table_Properties"
	Label:	"&Properties..."
	Click:	"Table.Properties"
	Shortcut:	"Keys.None"
)

(Space.1022
)

(Choice.1023
	Help:	"Creates a chart from the table"
	HelpTopic:	"Create_Chart"
	Update:	"Table.ChartUpdate"
	Label:	"&Chart..."
	Click:	"Table.Chart"
	Shortcut:	"Keys.None"
)

(Choice.1024
	Help:	"Starts or stops editing of table values"
	HelpTopic:	"Start_Stop_Editing"
	Update:	"Table.ToggleEditingUpdate"
	Label:	"Start &Editing"
	Click:	"Table.ToggleEditing"
	Shortcut:	"Keys.None"
)

(Choice.1025
	Disabled:	1
	Help:	"Saves edits to the source file"
	HelpTopic:	"Save_edits_table"
	Update:	"Table.SaveEditsUpdate"
	Label:	"Save Ed&its"
	Click:	"Table.SaveEdits"
	Shortcut:	"Keys.None"
)

(Choice.1026
	Disabled:	1
	Help:	"Save edits to a new source file"
	HelpTopic:	"Save_edits_as_table"
	Update:	"Table.SaveEditsUpdate"
	Label:	"Save E&dits As..."
	Click:	"Table.SaveEditsAs"
	Shortcut:	"Keys.None"
)

(Space.1027
)

(Choice.1028
	Help:	"Finds the row in the table using the text you enter"
	HelpTopic:	"Find"
	Label:	"&Find..."
	Click:	"Table.Find"
	Shortcut:	"Keys.Ctrl+F"
)

(Choice.1029
	Help:	"Displays the Query Builder to select records with a logical expression"
	HelpTopic:	"Query_Builder"
	Label:	"&Query..."
	Click:	"Table.Query"
	Shortcut:	"Keys.Ctrl+Q"
)

(Choice.1030
	Disabled:	1
	Help:	"Promotes selected rows to the top of the table"
	HelpTopic:	"Promote"
	Update:	"Table.PromoteUpdate"
	Label:	"Pr&omote"
	Click:	"Table.Promote"
	Shortcut:	"Keys.None"
)

(Space.1031
)

(Choice.1032
	Disabled:	1
	Help:	"Appends the fields of another table to the active table based on a common field"
	HelpTopic:	"Join"
	Update:	"Table.JoinUpdate"
	Label:	"&Join"
	Click:	"Table.Join"
	Shortcut:	"Keys.Ctrl+J"
)

(Choice.1033
	Disabled:	1
	Help:	"Removes any fields joined to the table"
	HelpTopic:	"Remove_All_Joins"
	Update:	"Table.HasJoinsUpdate"
	Label:	"&Remove All Joins"
	Click:	"Table.RemoveAllJoins"
	Shortcut:	"Keys.None"
)

(Choice.1034
	Disabled:	1
	Help:	"Associates the selection of the active table with another table"
	HelpTopic:	"Link"
	Update:	"Table.LinkUpdate"
	Label:	"&Link"
	Click:	"Table.Link"
	Shortcut:	"Keys.None"
)

(Choice.1035
	Disabled:	1
	Help:	"Removes the association between the active table and its linked tables"
	HelpTopic:	"Remove_All_Links"
	Update:	"Table.HasLinksUpdate"
	Label:	"Re&move All Links"
	Click:	"Table.RemoveAllLinks"
	Shortcut:	"Keys.None"
)

(Space.1036
)

(Choice.1037
	Help:	"Refreshes the table"
	HelpTopic:	"Refresh"
	Label:	"Refres&h"
	Click:	"Table.Refresh"
	Shortcut:	"Keys.None"
)

(PMenu.1042
	InternalName:	"Field"
	Child:	1043
	Child:	1044
	Child:	1045
	Child:	1046
	Child:	1047
	Child:	1048
	Child:	1049
	Child:	1050
	Label:	"F&ield"
)

(Choice.1043
	Help:	"Sorts rows in ascending order (A-Z), (0-9)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Label:	"Sort &Ascending"
	Click:	"Table.SortAscending"
	Shortcut:	"Keys.None"
)

(Choice.1044
	Help:	"Sorts rows in descending order (Z-A), (9-0)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Label:	"Sort &Descending"
	Click:	"Table.SortDescending"
	Shortcut:	"Keys.None"
)

(Space.1045
)

(Choice.1046
	Help:	"Creates or removes an index on the active field"
	HelpTopic:	"Create_Remove_Index"
	Update:	"Table.IndexUpdate"
	Label:	"Create &Index"
	Click:	"Table.Index"
	Shortcut:	"Keys.None"
)

(Space.1047
)

(Choice.1048
	Help:	"Creates a summary table grouped by the active field"
	HelpTopic:	"Summarize"
	Update:	"Table.SortUpdate"
	Label:	"&Summarize..."
	Click:	"Table.Summarize"
	Shortcut:	"Keys.None"
)

(Choice.1049
	Disabled:	1
	Help:	"Calculates the value of a field"
	HelpTopic:	"Calculate"
	Update:	"Table.CalculateUpdate"
	Label:	"&Calculate..."
	Click:	"Table.Calculate"
	Shortcut:	"Keys.None"
)

(Choice.1050
	Help:	"Generates a report of statistics for data in the active, numeric field"
	HelpTopic:	"Statistics"
	Update:	"Table.StatisticsUpdate"
	Label:	"S&tatistics..."
	Click:	"Table.Statistics"
	Shortcut:	"Keys.None"
)

(PMenu.1052
	InternalName:	"Window"
	Child:	1053
	Child:	1054
	Child:	1055
	Child:	1056
	Child:	1057
	Child:	1058
	Child:	1060
	Child:	1061
	Child:	1062
	Child:	1063
	Label:	"&Window"
)

(Choice.1053
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.1054
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.1055
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.1056
)

(Choice.1057
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.1058
	ObjectTag:	1059
	Update:	"WindowMenuUpdate"
)

(AVStr.1059
	S:	"dcsewerdesign.apr Attributes of Line.shp DCSewerDesign.NetworkCalculator.calculate View1"
)

(Choice.1060
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1061
	Help:	"Activates Attributes of Line.shp"
	Label:	"&2 Attributes of Line.shp"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1062
	Help:	"Activates DCSewerDesign.NetworkCalculator.calculate"
	Label:	"&3 DCSewerDesign.NetworkCalculator.calculate"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1063
	Help:	"Activates View1"
	Label:	"&4 View1"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.1064
	InternalName:	"Help"
	Child:	1065
	Child:	1066
	Child:	1067
	Child:	1068
	Label:	"&Help"
)

(Choice.1065
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.1066
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help..."
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.1067
)

(Choice.1068
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(PMenu.1069
	Help:	"DC Sewer Design Extension Menu"
	Child:	1070
	Child:	1071
	Label:	"&DC Sewer"
)

(Choice.1070
	Disabled:	1
	Help:	"Calculate table column values using upstream and downstream lines"
	Update:	"DCSewerDesign.NetworkCalculator.update"
	Label:	"Network &Calculator"
	Click:	"DCSewerDesign.NetworkCalculator.calculate"
	Shortcut:	"Keys.None"
)

(Choice.1071
	Help:	"DC Sewer Design Extension Help//DC Sewer Design Extension Help"
	Label:	"Help"
	Click:	"DCSewerDesign.Help.openCHM"
	Shortcut:	"Keys.None"
)

(ButnBar.1072
	Child:	1073
	Child:	1075
	Child:	1076
	Child:	1078
	Child:	1080
	Child:	1082
	Child:	1083
	Child:	1085
	Child:	1087
	Child:	1089
	Child:	1090
	Child:	1092
	Child:	1093
	Child:	1095
	Child:	1097
	Child:	1099
	Child:	1100
	Child:	1102
	Child:	1105
	Child:	1107
	Child:	1109
	Child:	1110
	Child:	1112
	Child:	1114
	Child:	1119
)

(Butn.1073
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	1074
	Click:	"Project.Save"
)

(AVIcon.1074
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.1075
)

(Butn.1076
	Disabled:	1
	Help:	"Cut//Cuts the selected cell to the clipboard"
	HelpTopic:	"Cut"
	Update:	"Table.CutUpdate"
	Icon:	1077
	Click:	"Table.Cut"
)

(AVIcon.1077
	Name:	"Cut"
	Res:	"Icons.Cut"

)

(Butn.1078
	Disabled:	1
	Help:	"Copy//Copies the selected cell to the clipboard"
	HelpTopic:	"Copy"
	Update:	"Table.CutUpdate"
	Icon:	1079
	Click:	"Table.Copy"
)

(AVIcon.1079
	Name:	"Copy"
	Res:	"Icons.Copy"

)

(Butn.1080
	Disabled:	1
	Help:	"Paste//Inserts the contents of the Clipboard into the active cell"
	HelpTopic:	"Paste"
	Update:	"Table.CutUpdate"
	Icon:	1081
	Click:	"Table.Paste"
)

(AVIcon.1081
	Name:	"Paste"
	Res:	"Icons.Paste"

)

(Space.1082
)

(Butn.1083
	Help:	"Select All//Selects all records in the table"
	HelpTopic:	"Select_All"
	Icon:	1084
	Click:	"Table.SelectAll"
)

(AVIcon.1084
	Name:	"SelectAll"
	Res:	"Icons.SelectAll"

)

(Butn.1085
	Help:	"Select None//Unselects all records in the table"
	HelpTopic:	"Select_None_in_a_table"
	Icon:	1086
	Click:	"Table.UnselectAll"
)

(AVIcon.1086
	Name:	"SelectNone"
	Res:	"Icons.SelectNone"

)

(Butn.1087
	Help:	"Switch Selection//Toggles selected and unselected records in the table"
	HelpTopic:	"Switch_Selection"
	Icon:	1088
	Click:	"Table.SwitchSelection"
)

(AVIcon.1088
	Name:	"SwitchSelect"
	Res:	"Icons.SwitchSelect"

)

(Space.1089
)

(Butn.1090
	Help:	"Create Chart//Creates a chart from the table"
	HelpTopic:	"Create_Chart"
	Update:	"Table.ChartUpdate"
	Icon:	1091
	Click:	"Table.Chart"
)

(AVIcon.1091
	Name:	"MakeChart"
	Res:	"Icons.MakeChart"

)

(Space.1092
)

(Butn.1093
	Help:	"Find//Finds the row in the table using the text you enter"
	HelpTopic:	"Find"
	Icon:	1094
	Click:	"Table.Find"
)

(AVIcon.1094
	Name:	"Find"
	Res:	"Icons.Find"

)

(Butn.1095
	Help:	"Query Builder//Displays the Query Builder to select records with a logical expression"
	HelpTopic:	"Query_Builder"
	Icon:	1096
	Click:	"Table.Query"
)

(AVIcon.1096
	Name:	"QueryBuilder"
	Res:	"Icons.QueryBuilder"

)

(Butn.1097
	Disabled:	1
	Help:	"Promote//Promotes selected rows to the top of the table"
	HelpTopic:	"Promote"
	Update:	"Table.PromoteUpdate"
	Icon:	1098
	Click:	"Table.Promote"
)

(AVIcon.1098
	Name:	"Promote"
	Res:	"Icons.Promote"

)

(Space.1099
)

(Butn.1100
	Disabled:	1
	Help:	"Join//Appends the fields of another table to the active table based on a common field"
	HelpTopic:	"Join"
	Update:	"Table.JoinUpdate"
	Icon:	1101
	Click:	"Table.Join"
)

(AVIcon.1101
	Name:	"Join"
	Res:	"Icons.Join"

)

(Space.1102
)

(Butn.1105
	Help:	"Summarize//Creates a summary table grouped by the active field"
	HelpTopic:	"Summarize"
	Update:	"Table.SortUpdate"
	Icon:	1106
	Click:	"Table.Summarize"
)

(AVIcon.1106
	Name:	"Summarize"
	Res:	"Icons.Summarize"

)

(Butn.1107
	Disabled:	1
	Help:	"Calculate//Calculates the value of a field"
	HelpTopic:	"Calculate"
	Update:	"Table.CalculateUpdate"
	Icon:	1108
	Click:	"Table.Calculate"
)

(AVIcon.1108
	Name:	"Calculator"
	Res:	"Icons.Calculator"

)

(Space.1109
)

(Butn.1110
	Help:	"Sort Ascending//Sorts rows in ascending order (A-Z), (0-9)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Icon:	1111
	Click:	"Table.SortAscending"
)

(AVIcon.1111
	Name:	"SortAscending"
	Res:	"Icons.SortAscending"

)

(Butn.1112
	Help:	"Sort Descending//Sorts rows in descending order (Z-A), (9-0)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Icon:	1113
	Click:	"Table.SortDescending"
)

(AVIcon.1113
	Name:	"SortDescending"
	Res:	"Icons.SortDescending"

)

(Space.1114
)

(Butn.1119
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	1120
	Click:	"Help.Tool"
)

(AVIcon.1120
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(PopupSet.1121
)

(ToolBar.1122
	Child:	1123
	Child:	1125
	Child:	1127
)

(Tool.1123
	Help:	"Select//Selects records in the table"
	HelpTopic:	"Select_tool"
	Icon:	1124
	Cursor:	"Cursors.Default"
	Apply:	"Table.Select"
	Click:	"Table.StopEditing"
)

(AVIcon.1124
	Name:	"Select"
	Res:	"Icons.Select"

)

(Tool.1125
	Disabled:	1
	Help:	"Edit//Changes cell values"
	HelpTopic:	"Edit_tool"
	Update:	"Table.IsEditableUpdate"
	Icon:	1126
	Cursor:	"Cursors.Finger"
	Apply:	"Table.Edit"
)

(AVIcon.1126
	Name:	"Edit"
	Res:	"Icons.Edit"

)

(Tool.1127
	Help:	"Identify//Provides information about a record"
	HelpTopic:	"Identify_tool"
	Icon:	1128
	Cursor:	"Cursors.ID"
	Apply:	"Table.Identify"
	Click:	"Table.StopEditing"
)

(AVIcon.1128
	Name:	"ID"
	Res:	"Icons.ID"

)

(AVIcon.1129
	Name:	"Icon"
	Res:	"Table.Icon"

)

(DocGUI.1403
	Name:	"Script"
	Type:	"SEd"
	Modified:	1
	Visible:	1
	MenuBar:	1404
	ButnBar:	1509
	Popups:	1575
	ToolBar:	1576
	NewScript:	"Script.New"
	OpenScript:	"Doc.Open"
	ActionScript:	"Script.Action"
	NewUpdateScript:	"Doc.NewUpdate"
	OpenUpdateScript:	"Doc.OpenUpdate"
	ActionUpdateScript:	"Script.ActionUpdate"
	Title:	"Scripts"
	Icon:	1577
)

(MenuBar.1404
	Child:	1405
	Child:	1419
	Child:	1439
	Child:	1456
	Child:	1466
	Child:	1472
)

(PMenu.1405
	InternalName:	"File"
	Child:	1406
	Child:	1407
	Child:	1408
	Child:	1409
	Child:	1410
	Child:	1412
	Child:	1413
	Child:	1414
	Child:	1415
	Child:	1416
	Child:	1417
	Child:	1418
	Label:	"&File"
)

(Choice.1406
	Help:	"Closes the active component"
	HelpTopic:	"Close"
	Label:	"&Close"
	Click:	"Project.CloseDoc"
	Shortcut:	"Keys.None"
)

(Choice.1407
	Help:	"Closes all components"
	HelpTopic:	"Close_All"
	Label:	"Close &All"
	Click:	"Project.CloseAll"
	Shortcut:	"Keys.None"
)

(Space.1408
)

(Choice.1409
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.1410
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.1412
)

(Choice.1413
	Help:	"Displays the Extensions Dialog"
	HelpTopic:	"Extensions"
	Label:	"Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.1414
)

(Choice.1415
	Help:	"Prints the script"
	HelpTopic:	"Print"
	Label:	"&Print..."
	Click:	"Doc.Print"
	Shortcut:	"Keys.None"
)

(Choice.1416
	Help:	"Edits the printer and the printing options"
	HelpTopic:	"Print_Setup"
	Update:	"PrintSetupUpdate"
	Label:	"P&rint Setup..."
	Click:	"Project.PrintSetup"
	Shortcut:	"Keys.None"
)

(Space.1417
)

(Choice.1418
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.1419
	InternalName:	"Edit"
	Child:	1420
	Child:	1421
	Child:	1422
	Child:	1423
	Child:	1424
	Child:	1425
	Child:	1426
	Child:	1427
	Child:	1428
	Child:	1429
	Child:	1430
	Child:	1431
	Child:	1432
	Child:	1433
	Child:	1434
	Label:	"&Edit"
)

(Choice.1420
	Help:	"Undoes the last change"
	HelpTopic:	"Undo__Script_"
	Label:	"&Undo"
	Click:	"Script.Undo"
	Shortcut:	"Keys.Ctrl+Z"
)

(Space.1421
)

(Choice.1422
	Help:	"Finds the selected or specified string"
	HelpTopic:	"Script_Find"
	Label:	"&Find..."
	Click:	"Script.Find"
	Shortcut:	"Keys.Ctrl+F"
)

(Choice.1423
	Disabled:	1
	Help:	"Finds the next occurrence of the string"
	HelpTopic:	"Script_FindNext"
	Update:	"Script.FindNextUpdate"
	Label:	"Find &Next"
	Click:	"Script.FindNext"
	Shortcut:	"Keys.F3"
)

(Choice.1424
	Help:	"Replaces the selected or specifed string"
	HelpTopic:	"Script_Replace"
	Label:	"Rep&lace..."
	Click:	"Script.Replace"
	Shortcut:	"Keys.None"
)

(Space.1425
)

(Choice.1426
	Disabled:	1
	Help:	"Cuts the selection and puts it into the clipboard"
	HelpTopic:	"Cut"
	Update:	"Script.HasSelUpdate"
	Label:	"Cu&t"
	Click:	"Script.Cut"
	Shortcut:	"Keys.Ctrl+X"
)

(Choice.1427
	Disabled:	1
	Help:	"Copies the selection and puts it into the clipboard"
	HelpTopic:	"Copy"
	Update:	"Script.HasSelUpdate"
	Label:	"&Copy"
	Click:	"Script.Copy"
	Shortcut:	"Keys.Ctrl+C"
)

(Choice.1428
	Help:	"Inserts the contents of the clipboard"
	HelpTopic:	"Paste"
	Label:	"&Paste"
	Click:	"Script.Paste"
	Shortcut:	"Keys.Ctrl+V"
)

(Space.1429
)

(Choice.1430
	Help:	"Selects all text in the script editor"
	HelpTopic:	"Select_All_in_a_script"
	Label:	"Select &All"
	Click:	"Script.SelectAll"
	Shortcut:	"Keys.Ctrl+A"
)

(Choice.1431
	Help:	"Deletes text from the cursor to the left margin"
	HelpTopic:	"Delete_Left"
	Label:	"&Delete Left"
	Click:	"Script.KillLine"
	Shortcut:	"Keys.Ctrl+U"
)

(Space.1432
)

(Choice.1433
	Help:	"Comments selected text"
	HelpTopic:	"Comment"
	Update:	"Script.HasSelUpdate"
	Label:	"C&omment"
	Click:	"Script.Comment"
	Shortcut:	"Keys.Ctrl+Q"
)

(Choice.1434
	Help:	"Uncomments selected text"
	HelpTopic:	"Remove_Comment"
	Update:	"Script.HasSelUpdate"
	Label:	"&Remove Comment"
	Click:	"Script.Uncomment"
	Shortcut:	"Keys.Ctrl+W"
)

(PMenu.1439
	InternalName:	"Script"
	Child:	1440
	Child:	1441
	Child:	1442
	Child:	1443
	Child:	1444
	Child:	1445
	Child:	1446
	Child:	1447
	Child:	1448
	Child:	1449
	Child:	1450
	Child:	1451
	Child:	1452
	Child:	1453
	Child:	1454
	Child:	1455
	Label:	"&Script"
)

(Choice.1440
	Help:	"Displays the dialog box to edit properties of the script"
	HelpTopic:	"Script_Properties"
	Label:	"&Properties..."
	Click:	"Script.Properties"
	Shortcut:	"Keys.None"
)

(Space.1441
)

(Choice.1442
	Disabled:	1
	Help:	"Compiles the script"
	HelpTopic:	"Compile"
	Update:	"Script.CompileUpdate"
	Label:	"&Compile"
	Click:	"Script.Compile"
	Shortcut:	"Keys.None"
)

(Choice.1443
	Help:	"Executes one request or object reference in the compiled script"
	HelpTopic:	"Step"
	Update:	"Script.RunUpdate"
	Label:	"&Step"
	Click:	"Script.Step"
	Shortcut:	"Keys.F8"
)

(Choice.1444
	Help:	"Runs the compiled script"
	HelpTopic:	"Run"
	Update:	"Script.RunUpdate"
	Label:	"&Run"
	Click:	"Script.Run"
	Shortcut:	"Keys.F5"
)

(Space.1445
)

(Choice.1446
	Help:	"Toggles a breakpoint on or off at the current cursor position"
	HelpTopic:	"Toggle_Breakpoint"
	Update:	"Script.RunUpdate"
	Label:	"Toggle &Breakpoint"
	Click:	"Script.ToggleBreak"
	Shortcut:	"Keys.None"
)

(Choice.1447
	Help:	"Clears all breakpoints"
	HelpTopic:	"Clear_All_Breakpoints"
	Update:	"Script.RunUpdate"
	Label:	"Clear &All Breakpoints"
	Click:	"Script.ClearAllBreaks"
	Shortcut:	"Keys.None"
)

(Choice.1448
	Help:	"Displays the current value of local and global variables"
	HelpTopic:	"Examine_Variables"
	Update:	"Script.RunUpdate"
	Label:	"E&xamine Variables..."
	Click:	"Script.ShowVariables"
	Shortcut:	"Keys.Ctrl+E"
)

(Space.1449
)

(Choice.1450
	Help:	"Inserts the source code of a system script"
	HelpTopic:	"Load_System_Script"
	Label:	"&Load System Script..."
	Click:	"Script.SystemLoad"
	Shortcut:	"Keys.None"
)

(Choice.1451
	Help:	"Inserts the contents of a text file"
	HelpTopic:	"Load_Text_File"
	Label:	"Load &Text File..."
	Click:	"Script.FileLoad"
	Shortcut:	"Keys.None"
)

(Choice.1452
	Help:	"Writes the entire script or the selected text to a text file"
	HelpTopic:	"Write_Text_File"
	Label:	"&Write Text File..."
	Click:	"Script.FileWrite"
	Shortcut:	"Keys.None"
)

(Space.1453
)

(Choice.1454
	Help:	"Embeds the script in the project and deletes its window"
	HelpTopic:	"Embed_Script"
	Update:	"Script.RunUpdate"
	Label:	"&Embed Script"
	Click:	"Script.Embed"
	Shortcut:	"Keys.None"
)

(Choice.1455
	Disabled:	1
	Help:	"Removes specified script from embedded scripts and puts it in a SEd"
	HelpTopic:	"Script_Unembed"
	Update:	"Script.UnembedUpdate"
	Label:	"&Unembed Script..."
	Click:	"Script.Unembed"
	Shortcut:	"Keys.None"
)

(PMenu.1456
	InternalName:	"Window"
	Child:	1457
	Child:	1458
	Child:	1459
	Child:	1460
	Child:	1461
	Child:	1462
	Child:	1464
	Child:	1465
	Label:	"&Window"
)

(Choice.1457
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.1458
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.1459
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.1460
)

(Choice.1461
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.1462
	ObjectTag:	1463
	Update:	"WindowMenuUpdate"
)

(AVStr.1463
	S:	"dcsewerdesign.apr DCSewerDesignExtension.make"
)

(Choice.1464
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1465
	Help:	"Activates DCSewerDesignExtension.make"
	Label:	"&2 DCSewerDesignExtension.make"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.1466
	InternalName:	"Help"
	Child:	1467
	Child:	1468
	Child:	1469
	Child:	1471
	Label:	"&Help"
)

(Choice.1467
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.1468
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help"
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.1469
)

(Choice.1471
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(PMenu.1472
	Label:	"Script &Tools"
)

(ButnBar.1509
	Child:	1510
	Child:	1512
	Child:	1513
	Child:	1515
	Child:	1517
	Child:	1519
	Child:	1520
	Child:	1522
	Child:	1523
	Child:	1525
	Child:	1527
	Child:	1528
	Child:	1530
	Child:	1532
	Child:	1534
	Child:	1536
	Child:	1538
	Child:	1539
	Child:	1541
	Child:	1543
	Child:	1545
	Child:	1546
	Child:	1548
	Child:	1550
	Child:	1551
)

(Butn.1510
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	1511
	Click:	"Project.Save"
)

(AVIcon.1511
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.1512
)

(Butn.1513
	Disabled:	1
	Help:	"Cut//Cuts the selection and puts it into the clipboard"
	HelpTopic:	"Cut"
	Update:	"Script.HasSelUpdate"
	Icon:	1514
	Click:	"Script.Cut"
)

(AVIcon.1514
	Name:	"Cut"
	Res:	"Icons.Cut"

)

(Butn.1515
	Disabled:	1
	Help:	"Copy//Copies the selection and puts it into the clipboard"
	HelpTopic:	"Copy"
	Update:	"Script.HasSelUpdate"
	Icon:	1516
	Click:	"Script.Copy"
)

(AVIcon.1516
	Name:	"Copy"
	Res:	"Icons.Copy"

)

(Butn.1517
	Help:	"Paste//Inserts the contents of the clipboard"
	HelpTopic:	"Paste"
	Icon:	1518
	Click:	"Script.Paste"
)

(AVIcon.1518
	Name:	"Paste"
	Res:	"Icons.Paste"

)

(Space.1519
)

(Butn.1520
	Help:	"Undo//Undoes the last modification to the script editor text"
	HelpTopic:	"Undo__Script_"
	Icon:	1521
	Click:	"Script.Undo"
)

(AVIcon.1521
	Name:	"Undo"
	Res:	"Icons.Undo"

)

(Space.1522
)

(Butn.1523
	Help:	"Shift Lines Left//Shifts selected lines or current line two spaces to the left"
	HelpTopic:	"Shift_lines_left_or_right"
	Icon:	1524
	Click:	"Script.ShiftLeft"
)

(AVIcon.1524
	Name:	"ShiftLeft"
	Res:	"Icons.ShiftLeft"

)

(Butn.1525
	Help:	"Shift Lines Right//Shifts selected lines or current line two spaces to the right"
	HelpTopic:	"Shift_lines_left_or_right"
	Icon:	1526
	Click:	"Script.ShiftRight"
)

(AVIcon.1526
	Name:	"ShiftRight"
	Res:	"Icons.ShiftRight"

)

(Space.1527
)

(Butn.1528
	Disabled:	1
	Help:	"Compile//Compiles the script"
	HelpTopic:	"Compile"
	Update:	"Script.CompileUpdate"
	Icon:	1529
	Click:	"Script.Compile"
)

(AVIcon.1529
	Name:	"Check"
	Res:	"Icons.Check"

)

(Butn.1530
	Help:	"Run//Runs the compiled script"
	HelpTopic:	"Run"
	Update:	"Script.RunUpdate"
	Icon:	1531
	Click:	"Script.Run"
)

(AVIcon.1531
	Name:	"Run"
	Res:	"Icons.Run"

)

(Butn.1532
	Help:	"Step//Executes one request or object reference in the compiled script"
	HelpTopic:	"Step"
	Update:	"Script.RunUpdate"
	Icon:	1533
	Click:	"Script.Step"
)

(AVIcon.1533
	Name:	"Footprints"
	Res:	"Icons.Footprints"

)

(Butn.1534
	Help:	"Toggle Breakpoint//Toggles a breakpoint on or off at the current cursor position"
	HelpTopic:	"Toggle_Breakpoint"
	Update:	"Script.RunUpdate"
	Icon:	1535
	Click:	"Script.ToggleBreak"
)

(AVIcon.1535
	Name:	"Hand"
	Res:	"Icons.Hand"

)

(Butn.1536
	Help:	"Examine Variables//Displays the current value of local and global variables"
	HelpTopic:	"Examine_Variables"
	Update:	"Script.RunUpdate"
	Icon:	1537
	Click:	"Script.ShowVariables"
)

(AVIcon.1537
	Name:	"Examine"
	Res:	"Icons.Examine"

)

(Space.1538
)

(Butn.1539
	Help:	"Load System Script//Inserts the source code of a system script"
	HelpTopic:	"Load_System_Script"
	Icon:	1540
	Click:	"Script.SystemLoad"
)

(AVIcon.1540
	Name:	"LoadScript"
	Res:	"Icons.LoadScript"

)

(Butn.1541
	Help:	"Load Text File//Inserts the contents of a text file"
	HelpTopic:	"Load_Text_File"
	Icon:	1542
	Click:	"Script.FileLoad"
)

(AVIcon.1542
	Name:	"Open"
	Res:	"Icons.Open"

)

(Butn.1543
	Help:	"Write Text File//Writes the entire script or the selected text to a text file"
	HelpTopic:	"Write_Text_File"
	Icon:	1544
	Click:	"Script.FileWrite"
)

(AVIcon.1544
	Name:	"Write"
	Res:	"Icons.Write"

)

(Space.1545
)

(Butn.1546
	Help:	"Script Help//Searches for help using the current selection"
	HelpTopic:	"Getting_help_about_script_components"
	Icon:	1547
	Click:	"Script.Help"
)

(AVIcon.1547
	Name:	"Help"
	Res:	"Icons.Help"

)

(Butn.1548
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	1549
	Click:	"Help.Tool"
)

(AVIcon.1549
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(Space.1550
)

(Butn.1551
	Icon:	1552
	Click:	"DCSewerDesignExtension.make"
)

(AVIcon.1552
	Name:	"DiamondRed"
	Res:	"Icons.DiamondRed"

)

(PopupSet.1575
)

(ToolBar.1576
)

(AVIcon.1577
	Name:	"Icon"
	Res:	"SEd.Icon"

)

(DocGUI.1578
	Name:	"Project"
	Type:	"Project"
	Modified:	1
	MenuBar:	1579
	ButnBar:	1627
	Popups:	1637
	ToolBar:	1638
	Icon:	1639
)

(MenuBar.1579
	Child:	1580
	Child:	1595
	Child:	1609
	Child:	1619
	Child:	1624
)

(PMenu.1580
	InternalName:	"File"
	Child:	1581
	Child:	1582
	Child:	1583
	Child:	1584
	Child:	1585
	Child:	1586
	Child:	1589
	Child:	1592
	Child:	1593
	Child:	1594
	Label:	"&File"
)

(Choice.1581
	Help:	"Creates a new project"
	HelpTopic:	"New_Project"
	Label:	"&New Project"
	Click:	"Project.New"
	Shortcut:	"Keys.Ctrl+N"
)

(Choice.1582
	Help:	"Opens an existing project"
	HelpTopic:	"Open_Project"
	Label:	"&Open Project..."
	Click:	"Project.Open"
	Shortcut:	"Keys.None"
)

(Choice.1583
	Help:	"Closes the project window"
	HelpTopic:	"Close_Project"
	Label:	"&Close Project"
	Click:	"Project.Close"
	Shortcut:	"Keys.None"
)

(Space.1584
)

(Choice.1585
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.1586
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project &As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.1589
)

(Choice.1592
	Help:	"Displays the Extensions dialog"
	HelpTopic:	"Extensions"
	Label:	"&Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.1593
)

(Choice.1594
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.1595
	InternalName:	"Project"
	Child:	1596
	Child:	1597
	Child:	1598
	Child:	1599
	Child:	1600
	Child:	1601
	Child:	1602
	Child:	1603
	Child:	1604
	Child:	1605
	Label:	"&Project"
)

(Choice.1596
	Help:	"Displays the dialog box to edit properties of the project"
	HelpTopic:	"Project_Properties"
	Label:	"&Properties..."
	Click:	"Project.Properties"
	Shortcut:	"Keys.None"
)

(Choice.1597
	Help:	"Customizes the active project"
	HelpTopic:	"Customize"
	Update:	"Project.CustomizeUpdate"
	Label:	"&Customize..."
	Click:	"Project.Customize"
	Shortcut:	"Keys.None"
)

(Space.1598
)

(Choice.1599
	Help:	"Renames the selected project component"
	HelpTopic:	"Rename"
	Update:	"Project.RenameUpdate"
	Label:	"&Rename 'Script.saveAllScripts'..."
	Click:	"Project.Rename"
	Shortcut:	"Keys.Ctrl+R"
)

(Choice.1600
	InternalName:	"C&Copy Document"
	Tag:	"Jennessent"
	Update:	"Jennessent.CopyDocUpdate"
	Label:	"C&opy 'Script.saveAllScripts'..."
	Click:	"Jennessent.CopyDoc"
	Shortcut:	"Keys.None"
)

(Choice.1601
	Help:	"Deletes the selected component from the project"
	HelpTopic:	"Delete_Component"
	Update:	"Project.DeleteUpdate"
	Label:	"&Delete 'Script.saveAllScripts'..."
	Click:	"Project.Delete"
	Shortcut:	"Keys.Del"
)

(Space.1602
)

(Choice.1603
	Help:	"Adds a table to the project"
	HelpTopic:	"Add_Table"
	Update:	"Project.AddTableUpdate"
	Label:	"&Add Table..."
	Click:	"Project.AddTable"
	Shortcut:	"Keys.None"
)

(Choice.1604
	Help:	"Creates a new project component from an external source"
	HelpTopic:	"Import"
	Update:	"Project.ImportUpdate"
	Label:	"&Import..."
	Click:	"Project.Import"
	Shortcut:	"Keys.None"
)

(Choice.1605
	Help:	"Opens the SQL Connection manager"
	HelpTopic:	"SQL_Connect"
	Update:	"Project.HasSQL"
	Label:	"&SQL Connect..."
	Click:	"Project.SQLConnect"
	Shortcut:	"Keys.None"
)

(PMenu.1609
	InternalName:	"Window"
	Child:	1610
	Child:	1611
	Child:	1612
	Child:	1613
	Child:	1614
	Child:	1615
	Child:	1617
	Child:	1618
	Label:	"&Window"
)

(Choice.1610
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.1611
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.1612
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.1613
)

(Choice.1614
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.1615
	ObjectTag:	1616
	Update:	"WindowMenuUpdate"
)

(AVStr.1616
	S:	"dcsewerdesign.apr DCSewerDesignExtension.make"
)

(Choice.1617
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1618
	Help:	"Activates DCSewerDesignExtension.make"
	Label:	"&2 DCSewerDesignExtension.make"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.1619
	InternalName:	"Help"
	Child:	1620
	Child:	1621
	Child:	1622
	Child:	1623
	Label:	"&Help"
)

(Choice.1620
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.1621
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help..."
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.1622
)

(Choice.1623
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(PMenu.1624
	Label:	"Script/Dialog Tools"
)

(ButnBar.1627
	Update:	"Project.UpdateButtons"
	Child:	1628
	Child:	1630
	Child:	1631
)

(Butn.1628
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	1629
	Click:	"Project.Save"
)

(AVIcon.1629
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.1630
)

(Butn.1631
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	1632
	Click:	"Help.Tool"
)

(AVIcon.1632
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(PopupSet.1637
)

(ToolBar.1638
)

(AVIcon.1639
	Name:	"Icon"
	Res:	"Project.Icon"

)

(FN.1834
	Path:	"$HOME"
)

(TClr.1835
	Red:	0xffff
	Green:	0xffff
)

(AVStr.1836
	S:	"View"
)

(AVStr.1837
	S:	"Table"
)

(AVStr.1838
	S:	"Chart"
)

(AVStr.1839
	S:	"Layout"
)

(AVStr.1840
	S:	"Script"
)

(AVStr.1841
	S:	"Project"
)

(AVStr.1842
	S:	"Appl"
)

(AVStr.1843
	S:	"DialogEditor"
)

