/3.2
(ODB.1
	Dependencies:	"$AVEXT/cadview.avx\n$AVEXT/geoproc.avx\n"
	FirstRootClassName:	"Project"
	Roots:	2
	Version:	32
)

(Project.2
	Name:	"dcsewerdesign.apr"
	CreationDate:	"Saturday, February 26, 2000 09:19:58 AM"
	GUIName:	"Project"
	Win:	3
	CSMgr:	4
	DocExts:	5
	VisGUIWidth:	70
	Doc:	6
	Doc:	10
	Doc:	14
	Doc:	18
	Doc:	22
	Doc:	26
	Doc:	30
	Doc:	34
	Doc:	38
	Doc:	42
	Doc:	46
	Doc:	50
	Doc:	54
	Doc:	58
	Doc:	62
	Doc:	66
	Doc:	70
	Doc:	74
	Doc:	78
	Doc:	82
	Doc:	86
	Doc:	90
	Doc:	94
	Doc:	98
	Doc:	102
	Doc:	106
	Doc:	110
	Doc:	114
	Doc:	118
	Doc:	122
	Doc:	126
	Doc:	130
	Doc:	134
	Doc:	138
	Doc:	142
	Doc:	146
	Doc:	150
	Doc:	154
	Doc:	158
	Doc:	162
	Doc:	166
	Doc:	170
	Doc:	174
	Buttons:	178
	Buttons:	179
	Buttons:	180
	Dependencies:	181
	Dependencies:	182
	Scripts:	183
	Prefs:	184
	GUI:	192
	GUI:	471
	GUI:	871
	GUI:	982
	WorkDir:	1048
	WinX:	-4
	WinY:	-3
	WinW:	1608
	WinH:	1179
	SerialNumber:	"835011100145"
	SelColor:	1049
	GUINames:	1050
	GUINames:	1051
	GUINames:	1052
	GUINames:	1053
	GUINames:	1054
	GUINames:	1055
	GUINames:	1056
	TocWidthScale:	1.00000000000000
)

(DocWin.3
	Owner:	2
	Open:	1
	X:	801
	W:	801
	H:	533
)

(CSMgr.4
)

(DocAct.5
	Doc:	2
)

(SEd.6
	Name:	"DCSewerDesign.accumulateBranchLength"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 31. Oktober 2002 15:25:31"
	GUIName:	"Script"
	Win:	7
	CSMgr:	8
	DocExts:	9
	Source:	"' DCSewerDesign.accumulateBranchLength\n\n' accumulates the Branch Length in a simple Sewer Network\n' This will overwrite the AccumulatedBranch field.\n' The maximum upstream branch length (Handover from upstream network)\n' will be accumulated in the AccumulatedBranch field.\n' Note: The lines have to be flipped to the correct direction!\n\n' (c) 2002 DORSCH Consult\n\n'information\n  MsgBox.info(\"The Lines have to be flipped to the Flow direction!\",\"DC Sewer Design\")\n\n'get the table\n  viewActive = av.GetActiveDoc \n
  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n  ' get the fields\n  \n  lstFields = ftbLine.getFields.deepclone\n  lstNumberFields = av.run(\"DCSewerDesign.Fields.returnNumberFields\",lstFields)\n  fldAccumulatedBra
nchLength = MsgBox.choice(lstNumberFields, \"Select the Accumulated Branch Length field.\"+NL+\n                              \"This field will be overwritten.\",\"DC Sewer Design\")\n  if(fldAccumulatedBranchLength = nil)then\n    exit\n  end\n  fldAccumulatedBranchLength = ftbLine.findField(fldAccumulatedBranchLength.getName)\n  fldBranchLength = MsgBox.choice(lstNumberFields, \"Select the BranchLength field.\",\"DC Sewer Design\")\n  if(fldBranchLength = nil)then\n    exit\n  end\n \n fldShape = ftbLine.findField(\"Shape\")\n  
 \n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n 'give the user a chance to kill script\n av.showStopButton \n  \n ftbLine.setEditable(true)\n\nfor each recLine in ftbLine\n  ftbLine.setValue(fldAccumulatedBranchLength,recLine, 0)\nend  \n\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n\n  \nbmpCalculate = Bitmap.make(ftbLine.getNumRecords)\nbmpCalculate.setAll\nbmpCompleted = Bitmap.make(ftbLine.getNumRecords)\nbmpCompleted.setAll\n  \n  \n' loop until all lines are calculated  \n
while(bmpCalculate.count > 0)\nnumPreventEndlessLoop = bmpCalculate.count\n  \n' run over all records in the table\n  for each recLine in bmpCalculate\n\n   ' get the Upstream Manhole\n    pllLine = ftbLine.returnValue(fldShape, recLine)\n    pntUpstreamManhole = pllLine.asList.get(0).get(0)\n    lstUpstreamLines = av.run(\"DCSewerDesign.Manhole.findUpstreamLines\",{ftbLine, pntUpstreamManhole})\n      \n'    numAccumulatedBranchLength = ftbLine.returnValue(fldAccumulatedBranchLength, recLine)\n    numAccumulatedBranchLe
ngth = 0\n      \n    'check if all the upstream pipes have been calculated\n    blnReady = true\n    for each recConnectedLine in lstUpstreamLines\n'      if(bmpCalculate.get(recConnectedLine))then\n      if(ftbLine.returnValue(fldAccumulatedBranchLength,recConnectedLine) <= 0)then\n        blnReady = false\n       ' break\n      else\n       'add the Handover AccumulatedBranchLengths\n        numBranchLength = ftbLine.returnValue(fldAccumulatedBranchLength, recConnectedLine)\n        if(numBranchLength.isNull)then\n  
        numBranchLength = 0\n        end\n        numAccumulatedBranchLength = numAccumulatedBranchLength.max(numBranchLength)\n      end\n    end\n      \n    if(blnReady)then    \n      'calculate the AccumulatedBranchLength\n      numBranchLength = ftbLine.returnValue(fldBranchLength, recLine)\n      numAccumulatedBranchLength = numAccumulatedBranchLength + numBranchLength\n      numAccumulatedBranchLength = numAccumulatedBranchLength.max(0.001)\n      ftbLine.setValue(fldAccumulatedBranchLength, recLine, numAccumu
latedBranchLength)             \n      bmpCompleted.clear(recLine)      \n      'update status display\n      if(av.setStatus((numCounter/numTotal)*100).not)then\n        'user hit the stop button\n        exit\n      end\n      numCounter = numCounter+1\n    end\n  end\n  \n  bmpCalculate.and(bmpCompleted)  \n  \n  if(numPreventEndlessLoop = bmpCalculate.count)then\n    MsgBox.info(\"System leads to endless loop. Aborting.\",\"DC Sewer Design\")\n    exit\n  end\nend\n\n' check if script run was successful\n numSumBranchLength = 
0\n for each recLine in ftbLine\n   numSumBranchLength = numSumBranchLength + ftbLine.returnValue(fldBranchLength, recLine)\n end  \n \n if(numSumBranchLength <> numAccumulatedBranchLength)then\n   Msgbox.info(\"Accumulated BranchLength doesn't match the Sum of BranchLength.\"+NL+\n   \"Script run might have failed. Check the System\",\"DC Sewer Design\")\n end\n \n ftbLine.setEditable(false)\n av.clearStatus\n"
	SearchStr:	"Population"
	FontSize:	1
)

(DocWin.7
	Owner:	6
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.8
)

(DocAct.9
	Doc:	6
)

(SEd.10
	Name:	"DCSewerDesign.accumulatePopulation"
	Creator:	"sdteffen"
	CreationDate:	"Wednesday, March 22, 2000 01:06:36"
	GUIName:	"Script"
	Win:	11
	CSMgr:	12
	DocExts:	13
	Source:	"' DCSewerDesign.accumulatePopulation\n\n' accumulates the Population in a simple Sewer Network\n' This will overwrite the AccumulatedPopulation field.\n' The Population figures (Handover from upstream network)\n' will be accumulated in the AccumulatedPopulation field.\n' Note: The lines have to be flipped to the AccumulatedPopulation direction!\n\n' (c) 2000 - 2004 DORSCH Consult\n \n'information about the configuration file\n  MsgBox.info(\"The Lines have to be flipped to the Flow direction!\",\"DC Sewer Design\")\n\n'get 
the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n  ' get the fields\n  \n  lstFields = ftbLine.getFields.deepclone\n  lstNumberFields = av.run(\"DCSewerDesign.Fields.returnNu
mberFields\",lstFields)\n  fldAccumulatedPopulation = MsgBox.choice(lstNumberFields, \"Select the Accumulated Population field.\"+NL+\n                              \"This field will be overwritten.\",\"DC Sewer Design\")\n  if(fldAccumulatedPopulation = nil)then\n    exit\n  end\n  fldAccumulatedPopulation = ftbLine.findField(fldAccumulatedPopulation.getName)\n  if(fldAccumulatedPopulation.getPrecision < 3)then\n    MsgBox.error(\"The Accumulated Population Field needs at least 3 digits after the decimal point.\",\"DC Sewer
 Design\")\n    exit\n  end\n  \n  fldPopulation = MsgBox.choice(lstNumberFields, \"Select the Population field.\",\"DC Sewer Design\")\n  if(fldPopulation = nil)then\n    exit\n  end\n \n fldShape = ftbLine.findField(\"Shape\")\n   \n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n 'give the user a chance to kill script\n av.showStopButton \n  \n ftbLine.setEditable(true)\n\nfor each recLine in ftbLine\n  ftbLine.setValue(fldAccumulatedPopulation,recLine, 0)\nend  \n\n  numCounter = 0 \n  numTotal = 
ftbLine.GetNumRecords \n\n  \nbmpCalculate = Bitmap.make(ftbLine.getNumRecords)\nbmpCalculate.setAll\nbmpCompleted = Bitmap.make(ftbLine.getNumRecords)\nbmpCompleted.setAll\n  \n  \n' loop until all lines are calculated  \nwhile(bmpCalculate.count > 0)\nnumPreventEndlessLoop = bmpCalculate.count\n  \n' run over all records in the table\n  for each recLine in bmpCalculate\n\n   ' get the Upstream Manhole\n    pllLine = ftbLine.returnValue(fldShape, recLine)\n    pntUpstreamManhole = pllLine.asList.get(0).get(0)\n    lstUpstrea
mLines = av.run(\"DCSewerDesign.Manhole.findUpstreamLines\",{ftbLine, pntUpstreamManhole})\n      \n'    numAccumulatedPopulation = ftbLine.returnValue(fldAccumulatedPopulation, recLine)\n    numAccumulatedPopulation = 0\n      \n    'check if all the upstream pipes have been calculated\n    blnReady = true\n    for each recConnectedLine in lstUpstreamLines\n'      if(bmpCalculate.get(recConnectedLine))then\n      if(ftbLine.returnValue(fldAccumulatedPopulation,recConnectedLine) <= 0)then\n        blnReady = false\n    
   ' break\n      else\n       'add the Handover AccumulatedPopulations\n        numPopulation = ftbLine.returnValue(fldAccumulatedPopulation, recConnectedLine)\n        if(numPopulation.isNull)then\n          numPopulation = 0\n        end\n        numAccumulatedPopulation = numAccumulatedPopulation + numPopulation\n      end\n    end\n      \n    if(blnReady)then    \n      'calculate the AccumulatedPopulation\n      numPopulation = ftbLine.returnValue(fldPopulation, recLine)\n      numAccumulatedPopulation = numAccumu
latedPopulation + numPopulation\n      numAccumulatedPopulation = numAccumulatedPopulation.max(0.001)\n      ftbLine.setValue(fldAccumulatedPopulation, recLine, numAccumulatedPopulation)             \n      bmpCompleted.clear(recLine)      \n      'update status display\n      if(av.setStatus((numCounter/numTotal)*100).not)then\n        'user hit the stop button\n        exit\n      end\n      numCounter = numCounter+1\n    end\n  end\n  \n  bmpCalculate.and(bmpCompleted)  \n  \n  if(numPreventEndlessLoop = bmpCalculate.c
ount)then\n    MsgBox.info(\"System leads to endless loop. Aborting.\",\"DC Sewer Design\")\n    exit\n  end\nend\n\n' check if script run was successful\n numSumPopulation = 0\n for each recLine in ftbLine\n   numSumPopulation = numSumPopulation + ftbLine.returnValue(fldPopulation, recLine)\n end  \n \n if(numSumPopulation <> numAccumulatedPopulation)then\n   Msgbox.info(\"Accumulated Population doesn't match the Sum of Population.\"+NL+\n   \"Script run might have failed. Check the System\",\"DC Sewer Design\")\n end\n \n ftbLine.s
etEditable(false)\n av.clearStatus\n"
	SearchStr:	"Flow"
	FontSize:	1
)

(DocWin.11
	Owner:	10
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.12
)

(DocAct.13
	Doc:	10
)

(SEd.14
	Name:	"DCSewerDesign.calculateMaximumManholeElevations"
	Creator:	"sdteffen"
	CreationDate:	"Sunday, February 27, 2000 02:04:06 PM"
	GUIName:	"Script"
	Win:	15
	CSMgr:	16
	DocExts:	17
	Source:	"' DCSewerDesign.calculateMaximumManholeElevations\n' (c) 2000, 2004, 2005 DORSCH Consult\n\n' Calculates the maximum Manhole levels, based on the elevations from\n' a point theme, according to the miminum cover provided\n' NOTE: This presumes that the lines are flipped to the Flow Direction\n' (use the function provided by DC Sewer Design)\n\n\n' get the table\n viewActive = av.GetActiveDoc\n \n \nlstThemes = viewActive.getActiveThemes\nthmLine = 0\nthmElevation = 0\nif(lstThemes.count = 2)then\n  for each thmTheme in lstTh
emes\n    if((thmTheme.getFTab.getShapeClass.getClassName = \"Polyline\")and\n      (thmTheme.getFTab.isEditable))then\n      thmLine = thmTheme\n    else \n      if(thmTheme.getFTab.getShapeClass.getClassName = \"Point\")then\n        thmElevation = thmTheme\n      end\n    end\n  end\nend\n\nftbLine = thmLine.getFTab\nfldLineShape = ftbLine.findField(\"Shape\")\n\nftbElevation = thmElevation.getFTab\nfldElevationShape = ftbElevation.findField(\"Shape\")\n\n' Get the line fields\nlstLineFields = ftbLine.getFields\nlstNumberFields = a
v.run(\"DCSewerDesign.Fields.returnNumberFields\",lstLineFields)\nfldMaxDownstreamElevation = Msgbox.choice(lstNumberFields, \"Select the downstream elevation field.\",\"DC Sewer Design\")\nif(fldMaxDownstreamElevation.asString = \"nil\")then\n  exit\nend\nfldMaxUpstreamElevation = Msgbox.choice(lstNumberFields, \"Select the upstream elevation field.\",\"DC Sewer Design\")\nif(fldMaxUpstreamElevation.asString = \"nil\")then\n  exit\nend\nfldGradient = Msgbox.choice(lstNumberFields, \"Select the gradient field.\",\"DC Sewer Design\")\n
if(fldGradient.asString = \"nil\")then\n  exit\nend\nfldMinimumCover = Msgbox.choice(lstNumberFields, \"Select the minimum cover field.\", \"DC Sewer Design\")\nif(fldMinimumCover.asString = \"nil\")then\n  exit\nend\n\n' Get the elevation field\nlstElevationFields = ftbElevation.getFields\nlstNumberFields = av.run(\"DCSewerDesign.Fields.returnNumberFields\", lstElevationFields)\nfldElevation = MsgBox.choice(lstNumberFields, \"Select the elevation field.\", \"DC Sewer Design\")\nif(fldElevation.asString = \"nil\")then\n  exit\nend\n\n' As
k for snapping radius\nstrSnappingRadius = MsgBox.input(\"Enter the snapping radius.\",\"DC Sewer Design\",\"5.0\")\nif(strSnappingRadius = nil)then\n  exit\nend\nnumSnappingRadius = strSnappingRadius.asNumber\nif(numSnappingRadius.isNull)then\n  exit\nend\n\n' 1 m should be fine for densification\nnumStepWidth = 1.0\n\n' Data for status display\nnumCounter = 0 \nnumTotal = ftbLine.getNumRecords\n\n'give the user a chance to kill script\n\nav.showStopButton \n\nfor each recLine in ftbLine\n  numGradient = ftbLine.returnValue(fldGradie
nt, recLine)\n  pllLine = ftbLine.returnValue(fldLineShape, recLine)\n  lstLine = pllLine.asList\n  numLength = pllLine.returnLength\n  numMaxDownstreamElevation = Number.makeNull\n  numMaxUpstreamElevation = Number.makeNull\n  if((lstLine.count = 1)and(lstLine.get(0).count = 2))then\n    numMinimumCover = ftbLine.returnValue(fldMinimumCover, recLine)\n    numMaxUpstreamElevation = 1000000.0\n    pntUpstream = pllLine.along(0.0)\n    \n    ' Densify the polyline\n    pllDense = pllLine.returnDensified(numStepWidth)\n   
 \n    ' Select elevation points within snapping radius\n    plgnBuffer = pllLine.returnBuffered(numSnappingRadius)\n    \n    ftbElevation.selectByPolygon(plgnBuffer, #VTAB_SELTYPE_NEW)\n    bmpSelection = ftbElevation.getSelection\n    for each recElevation in bmpSelection\n      pntElevation = ftbElevation.returnValue(fldElevationShape, recElevation)\n      numElevation = ftbElevation.returnValue(fldElevation, recElevation)\n      if(pntElevation.snap(pllDense, numSnappingRadius))then\n        numDistance = pntUps
tream.distance(pntElevation)\n        numUpstreamElevation = numElevation +  (numGradient * numDistance)\n        numMaxUpstreamElevation = numMaxUpstreamElevation.min(numUpstreamElevation)\n      end\n    end\n    if(numMaxUpstreamElevation = 1000000.0)then\n      numMaxUpstreamElevation = Number.makeNull\n    else\n      numMaxUpstreamElevation = numMaxUpstreamElevation - numMinimumCover\n      numMaxDownstreamElevation = numMaxUpstreamElevation - (numGradient * numLength)\n    end\n  end\n  ftbLine.setValue(fldMaxDo
wnstreamElevation, recLine, numMaxDownstreamElevation)\n  ftbLine.setValue(fldMaxUpstreamElevation, recLine, numMaxUpstreamElevation)\n\n  ' Update status display\n  numCounter = numCounter + 1 \n  if(av.setStatus((numCounter/numTotal)*100).not)then\n   ' User hit the stop button\n    exit\n  end\nend\n\n' Clean up\nav.clearStatus"
	FontSize:	1
)

(DocWin.15
	Owner:	14
	W:	801
	H:	972
)

(CSMgr.16
)

(DocAct.17
	Doc:	14
)

(SEd.18
	Name:	"DCSewerDesign.calculateMaximumManholeElevations.update"
	Creator:	"sdteffen"
	CreationDate:	"Montag, 24. Januar 2005 14:13:28"
	GUIName:	"Script"
	Win:	19
	CSMgr:	20
	DocExts:	21
	Source:	"' DCSewerDesign.calculateMaximumManholeElevations.update\n\n' (c) 2005 DORSCH Consult\n\n' Enable the Calculate Maximum Manhole Elevations menu when one Polyline and one\n' Point themes are activated and the Polyline theme is editable\n\nviewActive = av.getActiveDoc\nlstThemes = viewActive.getActiveThemes\nblnLine = false\nblnElevation = false\nif(lstThemes.count = 2)then\n  for each thmTheme in lstThemes\n    if((thmTheme.getFTab.getShapeClass.getClassName = \"Polyline\")and\n      (thmTheme.getFTab.isEditable))then\n     
 blnLine = true\n    else \n      if(thmTheme.getFTab.getShapeClass.getClassName = \"Point\")then\n        blnElevation = true\n      end\n    end\n  end\nend\n  \nif(blnLine and blnElevation)then\n  self.setEnabled(true)\nelse\n  self.setEnabled(false)\nend"
	FontSize:	1
)

(DocWin.19
	Owner:	18
	X:	799
	Y:	549
	W:	677
	H:	420
)

(CSMgr.20
)

(DocAct.21
	Doc:	18
)

(SEd.22
	Name:	"DCSewerDesign.calculateMinimumElevationDifferences"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 09:48:07 AM"
	GUIName:	"Script"
	Win:	23
	CSMgr:	24
	DocExts:	25
	Source:	"' DCSewerDesign.calculateMinimumElevationDifferences\n' (c) 2000 DORSCH Consult\n\n' Calculate the minimum Elevation differences in a sewer network.\n' This runs a network trace from the lowest point of the network\n' to the upper ends of all branches. There must be no network meshes\n' The downstream elevation should be 0 for all the records except for the\n' ones where the trace should start\n\n\n'inform what this is doing\nMsgbox.info(\"The downstream Elevation should be 0 for all the records except for lowest ones.
 This will calculate new upstream and downstream elevations based on a constant gradient\",\"DC Sewer Design\")\n\n' get the table\n viewActive = av.GetActiveDoc\n themeList = viewActive.GetThemes\n lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\") \n if (LineTheme.asString = \"nil\") then\n    exit\n end\n thmLine = viewActive.FindTheme(LineTheme.AsString)\n ftbLine = thmLine.GetFTab\n \n ' get the elevation
 fields\n lstFields = thmLine.getFTab.getFields\n fldDownstreamElevation = Msgbox.choice(lstFields, \"Select the Downstream Elevation Field.\",\"Select a Field\")\n if(fldDownstreamElevation.asString = \"nil\")then\n  exit\n end\n fldUpstreamElevation = Msgbox.choice(lstFields, \"Select the Upstream Elevation Field.\",\"Select a Field\")\n if(fldUpstreamElevation.asString = \"nil\")then\n  exit\n end\n\n fldShape = ftbLine.findField(\"Shape\")\n \n \n' ask the user to specify a gradient\nnumGradient = 0.02\nfldGradient = MsgBox.choice(l
stFields, \"Select Gradient Field\", \"DC Sewer Design\")\nif(fldGradient.asString = \"nil\")then\n  strGradient = msgbox.input(\"Enter the minimum gradient\",\"DC Sewer Design\",\"0.02\")\n  if (strGradient=nil)then\n    exit\n  end\n  numGradient=strGradient.asNumber\n  if(numGradient.isNull)then\n    exit\n  end\nend\n \n ' data for status display\n numCounter = 0 \n numTotal = ftbLine.GetNumRecords\n\n' give the user a chance to kill script\n av.showStopButton \n ftbLine.setEditable(true)\n \n ' The queue of lines for which the connec
tions will be searched\n stkQueue = Stack.make\n    \n 'run over all records in the table, find the startline(s)\n  for each recLine in ftbLine\n    'check if line has already been calculated\n    numDownstreamElevation = ftbLine.returnValue(fldDownstreamElevation, recLine)\n     if( numDownstreamElevation <> 0.0)then\n        stkQueue.push(recLine.clone)\n        numLength = ftbLine.returnValue(fldShape,recLine).returnLength\n        numUpstreamElevation = numDownstreamElevation + (numGradient * numLength)\n        f
tbLine.setValue(fldUpstreamElevation, recLine, numUpstreamElevation)\n        numCounter = numCounter+1\n     end\n  end\n  \nif(stkQueue.isEmpty)then\n  MsgBox.info(\"Did you set the downstream elevation at the lowest point?\",\"DC Sewer Design\")\n  exit\nend\n\n' loop until all lines are calculated  \nwhile(numCounter < numTotal)\n  if(stkQueue.isEmpty)then\n    ftbLine.setEditable(false)\n    av.clearStatus\n    Msgbox.info(\"Could not calculate all Elevations. System might not be fully connected.\",\"DC Sewer Design\")\n    e
xit\n  end\n  recStart = stkQueue.pop\n  lstConnectedLines = av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine, recStart})\n  numDownstreamElevation = ftbLine.returnValue(fldUpstreamElevation,recStart)\n\n  for each recLine in lstConnectedLines\n     if(fldGradient.asString <> \"nil\")then\n       numGradient = ftbLine.returnValue(fldGradient, recLine)\n     end\n     if(ftbLine.returnValue(fldDownstreamElevation,recLine) = 0.0)then\n       ' calculate the upstream elevation\n       numLength = ftbLine.returnValue(
fldShape,recLine).returnLength\n       numUpstreamElevation = numDownstreamElevation + (numGradient * numLength)\n      ftbLine.setValue(fldDownstreamElevation, recLine, numDownstreamElevation)\n       ftbLine.setValue(fldUpstreamElevation, recLine, numUpstreamElevation)\n       numCounter = NumCounter+1\n       stkQueue.push(recLine.clone)\n             \n       ' update status display\n       if(av.setStatus((numCounter/numTotal)*100).not)then\n        ' user hit the stop button\n         exit\n       end\n     end\n 
 end \nend\n\nftbLine.setEditable(false)\nav.clearStatus\n"
	FontSize:	1
)

(DocWin.23
	Owner:	22
	X:	801
	W:	801
	H:	533
)

(CSMgr.24
)

(DocAct.25
	Doc:	22
)

(SEd.26
	Name:	"DCSewerDesign.ComplexProfile.addManholeLegend"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 28. Januar 2005 11:02:00"
	GUIName:	"Script"
	Win:	27
	CSMgr:	28
	DocExts:	29
	Source:	"'DCSewerDesign.ComplexProfile.addManholeLegend\n\n' Adds the manholes with a given legend to the profile\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied warr
anty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nviewProfile = self.get(0)\nif(viewProfile.is(View).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: First Argument is not a view.\",\"DC Sewer
 Design\")\n  exit\nend\n\nftbManhole = self.get(1)\nif(ftbManhole.is(FTab).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Second Argument is not an FTab.\",\"DC Sewer Design\")\n  exit\nend\n\nstrLegend = self.get(2)\nif(strLegend.is(String).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Third Argument is not a String.\",\"DC Sewer Design\")\n  exit\nend\n\nlstProfileManholes = self.get(3)\nif(lstProfileManholes.is(List).not)then\n  MsgBox.error(\"DCSewerDesign.C
omplexProfile.addManholeLegend(): ERROR: Fourth Argument is not a list.\", \"DC Sewer Design\")\n  exit\nend\n\nfldManholeInvertLevel = self.get(4)\nif(fldManholeInvertLevel.is(Field).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Fifth Argument is not a Field.\", \"DC Sewer Design\")\n  exit\nend\n\nftbLine = self.get(5)\nif(ftbLine.is(FTab).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Sixth argument is not an FTab.\", \"DC Sewer Design\")\n  exit\nend\n\nlstP
rofileLines = self.get(6)\nif(lstProfileLines.is(List).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Seventh argument is not a List.\", \"DC Sewer Design\")\n  exit\nend\n\n' Copy layout manholes including all attributes - this allows to apply legend\n\nflnProfileManhole = av.getProject.getWorkDir.makeTmp(\"manhole\",\"shp\")\nftbProfileManhole = ftbManhole.export(flnProfileManhole, Shape, false)\nif(ftbProfileManhole.is(FTab).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManho
leLegend(): ERROR: Export of \"+ftbManhole.asString.quote+\" failed.\", \"DC Sewer Design\")\n  exit\nend\n\n' Draw manholes (shift to correct location)\nftbProfileManhole.setEditable(true)\nfldProfileManholeShape = ftbProfileManhole.findField(\"shape\")\nfldLineShape = ftbLine.findField(\"shape\")\nnumX = 1000.0\nnumY = 1000.0\nfor each i in 0..(lstProfileManholes.count-1)\n  recManhole = lstProfileManholes.get(i)\n  numInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recManhole)\n  pntProfileManhole = Point.make(num
X, numY+(numInvertLevel*10))\n  ftbProfileManhole.setValue(fldProfileManholeShape, recManhole, pntProfileManhole)\n  if(i < lstProfileLines.count)then\n    numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n  end\nend\nftbProfileManhole.setEditable(false)\n\nthmProfileManhole = FTheme.make(ftbProfileManhole)\nviewProfile.addTheme(thmProfileManhole)\nflnLegend = Filename.make(strLegend)\nif(flnLegend.is(Filename).not)then\n  MsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend():
 ERROR: Could not open file \"+strLegend.quote+\".\", \"DC Sewer Design\")\n  exit\nend\nlgdProfileManhole = thmProfileManhole.getLegend\nif(lgdProfileManhole.load(flnLegend, #LEGEND_LOADTYPE_ALL).not)then\nMsgBox.error(\"DCSewerDesign.ComplexProfile.addManholeLegend(): ERROR: Could not load legend \"+strLegend.quote+\".\", \"DC Sewer Design\")\n  exit\nend\nthmProfileManhole.updateLegend\nthmProfileManhole.setVisible(true)"
	FontSize:	1
)

(DocWin.27
	Owner:	26
	W:	801
	H:	972
)

(CSMgr.28
)

(DocAct.29
	Doc:	26
)

(SEd.30
	Name:	"DCSewerDesign.ComplexProfile.create"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 18:30:03"
	GUIName:	"Script"
	Win:	31
	CSMgr:	32
	DocExts:	33
	Source:	"' DCSewerDesign.ComplexProfile.create\n\n' creates a longitudinal section for the selected lines\n\n' called from the DC Sewer menu\n\n' (c) 2000 - 2005 DORSCH Consult\n\n' TODO: remove dc_id dependency\n\n' adjustment to control elevation of profile above data boxes\nnumAdjustment = 15\n\nextSewer = Extension.find(\"DC Sewer Design\")\ndicPreferences = extSewer.getPreferences\nstrConfigurationFile = dicPreferences.get(\"strComplexProfileConfigurationFile\")\nwhile(strConfigurationFile = nil)\n  av.run(\"DCSewerDesign.ComplexPro
file.selectConfigurationFile\", nil)\n  strConfigurationFile = dicPreferences.get(\"strComplexProfileConfigurationFile\")\nend\n\n' open the configuration file\n\nlnfConfiguration = LineFile.make(strConfigurationFile.asFilename, #FILE_PERM_READ)\n\nfldManholeID=nil\nfldManholeDiameter=nil\nfldManholeInvertLevel=nil\nfldManholeElevation=nil\nfldLineID = nil\nfldLineDiameter = nil\nfldLineUpstreamInvert = nil\nfldLineDownstreamInvert = nil\nstrLineTheme = nil\nstrManholeTheme = nil\nintDatumInterval = nil\nfldLineDcId = nil\nstrMan
holeLegend = nil\n\n' first configuration file run to locate theme names\n\nstrLine=lnfConfiguration.readElt\n'process the configuration file \nwhile (not (strLine=nil ))\n  lstConfTokens = strLine.asTokens(\"=\")\n  if(lstConfTokens.count=2)then\n    strScriptFieldName = lstConfTokens.get(0).trim.lcase\n    strTableFieldName = lstConfTokens.get(1).trim.lcase\n    if(strScriptFieldName = \"line.theme\")then\n      strLineTheme = strTableFieldName\n    elseif(strScriptFieldName = \"manhole.theme\")then\n      strManholeTheme = 
strTableFieldName\n    elseif(strScriptFieldName = \"manhole.legend\")then\n      strManholeLegend = strTableFieldName  \n    end\n  end\n  strLine = lnfConfiguration.readElt\nend\n \n' close the configuration file\nlnfConfiguration.close\n \n' get the line table\n\nthmLine = nil\nviewActive = av.getActiveDoc\nthemeList = viewActive.getThemes\nlstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\nfor each thmTheme in lstLineThemes\n  if((strLineTheme <> nil)and(strLineTheme.lcase = thmTheme.getName.lca
se))then\n    thmLine = thmTheme\n    break\n  end\n  if(thmTheme.getName.left(6) <> \"Profil\")then\n    lstLineThemes.shuffle(thmTheme, 0)\n    break\n  end\nend\nif(thmLine.asString = \"nil\")then\n  thmLine = Msgbox.Choice (lstLineThemes, \"Select the Sewer Line Theme.\", \"DC Sewer - Complex Profile\")   \nend\nif(thmLine.asString = \"nil\") then\n  exit\nend\nftbLine = thmLine.GetFTab \nfldLineDcId = ftbLine.findField(\"dc_id\")\nif(fldLineDcId.asString = \"nil\")then\n  MsgBox.error(\"Error: Field Line.DC_ID was not found.\",\"DC Sewe
r Design\")\n  exit\nend\n\n' get the manhole table\nthmManhole = nil\nlstManholeThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\nfor each thmTheme in lstManholeThemes\n  if((strManholeTheme <> nil)and(strManholeTheme.lcase = thmTheme.getName.lcase))then\n    thmManhole = thmTheme\n    break\n  end\nend\nif(thmManhole.asString = \"nil\")then\n  thmManhole = Msgbox.Choice (lstManholeThemes, \"Select the Manhole Theme.\", \"DC Sewer - Complex Profile\")\nend\nif (thmManhole.asString = \"nil\") then\n  exit\nend\n
ftbManhole = thmManhole.GetFTab \n\n' get one selected line\nbmpSelectedLines = ftbLine.getSelection.clone\nif(bmpSelectedLines.count < 2)then\n  MsgBox.info(\"Please select the Lines for which the Profile should be created\",\"DC Sewer - Complex Profile\")\n  exit\nend\nrecTrace = bmpSelectedLines.getNextSet(-1)\nlstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\nlstConnectedSelected = List.make\nfor each recConnected in lstConnectedLines\n  if(bmpSelectedLines.get(recConnected))then\n   
 lstConnectedSelected.add(recConnected)\n  end\nend\n\nav.showStopButton\nnumSelected = bmpSelectedLines.count\n\n' trace to end section (of selection)\nnumFreezePrevent = 0\nlstTried = List.make\nwhile(lstConnectedSelected.count = 2)\n    if((recTrace = lstConnectedSelected.get(0))or(lstTried.findByValue(recTrace)<>(-1)))then\n    recTrace = lstConnectedSelected.get(1)\n  else\n    recTrace = lstConnectedSelected.get(0)\n  end\n  if(lstConnectedSelected.findByValue(recTrace) = -1)then\n    lstConnectedSelected.add(recTrace
)\n  end\n  lstConnectedSelected = List.make\n  strControl = \"\"\n  lstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\n  if(Number.makeRandom(0,1) > 0.5)then\n    lstConnectedLines.sort(true)\n  else\n    lstConnectedLines.sort(false)\n  end\n  for each recConnected in lstConnectedLines\n    if((bmpSelectedLines.get(recConnected)and(lstConnectedSelected.find(recConnected) = -1)))then\n      lstConnectedSelected.add(recConnected)\n      lstTried.add(recConnected)\n      strControl = strCo
ntrol ++ftbLine.returnValue(fldLineDcId, recConnected).asString\n    end\n  end\n  numFreezePrevent = numFreezePrevent+1\n  if(numFreezePrevent = 10000)then\n    System.echo(strControl)\n    MsgBox.info(\"Went into endless loop. Check the Topology.\", \"DC Sewer Design\")\n    exit\n  end\n  if(av.setStatus(0).not)then\n    exit\n  end\nend\nif(lstConnectedSelected.count>2)then\n  MsgBox.info(\"Can't draw Profile for forks. Please check the selection.\",\"DC Sewer Design\")\n  exit\nend\n\n' bounce: start the real trace to other end
 of selection\n\nlstProfileLines = List.make\nlstProfileLines.add(recTrace)\n\nrecTrace = lstConnectedSelected.get(0)\nlstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\nlstConnectedSelected = List.make\nfor each recConnected in lstConnectedLines\n  if(bmpSelectedLines.get(recConnected))then\n    lstConnectedSelected.add(recConnected)\n  end\nend\nlstProfileLines.add(recTrace)\n\nwhile(lstConnectedSelected.count = 2)\n  if(lstProfileLines.findByValue(lstConnectedSelected.get(0)) <> -1)the
n\n    recTrace = lstConnectedSelected.get(1)\n  else\n    recTrace = lstConnectedSelected.get(0)\n  end\n  lstProfileLines.add(recTrace)\n  lstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\n  lstConnectedSelected = List.make\n  for each recConnected in lstConnectedLines\n    if(bmpSelectedLines.get(recConnected))then\n      lstConnectedSelected.add(recConnected)\n    end\n  end\n  if(av.setStatus(lstProfileLines.count/numSelected*100).not)then\n    exit\n  end\nend\nif(lstConnectedSelect
ed.count>2)then\n  MsgBox.info(\"Can't draw profile for forks. Please check the selection.\",\"DC Sewer - Complex Profile\")\n  exit\nend\nif(lstProfileLines.count <> bmpSelectedLines.count)then\n  MsgBox.info(\"Selected lines are not fully connected. Please check.\",\"DC Sewer - Complex Profile\")\n  exit\nend\n\nftbLine.setSelection(bmpSelectedLines)\n\n' build Manhole list\n\nlstProfileManholes = List.make\n\nlstPreviousManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,lstProfileLines.get(0)}).clone\nlstMa
nholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,lstProfileLines.get(1)}).clone\nfor each recManhole in lstPreviousManholes\n  if(lstManholes.findByValue(recManhole) = -1)then\n    lstProfileManholes.add(recManhole)\n  end\nend\n\nfor each recLine in lstProfileLines\n  lstManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,recLine})\n  for each recManhole in lstManholes\n    if(lstProfileManholes.findByValue(recManhole) = -1)then\n      lstProfileManholes.add(recManhole)\n    en
d\n  end\nend\n\n' check if there are enough manholes\nif(lstProfileManholes.count <> (lstProfileLines.count + 1))then\n  MsgBox.info(\"Only found\"++lstProfileManholes.count.asString++\"manholes. Should find\"++(lstProfileLines.count+1).asString++\".\"+NL+\n              \"See the selection for details.\",\"DC Sewer - Complex Profile\")\n  bmpManholes = ftbManhole.getSelection\n  bmpManholes.clearAll\n  for each recManhole in lstProfileManholes\n    bmpManholes.set(recManhole.clone)\n  end\n  ftbManhole.setSelection(bmpManholes)
\n  ftbManhole.updateSelection\n  exit\nend\n\nlstFreeLineFields = List.make\nlstFreeManholeFields = List.make\nlstFreeCumulativeLineFields = List.make\n\nlstFreeFields = {{\"linedata\",lstFreeLineFields},\n  {\"manholedata\",lstFreeManholeFields},\n  {\"cumulativelinedata\",lstFreeCumulativeLineFields}}\n\n' second configuration file run\nlnfConfiguration = LineFile.make(strConfigurationFile.asFilename, #FILE_PERM_READ)\nstrLine=lnfConfiguration.readElt\nwhile (not (strLine=nil ))\n  lstConfTokens = strLine.asTokens(\"=\")\n  if(ls
tConfTokens.count=2)then\n    strScriptFieldName = lstConfTokens.get(0).trim.lcase\n    strTableFieldName = lstConfTokens.get(1).trim.lcase\n    if(strScriptFieldName = \"manhole.id\")then\n      fldManholeID=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"manhole.diameter\")then\n      fldManholeDiameter=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"manhole.invertlevel\")then\n      fldManholeInvertLevel=ftbManhole.findField(strTableFieldName)\n    end\n    i
f(strScriptFieldName = \"manhole.elevation\")then\n      fldManholeElevation=ftbManhole.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.diameter\")then\n      fldLineDiameter = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.id\")then\n      fldLineID = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.upstreaminvert\")then\n      fldLineUpstreamInvert = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"line.do
wnstreaminvert\")then\n      fldLineDownstreamInvert = ftbLine.findField(strTableFieldName)\n    end\n    if((strScriptFieldName = \"datuminterval\")and(strTableFieldName.isnumber))then\n      intDatumInterval = strTableFieldName.asNumber.truncate\n    end\n    for each lstFreeField in lstFreeFields\n      if(strScriptFieldName = lstFreeField.get(0))then\n        lstFieldTokens = strTableFieldName.asTokens(\"@\")\n        if(lstFieldTokens.count = 4)then\n          lstFree = {lstFieldTokens.get(0),lstFieldTokens.get(1).as
Number,\n            lstConfTokens.get(1).asTokens(\"@\").get(2), lstFieldTokens.get(3).asNumber}\n          lstFreeField.get(1).add(lstFree)      \n        end\n      end \n    end\n  end\n  strLine = lnfConfiguration.readElt\nend\nlnfConfiguration.close\n\n' Check configuration\nif(fldManholeID = nil)then\n  MsgBox.error(\"Error: Field Manhole.ID was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldManholeDiameter = nil)then\n  MsgBox.error(\"Error: Field Manhole.Diameter was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fld
ManholeInvertLevel = nil)then\n  MsgBox.error(\"Error: Field Manhole.InvertLevel was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldManholeElevation = nil)then\n  MsgBox.error(\"Error: Field Manhole.Elevation was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineID = nil)then\n  MsgBox.error(\"Error: Field Line.ID was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineDiameter = nil)then\n  MsgBox.error(\"Error: Field Line.Diameter was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineUpstreamInvert = nil)the
n\n  MsgBox.error(\"Error: Field Line.UpstreamInvert was not found.\",\"DC Sewer Design\")\n  exit\nend\nif(fldLineDownstreamInvert = nil)then\n  MsgBox.error(\"Error: Field Line.DownstreamInvert was not found.\",\"DC Sewer Design\")\n  exit\nend\n\nfldManholeShape = ftbManhole.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\n\nflnProfile = av.getProject.getWorkDir.makeTmp(\"profile\",\"shp\")\nftbProfile = FTab.makeNew(flnProfile,PolyLine)\n\nftbProfile.setEditable(true)\nfldProfileShape = ftbProfile.findField(\"Shape\")\n
ftbProfile.addFields({Field.make(\"id\", #FIELD_DECIMAL, 4, 0),\n  Field.make(\"style\",#FIELD_CHAR,16,0),\n  Field.make(\"dc_id\", #FIELD_CHAR, 16, 0)})\nfldProfileStyle = ftbProfile.findField(\"style\")\nfldProfileDcId = ftbProfile.findField(\"dc_id\")\n\npntManhole = ftbManhole.returnValue(fldManholeShape, lstProfileManholes.get(0))\npllLine = ftbLine.returnValue(fldLineShape, lstProfileLines.get(0))\nif(pntManhole.distance(pllLine.along(0)) > 0.1)then\n   lstProfileManholes = av.run(\"DCSewerDesign.List.flip\", lstProfileMa
nholes)\n   lstProfileLines = av.run(\"DCSewerDesign.List.flip\", lstProfileLines)\nend\n\n' create the profile view\nstrFirstManhole = ftbManhole.returnValue(fldManholeID, lstProfileManholes.get(0)).asString\nstrLastManhole = ftbManhole.returnValue(fldManholeID, lstProfileManholes.get(lstProfileManholes.count-1)).asString\nstrViewName = \"Profile\"++strFirstManhole++\"-\"++strLastManhole\nlstViews = av.getProject.getDocsWithGUI(av.findGUI(\"View\"))\nfor each viewCheck in lstViews\n  if(viewCheck.getName = strViewName)then\n
    blnOverwrite = MsgBox.yesNo(\"A view named'\"+strViewName+\"' already exists.\"+NL+\"Overwrite it?\", \"DC Sewer Design\", true)\n    if(blnOverwrite)then\n      av.getProject.removeDoc(av.getProject.findDoc(strViewName))      \n    else\n      exit\n    end\n  end\nend\nviewProfile = View.make\nviewProfile.setName(strViewName)\nviewProfile.getWin.activate\n\nviewProfile.setUnits(#UNITS_LINEAR_METERS)\nviewProfile.getDisplay.setDistanceUnits(#UNITS_LINEAR_METERS)\nviewProfile.getDisplay.zoomToScale(1000)\n\n' draw manholes\n\nnu
mX = 1000.0\nnumY = 1000.0\nfor each i in 0..(lstProfileManholes.count-1)\n  recProfile = ftbProfile.addRecord\n  recManhole = lstProfileManholes.get(i)\n  numDiameter = ftbManhole.returnValue(fldManholeDiameter, recManhole)\n  numInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recManhole)\n  numElevation = ftbManhole.returnValue(fldManholeElevation, recManhole)\n  pntLowerLeft = Point.make(numX-(numDiameter/2000), numY+(numInvertLevel*10))\n  pntUpperLeft = Point.make(numX-(numDiameter/2000), numY+(numE
levation*10))\n  pntUpperRight = Point.make(numX+(numDiameter/2000), numY+(numElevation*10))\n  pntLowerRight = Point.make(numX+(numDiameter/2000), numY+(numInvertLevel*10))\n  pllManhole = Polyline.make({{pntLowerLeft,pntUpperLeft,pntUpperRight, pntLowerRight, pntLowerLeft}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllManhole)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n  \n  recProfile = ftbProfile.addRecord\n  pntCenterlineStart = Point.make(numX, numY+(numElevation*10))\n  pntCenterl
ineEnd = Point.make(numX, numY+(ftbManhole.returnValue(fldManholeInvertLevel, lstProfileManholes.get(lstProfileManholes.count-1))*10)-12-numAdjustment)\n  pllManholeCenterline = Polyline.make({{pntCenterlineStart, pntCenterlineEnd}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllManholeCenterline)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\") \n    \n  ' Draw connecting lines\n  if((i <> 0)and(i<>(lstProfileManholes.count-1)))then\n    pntManhole = ftbManhole.returnValue(fldManholeShape, r
ecManhole)\n    ftbLine.selectByPoint(pntManhole, 0.001, #VTAB_SELTYPE_NEW)\n    lstConnected = List.make\n    for each recLine in ftbLine.getSelection\n      if(lstProfileLines.findByValue(recLine) = (-1))then\n        numLineInvert = ftbLine.returnValue(fldLineDownstreamInvert, recLine)\n        numLineDiameter = ftbLine.returnValue(fldLineDiameter, recLine)\n        blnAdded = false\n        for each lstConnection in lstConnected\n          if((numLineDiameter = lstConnection.get(1) and (numLineInvert = lstConnec
tion.get(2))))then\n            lstConnection.set(0, lstConnection.get(0)+1)\n            blnAdded = true\n          end\n        end\n        if(blnAdded = false)then\n          lstConnected.add({1,numLineDiameter,numLineInvert})\n        end\n        shpCircle = Circle.make(Point.make(numX, numY+(numLineInvert*10)+(numLineDiameter/200)), numLineDiameter/200)\n        plgnCircle = shpCircle.asPolygon\n        pllCircle = plgnCircle.asPolyline\n        recCircle = ftbProfile.addRecord\n        ftbProfile.setValue(fldPr
ofileShape, recCircle, pllCircle)\n        ftbProfile.setValue(fldProfileStyle, recCircle, \"normal\")\n      end\n    end\n    numHeight = 0\n    for each lstConnection in lstConnected\n      numConnections = lstConnection.get(0)\n      numLineDiameter = lstConnection.get(1)\n      numLineInvert = lstConnection.get(2)\n      pntConnection = Point.make(numX, numY+(numLineInvert*10)+(numLineDiameter/100))\n      pllMark = Line.make(pntConnection, pntConnection.clone.move(0, 35)).asPolyLine\n      pllMark = pllMark.return
Union(Line.make(pntConnection, pntConnection.clone.move(-3, 4)).asPolyLine)\n      pllMark = pllMark.returnUnion(Line.make(pntConnection, pntConnection.clone.move(3, 4)).asPolyLine)\n      recProfile = ftbProfile.addRecord\n      ftbProfile.setValue(fldProfileShape, recProfile, pllMark)\n      ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n      pntIDLocation = Point.make(numX, numY+10+(numElevation*10)+numHeight)\n      numPosition = numX\n      strConnectionText = \"DN \"+numLineDiameter.asString+NL+n
umLineInvert.asString\n      if(numConnections <> 1)then\n        strConnectionText = numConnections.asString++strConnectionText\n      end\n      gtxIDLabel = GraphicText.make(strConnectionText, pntIDLocation)\n      gtxIDLabel.setAngle(90)\n      viewProfile.getGraphics.add(gtxIDLabel)\n      tpsID = TextPositioner.make(Point)\n      tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n      tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_TOP)\n      tpsID.Calculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n      numHeight = 
numHeight + gtxIDLabel.getExtent.getY + 3\n      gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n      for each symText in gtxIDLabel.returnSymbols\n        viewProfile.getDisplay.hookupSymbol(symText)\n      end\n    end\n  end\n  \n  if(i < lstProfileLines.count)then\n    numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n  end\nend\n\n' draw lines\n\nnumMinInvertElevation = 9999\nnumMaxGroundElevation = -9999\n\nnumX = 1000.0\nfor each i in 0..(lstProfileLines.count-1)\n  recProfile = ftbProfile.add
Record\n  recLine = lstProfileLines.get(i)\n  recUpstreamManhole = lstProfileManholes.get(i)\n  recDownstreamManhole = lstProfileManholes.get(i+1)\n  numLineDiameter = ftbLine.returnValue(fldLineDiameter, recLine)\n  numUpstreamManholeDiameter = ftbManhole.returnValue(fldManholeDiameter, recUpstreamManhole)\n  numDownstreamManholeDiameter = ftbManhole.returnValue(fldManholeDiameter, recDownstreamManhole)\n  numUpstreamInvertLevel = ftbLine.returnValue(fldLineUpstreamInvert, recLine)\n  numDownstreamInvertLevel = ft
bLine.returnValue(fldLineDownstreamInvert, recLine)\n  numMinInvertElevation = numMinInvertElevation.min(numUpstreamInvertLevel.min(numDownstreamInvertLevel)).clone\n  pllLine = ftbLine.returnValue(fldLineShape, recLine)\n  numLineLength = pllLine.returnLength\n  pntUpstreamInvert = Point.make(numX+(numUpstreamManholeDiameter/2000), numY+(numUpstreamInvertLevel*10))\n  pntDownstreamInvert=Point.make(numX+numLineLength-(numDownstreamManholeDiameter/2000), numY+(numDownstreamInvertLevel*10))\n  pllInvert = Polyline
.make({{pntUpstreamInvert, pntDownstreamInvert}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllInvert)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n  recProfile = ftbProfile.addRecord\n  pntUpstreamUpperLevel = pntUpstreamInvert+Point.make(0,numLineDiameter/100)\n  pntDownstreamUpperLevel = pntDownstreamInvert+Point.make(0,numLineDiameter/100)\n  pllUpper = Polyline.make({{pntUpstreamUpperLevel, pntDownstreamUpperLevel}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllUpper)\n  ft
bProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n  recProfile = ftbProfile.addRecord\n  numUpstreamElevation = ftbManhole.returnValue(fldManholeElevation, recUpstreamManhole)\n  numDownstreamElevation = ftbManhole.returnValue(fldManholeElevation, recDownstreamManhole)\n  numMaxGroundElevation = numMaxGroundElevation.max(numUpstreamElevation.max(numDownstreamElevation)).clone\n  pntUpstreamElevation = Point.make(numX+(numUpstreamManholeDiameter/2000), numY+(numUpstreamElevation*10))\n  pntDownstreamElevati
on = Point.make(numX+numLineLength-(numDownstreamManholeDiameter/2000), numY+(numDownstreamElevation*10))\n  pllElevation = Polyline.make({{pntUpstreamElevation, pntDownstreamElevation}})\n  ftbProfile.setValue(fldProfileShape, recProfile, pllElevation)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n  strDcId = ftbLine.returnValue(fldLineDcId, recLine)\n  ftbProfile.setValue(fldProfileDcId, recProfile, strDcId)\n  \n  numX = numX + numLineLength\nend\n\nnumTotalLength = numX - 1000.0\nnumX = 1000.0\nnumY 
= numY + (ftbManhole.returnValue(fldManholeInvertLevel, lstProfileManholes.get(lstProfileManholes.count-1))*10)-12-numAdjustment\n\nfor each lstFreeField in lstFreeManholeFields\n  fldFree = ftbManhole.findField(lstFreeField.get(0))\n  if(fldFree <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.ManholeDataBox.create\", {ftbProfile, ftbLine, ftbManhole, viewProfile, 1000.0, numY, fldFree, lstFreeField.get(2), lstProfileManholes, lstProfileLines, lstFreeField.get(1), true, lstFreeField.get(3)})\n  else\n    Syst
em.echo(\"Could not find field \"+lstFreeField.get(0)+\" in manhole table.\")\n  end\nend\n\nfor each lstFreeField in lstFreeLineFields\n  fldFree = ftbLine.findField(lstFreeField.get(0))\n  if(fldFree <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.LineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldFree, lstFreeField.get(2), lstProfileLines, lstFreeField.get(1),lstFreeField.get(3)})\n  else\n    System.echo(\"Could not find field \"+lstFreeField.get(0)+\" in line table.\")\n  end\nend\n\nfor each ls
tFreeField in lstFreeCumulativeLineFields\n  fldFree = ftbLine.findField(lstFreeField.get(0))\n  if(fldFree <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.CumulativeLineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldFree, lstFreeField.get(2), lstProfileLines, lstFreeField.get(1),lstFreeField.get(3)ö})\n  else\n    System.echo(\"Could not find field \"+lstFreeField.get(0)+\" in line table.\")\n  end\nend\n \n' draw bounding box\n\nnumBoundingBoxTop = 1000 + (ftbManhole.returnValue(fldManholeInv
ertLevel, lstProfileManholes.get(lstProfileManholes.count-1))*10)-8-numAdjustment  \npntBoundingBoxOrigin = Point.make(1000-60, numY)\npntBoundingBoxSize = Point.make(numTotalLength+60+20, numBoundingBoxTop-numY-4)\npllBoundingBox = Rect.make(pntBoundingBoxOrigin, pntBoundingBoxSize).asPolygon.asPolyline\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllBoundingBox)\nftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n' draw datum lines if necessary\nif((intDatumInterval
.asString <> \"nil\")and(numMinInvertElevation < numMaxGroundElevation))then\n  numFirstDatumLine = ((numMinInvertElevation/intDatumInterval).truncate)*intDatumInterval\n  numLastDatumLine = (((numMaxGroundElevation/intDatumInterval).truncate)*intDatumInterval)+intDatumInterval\n  for each numDatumLine in numFirstDatumLine..numLastDatumLine by intDatumInterval\n    ' The next line should use numY instead of 1000\n    pllDatum = Polyline.make({{1000@((numDatumLine*10)+1000), (1000+numTotalLength)@((numDatumLine*10)
+1000)}})\n    recDatum = ftbProfile.addRecord\n    ftbProfile.setValue(fldProfileShape, recDatum, pllDatum)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  \n    ' Datum Label\n    pntIDLocation = Point.make(999, (numDatumLine*10)+1000)\n    gtxIDLabel = GraphicText.make(numDatumLine.asString, pntIDLocation)\n'      gtxIDLabel.setAngle(90)\n      viewProfile.getGraphics.add(gtxIDLabel)\n      tpsID = TextPositioner.make(Point)\n      tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_LEFT)\n      tpsID.SetVAlig
n(#TEXTPOSITIONER_VALIGN_ON)\n      tpsID.Calculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n      gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n      for each symText in gtxIDLabel.returnSymbols\n        viewProfile.getDisplay.hookupSymbol(symText)\n      end\n  end \n  ' draw side lines\n  pllDatum = Polyline.make({{1000@((numFirstDatumLine*10)+1000), (1000)@((numLastDatumLine*10)+1000)}})\n  recDatum = ftbProfile.addRecord\n  ftbProfile.setValue(fldProfileShape, recDatum, pllDatum)\n  ftbProfile.setValue(fldProfileSt
yle, recProfile, \"normal\")\n  pllDatum = Polyline.make({{(1000+numTotalLength)@((numFirstDatumLine*10)+1000), (1000+numTotalLength)@((numLastDatumLine*10)+1000)}})\n  recDatum = ftbProfile.addRecord\n  ftbProfile.setValue(fldProfileShape, recDatum, pllDatum)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\nend\n\nftbProfile.setEditable(false)\nthmProfile = FTheme.make(ftbProfile)\nviewProfile.addTheme(thmProfile)\nlgdProfile = thmProfile.getLegend\nlgdProfile.setLegendType(#LEGEND_TYPE_UNIQUE)\nlgdProfile
.unique(thmProfile, \"style\")\nfor each symUnique in lgdProfile.getSymbols\n  symUnique.setColor(Color.getBlack)\nend\nlgdProfile.getSymbols.get(0).setSize(1)\nthmProfile.updateLegend\n\n' Add manholes with given legend if \"Manhole.Legend\" was given in configuration file\nif(strManholeLegend <> nil)then\n  av.run(\"DCSewerDesign.ComplexProfile.addManholeLegend\", {viewProfile, ftbManhole, strManholeLegend, lstProfileManholes, fldManholeInvertLevel, ftbLine, lstProfileLines})\nend\n\nav.clearStatus\nthmProfile.setVisible(tr
ue) \nrctExtent = viewProfile.returnExtent\nviewProfile.getDisplay.setExtent(rctExtent.Scale(1.1))\n\nav.getProject.setModified(true)  "
	SearchStr:	"gradient"
	FontSize:	1
)

(DocWin.31
	Owner:	30
	X:	259
	Y:	32
	W:	801
	H:	972
)

(CSMgr.32
)

(DocAct.33
	Doc:	30
)

(SEd.34
	Name:	"DCSewerDesign.ComplexProfile.selectConfigurationFile"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 18:49:38"
	GUIName:	"Script"
	Win:	35
	CSMgr:	36
	DocExts:	37
	Source:	"' DCSewerDesign.ComplexProfile.selectConfigurationFile\n\n' (c) 2004 DORSCH Consult\n\n' select the configuration file and save it as a preference\n\n' information about the configuration file\nMsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"Manhole.ID=???    Manhole.Diameter=???\"+NL+\n  \"Manhole.InvertLevel = ??? Manhole.Elevation = ???\"+NL+\n  \"Line.Diameter=???, Line.Gradient=???, Line.MaximumFlow=???\"\n  ,\"Complex Field Configuration File\")\n\n\nlstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text File
s (*.txt)\"},\"Select Configuration File\",0)\nif(lstConfFiles.count = 0 )then\n  exit\nend\nstrFile = lstConfFiles.get(0).asString\nextSewer = Extension.find(\"DC Sewer Design\")\ndicPreferences = extSewer.getPreferences\ndicPreferences.set(\"strComplexProfileConfigurationFile\", strFile)\n\n"
	FontSize:	1
)

(DocWin.35
	Owner:	34
	X:	534
	W:	534
	H:	533
)

(CSMgr.36
)

(DocAct.37
	Doc:	34
)

(SEd.38
	Name:	"DCSewerDesign.createDbfSewerCalculation"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 30. Mai 2000 12:27:29"
	GUIName:	"Script"
	Win:	39
	CSMgr:	40
	DocExts:	41
	Source:	"' DCSewerDesign.createDbfSewerCalculation\n' Create an Dbf table containing the Sewerage Calculation\n' (c) 2000 DORSCH Consult\n \n'information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"PipeID=???    Diameter=???\"+NL+\n  \"Gradient=???    Roughness=???\"+NL+\n  \"AccumulatedPopulation=???   PeakFactor=???\"\n  ,\"Field Configuration File\")\n  \n'get the configuration file\n  lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"Select Configuration File\",
0)\n if(lstConfFiles.count = 0 )then\n   exit\n end\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  LineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n 'open the configuration file\n lnfConfiguration = LineFile.make(ls
tConfFiles.get(0), #FILE_PERM_READ)\n\n fldPipeID=nil\n fldDiameter=nil\n fldGradient=nil\n fldRoughness=nil\n fldPopulation=nil\n strPeakFactorFormula=\"1\"\n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"pipeid\")then\n        fldPipeID=ftbLine.find
Field(strTableFieldName)\n      end\n      if(strScriptFieldName = \"diameter\")then\n        fldDiameter=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"gradient\")then\n        fldGradient=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"roughness\")then\n        fldRoughness=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"accumulatedpopulation\")then\n        fldPopulation=ftbLine.findField(strTableFieldName)\n      end\n      if
(strScriptFieldName = \"peakfactor\")then\n        if(strTableFieldName.isNumber)then\n          strPeakFactorFormula=strTableFieldName\n        else\n          if(strTableFieldName.ucase =\"BAUMANN\")then\n            strPeakFactorFormula = \"BAUMANN\" \n          elseif(strTableFieldName.ucase = \"BABITT\")then\n            strPeakFactorFormula = \"BABITT\" \n          else\n            Msgbox.info(\"Unknown Peak Factor Formula.\"+NL+\n            \"Baumann and Babitt are valid.\"+NL+\n            \"Using constant peak factor 1.\",
\"DC Sewer Design\")\n          end\n        end\n      end\n    end\n    strLine = lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n \n 'get information\n strLitersPerDayAndPerson = MsgBox.input(\"Sewage flow per person and day\",\"DC Sewer Design\",\"120\")\n if(strLitersPerDayAndPerson = nil)then\n   exit\n end\n \n 'check if configuration was successful\n  if((fldPipeID=nil)or(fldDiameter=nil)or(fldGradient=nil)or(fldRoughness=nil)\n  or(fldPopulation=nil))then\n    MsgBox.error(\"Field ma
tching not successful. Check your table and configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n\n ' create DBF-File\n  flnDbfFile = FileDialog.put(\"\".asFilename.makeTmp(\"sewer_calculation\",\"dbf\"), \"*.dbf\", \"Save Calculation file\")\n  if(flnDbfFile = nil )then\n   exit\n  end\n  vtbCalc = vtab.makeNew(flnDbfFile, dBase) \n  vtbCalc.setEditable(true)\n  \n  \n  'create fields\n  \n  List lstFields = List.make\n  \n  lstFields.add(Field.make(\"Pipe_ID\", fldPipeID.getType, fldPipeID.getWidth, fldPipeID.getPrecision))\n  ls
tFields.add(Field.make(\"DN\", #FIELD_SHORT, 4, 0))\n  lstFields.add(Field.make(\"I\", #FIELD_DECIMAL, 16, 10))\n  lstFields.add(Field.make(\"roughness\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"Popul\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"f_peak\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"flow\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"max_flow\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"v_full\", #FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"v_free\", 
#FIELD_DECIMAL, 16, 8))\n  lstFields.add(Field.make(\"used\", #FIELD_DECIMAL, 16, 8))\n\n  vtbCalc.addFields(lstFields)\n  \n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n'calculation data\n \n 'give the user a chance to kill script\n av.showStopButton \n  \n  numLitersPerDayAndPerson = strLitersPerDayAndPerson.asNumber\n  \n'run over all records in the table\n  for each recLine in ftbLine\n    strRowNumber = (numCounter+3).asString.Trim\n    strRow=\"R\"+strRowNumber\n  \n    recCalc = vtbCa
lc.addRecord\n    \n    vtbCalc.setValue(lstFields.get(0), recCalc, ftbLine.returnValue(fldPipeID,recLine))     \n    numDiameter = ftbLine.returnValue(fldDiameter,recLine)\n    vtbCalc.setValue(lstFields.get(1), recCalc, numDiameter)    ' B\n    numGradient = ftbLine.returnValue(fldGradient,recLine)\n    vtbCalc.setValue(lstFields.get(2), recCalc, numGradient)    ' C\n    numRoughness = ftbLine.returnValue(fldRoughness,recLine)\n    vtbCalc.setValue(lstFields.get(3), recCalc, numRoughness)   ' D\n    numPopulation 
= ftbLine.returnValue(fldPopulation,recLine)\n    vtbCalc.setValue(lstFields.get(4), recCalc, numPopulation)  ' E\n    \n    ' peak factor calculation\n    strPeakFactor= strPeakFactorFormula\n    if(strPeakFactorFormula = \"BABITT\")then\n      numPeakFactor = 4.5.min(5/((numPopulation/1000)^(1/6)))\n    else \n      if(strPeakFactorFormula = \"BAUMANN\")then\n        numPeakFactor = 2.5.min(1+(14/(4+((numPopulation/1000).sqrt))))\n      else\n        numPeakFactor = strPeakFactorFormula.asNumber\n      end\n    end\n    vt
bCalc.setValue(lstFields.get(5), recCalc, numPeakFactor)                        ' F\n    \n'    sheet.poke(strRow+\"C7\", ftbLine.returnValue(fldFlow,recLine))       ' G\n'    sheet.poke(strRow+\"C7\", \"=E\"+strRowNumber+\"*F\"+strRowNumber+\"*\"+strLitersPerDayAndPerson+\"/3600/24\")\n    numFlow = numPopulation*numPeakFactor*numLitersPerDayAndPerson/3600/24\n    vtbCalc.setValue(lstFields.get(6), recCalc, numFlow)\n'    sheet.poke(strRow+\"C9\", \"=-2*LOG10(2.51*1.31/(1000000*numDiameter/1000)* ((2*9.80665*(B\"+strRowNumber+\"
/1000)*C\"+strRowNumber+\").sqrt))+D\"+strRowNumber+\"/(1000*3.71*(B\"+strRowNumber+\"/1000)))*SQRT(2*9.80665*(B\"+strRowNumber+\"/1000)*C\"+strRowNumber+\")\")    \n    numSquareRoot2 = (2*9.81*numDiameter/1000*numGradient).sqrt\n    numVelocityFullboard = -2*(((2.51*1.31/(1000000*numDiameter/1000)*((2*9.80665*(numDiameter/1000)*numGradient)).sqrt)+(numRoughness/(1000*3.71*(numDiameter/1000)))).log(10))*numSquareRoot2\n    vtbCalc.setValue(lstFields.get(8), recCalc, numVelocityFullboard)\n'    sheet.poke(strRow+\"C8\", \"=I
\"+strRowNumber+\"*PI()*B\"+strRowNumber+\"^2/4000\")    \n    numFlowCapacity = numVelocityFullboard * Number.getPi * (numDiameter*numDiameter)/4000\n    vtbCalc.setValue(lstFields.get(7), recCalc, numFlowCapacity)\n\n    numPercentUsed = numFlow/numFlowCapacity*100\n    vtbCalc.setValue(lstFields.get(10), recCalc, numPercentUsed)\n\n    'sheet.poke(strRow+\"C10\", \"=((K\"+strRowNumber+\"/35)^0.305-0.0024*K\"+strRowNumber+\")*I\"+strRowNumber)    \n    numVelocityFreeSurface = (((numPercentUsed/35)^0.305)-(0.0024*numPercentUs
ed))*numVelocityFullboard\n    vtbCalc.setValue(lstFields.get(9), recCalc, numVelocityFreeSurface)\n\n    'sheet.poke(strRow+\"C11\", \"=G\"+strRowNumber+\"/H\"+strRowNumber+\"*100\")    \n    \n    'update status display\n    if(av.setStatus((numCounter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n  \n  vtbCalc.setEditable(false) \n\n ' join Results to table\n ftbLine.unjoinAll\n ftbLine.join(fldPipeID, vtbCalc, lstFields.get(0))\n \n 'clean up\n av.clearStatus"
	FontSize:	1
)

(DocWin.39
	Owner:	38
	X:	14
	Y:	153
	W:	1573
	H:	538
)

(CSMgr.40
)

(DocAct.41
	Doc:	38
)

(SEd.42
	Name:	"DCSewerDesign.createXlsSewerCalculation"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:00:32 AM"
	GUIName:	"Script"
	Win:	43
	CSMgr:	44
	DocExts:	45
	Source:	"'DCSewerDesign.createXlsSewerCalculation\n'Create an Excel table containing the Sewerage Calculation\n'(c) 2000 DORSCH Consult\n \n'information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"PipeID=???    Diameter=???\"+NL+\n  \"Gradient=???    Roughness=???\"+NL+\n  \"AccumulatedPopulation=???   PeakFactor=???\"\n  ,\"Field Configuration File\")\n  \n'get the configuration file\n  lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"Select Configuration File\",0
)\n if(lstConfFiles.count = 0 )then\n   exit\n end\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n 'open the configuration file\n lnfConfiguration = LineFile.make(lstConfFiles.get(0), #FILE_PERM_READ)\n\n fldPipeID=nil\n fldDiameter=nil\n fldGradient=nil
\n fldRoughness=nil\n fldPopulation=nil\n strPeakFactorFormula=\"1\"\n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"pipeid\")then\n        fldPipeID=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"diameter\")then\n    
    fldDiameter=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"gradient\")then\n        fldGradient=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"roughness\")then\n        fldRoughness=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"accumulatedpopulation\")then\n        fldPopulation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"peakfactor\")then\n        if(strTableFieldName.isNumber)then\n  
        strPeakFactorFormula=strTableFieldName\n        else\n          if(strTableFieldName.ucase =\"BAUMANN\")then\n            strPeakFactorFormula = \"min(2.5; 1+14/(4+SQRT((E/1000))))\"\n          elseif(strTableFieldName.ucase = \"BABITT\")then\n            strPeakFactorFormula = \"min(4.5; 5/(E/1000)^(1/6))\"\n          else\n            Msgbox.info(\"Unknown Peak Factor Formula.\"+NL+\n            \"Baumann and Babitt are valid.\"+NL+\n            \"Using constant peak factor 1.\",\"DC Sewer Design\")\n          end\n        
end\n      end\n    end\n    strLine = lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n \n 'get information\n strLitersPerDayAndPerson = MsgBox.input(\"Sewage flow per person and day\",\"DC Sewer Design\",\"120\")\n if(strLitersPerDayAndPerson = nil)then\n   exit\n end\n \n 'check if configuration was successful\n  if((fldPipeID=nil)or(fldDiameter=nil)or(fldGradient=nil)or(fldRoughness=nil)\n  or(fldPopulation=nil))then\n    MsgBox.error(\"Field matching not successful. Check your table a
nd configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n\n 'start Excel, establish a DDE connection\n  system.execute(\"c:\\program files\\msoffice\\office\\excel.exe\") \n  sysClient = DDEClient.Make( \"Excel\",\"System\") \n  if (sysClient.HasError) then \n    MsgBox.error( sysClient.GetErrorMsg, \"\") \n    exit \n  end \n\n  fulltopic = sysClient.Request(\"selection\") 'returns [BookN]SheetN!RnCn:RnCn \n\n  sysClient.Close \n  topiclist=fulltopic.AsTokens(\"!:\") \n  \n  sheetname = topiclist.get(0)  \n  \n 'connect again\n sheet = D
DEClient.Make( \"Excel\", sheetname ) \n  \n'msgbox.info(sheet.request(\"NAME\"),\"info\")\n\n'write the table header\n sheet.poke(\"R1C1\", \"Pipe ID\")\n sheet.poke(\"R2C1\", \"String\")\n sheet.poke(\"R1C2\", \"Diameter DN\")\n sheet.poke(\"R2C2\", \"mm\")\n sheet.poke(\"R1C3\", \"Gradient I\")\n sheet.poke(\"R2C3\", \" - \")\n sheet.poke(\"R1C4\", \"Roughness kb\")\n sheet.poke(\"R2C4\", \"mm\")\n sheet.poke(\"R1C5\", \"Population\")\n sheet.poke(\"R2C5\", \"person\")\n sheet.poke(\"R1C6\", \"Peak Factor\")\n sheet.poke(\"R2C6\", \" - \")\n sheet.poke(\"R1C7\", \"Actual Flow\"
)\n sheet.poke(\"R2C7\", \"l/s\")\n sheet.poke(\"R1C8\", \"Flow Capacity\")\n sheet.poke(\"R2C8\", \"l/s\")\n sheet.poke(\"R1C9\", \"Fullboard Velocity\")\n sheet.poke(\"R2C9\", \"m/s\")\n sheet.poke(\"R1C10\", \"Free Surface Velocity\")\n sheet.poke(\"R2C10\", \"m/s\")\n sheet.poke(\"R1C11\", \"Percent used\")\n sheet.poke(\"R2C11\", \" % \")\n\n\n'data for status display\n  numCounter = 0 \n  numTotal = ftbLine.GetNumRecords \n  \n'calculation data\n \n 'give the user a chance to kill script\n av.showStopButton \n  \n'run over all records in the table\n  for eac
h recLine in ftbLine\n    strRowNumber = (numCounter+3).asString.Trim\n    strRow=\"R\"+strRowNumber\n    \n    sheet.poke(strRow+\"C1\", ftbLine.returnValue(fldPipeID,recLine))      ' A\n    sheet.poke(strRow+\"C2\", ftbLine.returnValue(fldDiameter,recLine))    ' B\n    sheet.poke(strRow+\"C3\", ftbLine.returnValue(fldGradient,recLine))    ' C\n    sheet.poke(strRow+\"C4\", ftbLine.returnValue(fldRoughness,recLine))   ' D\n    sheet.poke(strRow+\"C5\", ftbLine.returnValue(fldPopulation,recLine))  ' E\n    \n    ' peak factor ca
lculation\n    strPeakFactor= strPeakFactorFormula\n    if(strPeakFactor.isNumber.not)then\n      strPeakFactor = strPeakFactor.asTokens(\"E\").get(0) +\"E\"+ strRowNumber+strPeakFactor.asTokens(\"E\").get(1)\n    end\n    sheet.poke(strRow+\"C6\", \"=\"+strPeakFactor)                               ' F\n    \n'    sheet.poke(strRow+\"C7\", ftbLine.returnValue(fldFlow,recLine))       ' G\n    sheet.poke(strRow+\"C7\", \"=E\"+strRowNumber+\"*F\"+strRowNumber+\"*\"+strLitersPerDayAndPerson+\"/3600/24\") 'G\n    sheet.poke(strRow+\"C8\", \"=I\"+
strRowNumber+\"*PI()*B\"+strRowNumber+\"^2/4000\")    'H\n    sheet.poke(strRow+\"C9\", \"=-2*LOG10(2.51*1.31/(1000000* (B\"+strRowNumber+\"/1000) *SQRT(2*9.80665* (B\"+strRowNumber+\"/1000) *C\"+strRowNumber+\"))+D\"+strRowNumber+\"/(1000*3.71*(B\"+strRowNumber+\"/1000)))*SQRT(2*9.80665*(B\"+strRowNumber+\"/1000)*C\"+strRowNumber+\")\")    'I\n    sheet.poke(strRow+\"C10\", \"=((K\"+strRowNumber+\"/35)^0.305-0.0024*K\"+strRowNumber+\")*I\"+strRowNumber)    'J\n    sheet.poke(strRow+\"C11\", \"=G\"+strRowNumber+\"/H\"+strRowNumber+\"*100\")    'K\n
    \n    'update status display\n    if(av.setStatus((numCounter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n \n 'close the DDE connection\n sheet.close    \n \n 'clean up\n av.clearStatus"
	FontSize:	1
)

(DocWin.43
	Owner:	42
	X:	19
	Y:	549
	W:	1547
	H:	365
)

(CSMgr.44
)

(DocAct.45
	Doc:	42
)

(SEd.46
	Name:	"DCSewerDesign.enforceDrainage"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 29. Juni 2004 15:38:51"
	GUIName:	"Script"
	Win:	47
	CSMgr:	48
	DocExts:	49
	Source:	"' DCSewerDesign.EnforceDrainage\n\n' (c) 2004 DORSCH Consult\n\n' trace downstream and make sure that flow can reach next section\n' If upstream invert of downstream section > downstream invert,\n' move downstream section down\n' connecting lines with different diameters will have different invert levels\n  \nviewActive = av.GetActiveDoc\nthemeList = viewActive.GetThemes\nlstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\nLineTheme = Msgbox.Choice (lstLineThemes, \"Select a Polyline Theme.\", 
\"Select a Theme\") \nif (LineTheme.asString = \"nil\") then\n  exit\nend\nthmLine = viewActive.FindTheme(LineTheme.AsString)\nftbLine = thmLine.GetFTab \n\n' information about the configuration file\nMsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"MaxUpstream=??? MaxDownstream=???\"+NL+\n  \"DesDownstream=???, DesUpstream=???, (optional) Diameter=???\"+NL+\n  \"DesDownstream and DesUpstream will be overwritten\"\n  ,\"Field Configuration File\")\n\n\nlstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"
},\"Select Configuration File\",0)\nif(lstConfFiles.count = 0 )then\n  exit\nend\nstrConfigurationFile = lstConfFiles.get(0).asString\n\nfldMaxUpstream = nil\nfldMaxDownstream = nil\nfldDesUpstream = nil\nfldDesDownstream = nil\nfldDiameter = nil\n\n' Read configuration file\nlnfConfiguration = LineFile.make(strConfigurationFile.asFilename, #FILE_PERM_READ)\nstrLine=lnfConfiguration.readElt\nwhile (not (strLine=nil ))\n  lstConfTokens = strLine.asTokens(\"=\")\n  if(lstConfTokens.count=2)then\n    strScriptFieldName = lstConfTok
ens.get(0).trim.lcase\n    strTableFieldName = lstConfTokens.get(1).trim.lcase\n    if(strScriptFieldName = \"MaxUpstream\")then\n      fldMaxUpstream=ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"MaxDownstream\")then\n      fldMaxDownstream=ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"DesUpstream\")then\n      fldDesUpstream = ftbLine.findField(strTableFieldName)\n    end\n    if(strScriptFieldName = \"DesDownstream\")then\n      fldDesDownstream = ftbLine.findFie
ld(strTableFieldName)\n    end\n    if(strScriptFieldName = \"Diameter\")then\n      fldDiameter = ftbLine.findField(strTableFieldName)\n    end\n  end\n  strLine = lnfConfiguration.readElt\nend\nlnfConfiguration.close\n\nftbLine.setEditable(true)\n\n' set design invert levels to 0\n\nfor each recLine in ftbLine\n  ftbLine.setValue(fldDesDownstream, recLine, 0)\n  ftbLine.setValue(fldDesUpstream, recLine, 0)\nend\n\n' The queue of lines for which the connections will be searched\nstkQueue = Stack.make\n\nnumCounter = 0\n\nnumTotal =
 ftbLine.getNumRecords\nav.showStopButton\n  \n' run over all records in the table, find lines where all upstream information is defined\nwhile(numCounter < numTotal)\n  numOldCounter = numCounter\n  for each recLine in ftbLine\n    numDesDownstream = ftbLine.returnValue(fldDesDownstream, recLine)\n    if(numDesDownstream = 0)then\n      ' check if line has upstream lines\n      lstUpstream = av.run(\"DCSewerDesign.Line.findUpstreamLines\", {ftbLine, recLine})\n      blnReady = true\n      numMinUpstream = 1000000\n      
for each recUpstream in lstUpstream\n        numUpstream = ftbLine.returnValue(fldDesDownstream, recUpstream)\n        if(numUpstream = 0)then\n          blnReady = false\n          break\n        else\n          numDiameter = 0\n          if(fldDiameter <> nil)then\n            numDiameter = ftbLine.returnValue(fldDiameter, recUpstream)\n          end\n          numMinUpstream = numMinUpstream.min(numUpstream+(numDiameter/1000))\n        end\n      end\n      if(blnReady)then\n        numMaxUpstream = ftbLine.returnValu
e(fldMaxUpstream, recLine)\n        numMaxDownstream = ftbLine.returnValue(fldMaxDownstream, recLine)\n        if(numMinUpstream = 1000000)then\n          ftbLine.setValue(fldDesUpstream, recLine, numMaxUpstream)\n          ftbLine.setValue(fldDesDownstream, recLine, numMaxDownstream)\n        else\n          numDiameter = 0\n          if(fldDiameter <> nil)then\n            numDiameter = ftbLine.returnValue(fldDiameter, recLine)\n          end\n          numShift = numMaxUpstream - (numMaxUpstream.min(numMinUpstream
 - (numDiameter/1000))) \n          ftbLine.setValue(fldDesDownstream, recLine, numMaxDownstream-numShift)\n          ftbLine.setValue(fldDesUpstream, recLine, numMaxUpstream-numShift)\n        end\n        numCounter = numCounter+1\n       end\n     end\n  end\n  ' update status display\n       if(av.setStatus((numCounter/numTotal)*100).not)then\n        ' user hit the stop button\n         exit\n       end\n  if(numCounter = numOldCounter)then\n    Msgbox.info(\"Loop run did not improve result. System might not be fully
 connected.\", \"DC Sewer Design\")\n    exit\n  end\nend\n \nftbLine.setEditable(false)\nav.clearStatus"
	FontSize:	1
)

(DocWin.47
	Owner:	46
	W:	801
	H:	533
)

(CSMgr.48
)

(DocAct.49
	Doc:	46
)

(SEd.50
	Name:	"DCSewerDesign.exportBasysFile"
	Creator:	"sdteffen"
	CreationDate:	"Sunday, March 12, 2000 08:49:09"
	GUIName:	"Script"
	Win:	51
	CSMgr:	52
	DocExts:	53
	Source:	"' DCSewerDesign.exportBaSysFile\n' (c) 2000 DORSCH Consult\n\n'information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"LineID=???   Length=???  Diameter=??? FromX=???\"+NL+\n  \"FromY=???  ToX=???    ToY=???    Flow=????\"+NL+\n  \"UpstreamInvertLevel=???   DownstreamInvertLevel=???\"\n  ,\"Field Configuration File\")\n  \n'get the configuration file\n  lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"Select Configuration File\",0)\n if(lstConfFiles.count 
= 0 )then\n   exit\n end\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n\n 'open the configuration file\n lnfConfiguration = LineFile.make(lstConfFiles.get(0), #FILE_PERM_READ)\n\n fldLength=nil\n fldDiameter=nil\n fldFromX=nil\n fldFromY=nil\n fldToX=nil\n 
fldToY=nil\n fldFlow=nil\n fldUpstreamElevation=nil\n fldDownstreamElevation=nil\n fldLineID=nil\n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"length\")then\n        fldLength=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFie
ldName = \"diameter\")then\n        fldDiameter=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"fromx\")then\n        fldFromX=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"fromy\")then\n        fldFromY = ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"tox\")then\n        fldToX=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"toy\")then\n        fldToY=ftbLine.findField(strTableFieldName)\n      en
d\n      if(strScriptFieldName = \"flow\")then\n        fldFlow=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"upstreaminvertlevel\")then\n        fldUpstreamElevation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"downstreaminvertlevel\")then\n        fldDownstreamElevation=ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"lineid\")then\n        fldLineID=ftbLine.findField(strTableFieldName)\n      end\n    end    \n    strLine = 
lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n  \n 'check if configuration was successful\n  if((fldLength=nil)or(fldDiameter=nil)or(fldFromX=nil)or(fldFromY=nil)or(fldLineID=nil)\n  or(fldToX=nil)or(fldToY=nil)or(fldFlow=nil)or(fldUpstreamElevation=0)or(fldDownstreamElevation=nil))then\n    MsgBox.error(\"Field matching not successful. Check your table and configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n \n flnOutputFile = FileDialog.put(\"basysfile.txt\".asFilename,
\"*.txt\", \"Create BaSys File\")\n if(flnOutputFile = nil )then\n   exit\n end\n\n  av.showStopButton\n  numCounter=0\n  numTotal = ftbLine.getNumRecords\n\n lnfOutput = LineFile.make(flnOutputFile, #FILE_PERM_WRITE)\n\n' run over all records in the table\n  for each recLine in ftbLine\n  strLine = ftbLine.returnValue(fldLineID,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldLength,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldDiameter,recLine).asString+\",\"\n  strLine = strLine + ftbL
ine.returnValue(fldFromX,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldFromY,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldToX,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldToY,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldFlow,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldUpstreamElevation,recLine).asString+\",\"\n  strLine = strLine + ftbLine.returnValue(fldDownstreamElevation,recLine).asString\n  lnfOutpu
t.writeElt(strLine)\n    \n    'update status display\n    if(av.setStatus((numCounter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n \n \n 'clean up\n lnfOutput.close\n av.clearStatus"
	FontSize:	1
)

(DocWin.51
	Owner:	50
	X:	-4
	Y:	-4
	W:	1038
	H:	675
)

(CSMgr.52
)

(DocAct.53
	Doc:	50
)

(SEd.54
	Name:	"DCSewerDesign.Fields.returnNumberFields"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 08. Juni 2000 12:16:18"
	GUIName:	"Script"
	Win:	55
	CSMgr:	56
	DocExts:	57
	Source:	"' DCSewerDesign.Fields.returnNumberFields\n\n' expects a list of fields as the argument,\n' returns a list with all the numerical fields contained\n' in that list\n\n' (c) 2000 DORSCH Consult\n\nlstFields = self\nlstNumberFields = List.make\nfor each fldCheck in lstFields\n  if(fldCheck.isTypeNumber)then\n    lstNumberFields.add(fldCheck)\n  end\nend   \n\nreturn lstNumberFields.clone"
	FontSize:	1
)

(DocWin.55
	Owner:	54
	X:	20
	Y:	20
	W:	1245
	H:	328
)

(CSMgr.56
)

(DocAct.57
	Doc:	54
)

(SEd.58
	Name:	"DCSewerDesign.flipLinesToFlowDirection"
	Creator:	"sdteffen"
	CreationDate:	"Sunday, February 27, 2000 12:28:44 PM"
	GUIName:	"Script"
	Win:	59
	CSMgr:	60
	DocExts:	61
	Source:	"' DCSewerDesign.flipLinesToFlowDirection\n' (c) 2000 DORSCH Consult\n\n' runs over all the lines of a Sewer Theme and makes sure that they're all\n' running from the upstream point to the downstream point\n\n\n' get the table\n viewActive = av.GetActiveDoc\n themeList = viewActive.GetThemes\n LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\") \n if (LineTheme.asString = \"nil\") then\n    exit\n end\n thmLine = viewActive.FindTheme(LineTheme.AsString)\n ftbLine = thmLine.GetFTab\n \n 'get the 
elevation fields\n lstFields = thmLine.getFTab.getFields\n fldDownstreamElevation = Msgbox.choice(lstFields, \"Select the Downstream Elevation Field.\",\"Select a Field\")\n if(fldDownstreamElevation.asString = \"nil\")then\n  exit\n end\n' fldUpstreamElevation = Msgbox.choice(lstFields, \"Select the Upstream Elevation Field.\",\"Select a Field\")\n 'if(fldUpstreamElevation.asString = \"nil\")then\n ' exit\n 'end\n\n fldShape = ftbLine.findField(\"Shape\")\n  \n 'data for status display\n numCounter = 0 \n numTotal = ftbLine.GetNumReco
rds\n numFlipCount = 0\n bmpFlipped = Bitmap.make(numTotal)\n bmpFlipped.clearAll\n \n'give the user a chance to kill script\n av.showStopButton \n ftbLine.setEditable(true)\n  \n'run over all lines\n  for each recLine in ftbLine\n   lstConnectedLines = av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine, recLine})\n   numDownstreamElevation = ftbLine.returnValue(fldDownstreamElevation, recLine)\n   pllLine = ftbLine.returnValue(fldShape, recLine)\n   pntStart = pllLine.asList.get(0).get(0)\n   \n   blnPntIsUpstream = 
true\n   if(lstConnectedLines.count = 0)then\n     Msgbox.info(\"No connected Lines\",\"DC Sewer Design\")\n   end\n   for each recConnectedLine in lstConnectedLines\n     pllConnectedLine = ftbLine.returnValue(fldShape, recConnectedLine)\n     if(ftbLine.returnValue(fldDownstreamElevation,recConnectedLine) < numDownstreamElevation )then   \n       blnPntIsUpstream = false\n       break\n     end\n   end\n \n   if(blnPntIsUpstream)then\n     'connected line is upstream of recLine, Connection Point is upstream manhole\n     \n
    'check for correct snapping\n     if(pllLine.PointIntersection(pllConnectedLine).asList.count=0)then\n       msgbox.info(\"No Intersection.\",\"DC Sewer Design\")\n       av.clearStatus\n       bmpFlipped.clearAll\n       bmpFlipped.set(recLine)\n       ftbLine.setSelection(bmpFlipped)\n     end\n     \n     pntUpstreamManhole = pllLine.PointIntersection(pllConnectedLine).asList.get(0)\n     if(pntStart.intersects(pntUpstreamManhole).not)then\n       ftbLine.setValue(fldShape, recLine, pllLine.clone.flip)\n       numFl
ipCount = numFlipCount+1\n       bmpFlipped.set(recLine)\n     end\n   else\n    'connected Line downstream, Connection Point downstream manhole\n\n     'check for correct snapping\n     if(pllLine.PointIntersection(pllConnectedLine).asList.count=0)then\n       msgbox.info(\"No Intersection\",\"DC Sewer Design\")\n       av.clearStatus\n       bmpFlipped.clearAll\n       bmpFlipped.set(recLine)\n       ftbLine.setSelection(bmpFlipped)\n     end\n     \n     pntDownstreamManhole = pllLine.PointIntersection(pllConnectedLine).as
List.get(0)\n     \n     if(pntStart.intersects(pntDownstreamManhole))then\n       ftbLine.setValue(fldShape, recLine, pllLine.clone.flip)\n       numFlipCount = numFlipCount+1\n       bmpFlipped.set(recLine)\n     end\n   end\n   \n   'update status display\n   numCounter = NumCounter+1\n   if(av.setStatus((numCounter/numTotal)*100).not)then\n    'user hit the stop button\n     exit\n   end\n\n  end \n\nftbLine.setEditable(false)\nav.clearStatus\nMsgBox.info(\"Flipped \"+numFlipCount.asString+\" Lines.\",\"DC Sewer Design\")\nftbLin
e.setSelection(bmpFlipped)"
	FontSize:	1
)

(DocWin.59
	Owner:	58
	X:	564
	Y:	151
	W:	1034
	H:	643
)

(CSMgr.60
)

(DocAct.61
	Doc:	58
)

(SEd.62
	Name:	"DCSewerDesign.Help.openCHM"
	Creator:	"sdteffen"
	CreationDate:	"Montag, 01. März 2004 20:30:53"
	GUIName:	"Script"
	Win:	63
	CSMgr:	64
	DocExts:	65
	Source:	"' DCSewerDesign.Help.openCHM\n\n' (c) 2004 DORSCH Consult\n\n\nsystem.execute(\"hh.exe\".quote++\"$AVHOME\\HELP\\dcsewerdesign.chm\".asFilename.getFullName.quote)"
	FontSize:	1
)

(DocWin.63
	Owner:	62
	X:	801
	W:	801
	H:	533
)

(CSMgr.64
)

(DocAct.65
	Doc:	62
)

(SEd.66
	Name:	"DCSewerDesign.i18n.returnTranslation"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 25. Mai 2000 15:54:04"
	GUIName:	"Script"
	Win:	67
	CSMgr:	68
	DocExts:	69
	Source:	"' DCSewerDesign.i18n.returnTranslation\n\n' argument 1: strToBeTranslated ( in English ) \n' the Translation will be done through the dictionaries\n\n' (c) 2000 DORSCH Consult\n\n' NOTE: right now this is a dummy functions that returns argument 1\n\nreturn self"
	FontSize:	1
)

(DocWin.67
	Owner:	66
	X:	293
	Y:	326
	W:	712
	H:	426
)

(CSMgr.68
)

(DocAct.69
	Doc:	66
)

(SEd.70
	Name:	"DCSewerDesign.Line.findConnectedLines"
	Creator:	"sdteffem"
	CreationDate:	"Saturday, February 26, 2000 10:01:23 AM"
	GUIName:	"Script"
	Win:	71
	CSMgr:	72
	DocExts:	73
	Source:	"' DCSewerDesign.Line.findConnectedLines\n' Arguments: The Line FTab and a record in it\n' Returns the records of all Lines that are connected to the Line\n' 0.1 m snapping interval\n' (c) 2000 DORSCH Consult\n\nftb_Lines = self.get(0)\nrec_Line = self.get(1)\n\nfna_LineShape = ftb_Lines.findField(\"Shape\")\n\n  pll_Line = ftb_Lines.returnValue(fna_LineShape, rec_Line)\n\n  'increases the speed, because it uses ArcView's spatial index\n  ftb_Lines.selectByPolyline(pll_Line, #VTAB_SELTYPE_NEW) \n\n  lst_LineNodes = pll_Line.a
sList.get(0)\n  pnt_Start = lst_LineNodes.get(0)\n  pnt_End = lst_LineNodes.get(lst_LineNodes.count -1 )\n\nlst_Lines = List.make\nbmp_Lines = ftb_Lines.getSelection\nbmp_Lines.clear(rec_Line)\n\n\n'second run is necessary because selectByPolyline returns also Lines that\n'cross the Line rather than start at it\nlstUpstream = List.make\nlstDownstream = List.make\nfor each rec_ConnectedLine in bmp_Lines\n  pll_Line = ftb_Lines.returnValue(fna_LineShape, rec_ConnectedLine)\n  lst_LineNodes = pll_Line.asList.get(0)\n  \n'  pnt
_StartLine = lst_LineNodes.get(0)\n'  pnt_EndLine = lst_LineNodes.get(lst_LineNodes.count -1 )\n ' num_LastNode = lst_LineNodes.count-1\n  for each i in {0, 100}\n    if(pnt_Start.distance(pll_Line.along(i)) < 0.1) then\n      lstUpstream.add(rec_ConnectedLine.clone)\n    elseif(pnt_End.distance(pll_Line.along(i)) < 0.1) then\n      lstUpstream.add(rec_ConnectedLine.clone)\n    end\n  end\nend\nlst_Lines = lstUpstream+lstDownstream\nreturn lst_Lines.deepclone"
	FontSize:	1
)

(DocWin.71
	Owner:	70
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.72
)

(DocAct.73
	Doc:	70
)

(SEd.74
	Name:	"DCSewerDesign.Line.findManholes"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 26. Mai 2000 10:13:31"
	GUIName:	"Script"
	Win:	75
	CSMgr:	76
	DocExts:	77
	Source:	"' DCSewerDesign.Line.findManholes\n' Arguments: The Line FTab, the Manhole FTab and a record in the line ftab\n' Returns the records of all Manholes that are connected to the Line\n\n' (c) 2000 DORSCH Consult\n\nftb_Lines = self.get(0)\nftbManholes = self.get(1)\nrec_Line = self.get(2)\n\nfna_LineShape = ftb_Lines.findField(\"Shape\")\n\npll_Line = ftb_Lines.returnValue(fna_LineShape, rec_Line)\n\nlstManholes = List.make\n\nfor each i in {0,100}\n  pntManhole = pll_Line.along(i)\n  ftbManholes.selectByPoint(pntManhole, 0.1, #V
TAB_SELTYPE_NEW)\n  bmpManholes = ftbManholes.getSelection\n  for each recManhole in bmpManholes\n    lstManholes.add(recManhole.clone)\n  end\nend\nreturn lstManholes.deepclone"
	FontSize:	1
)

(DocWin.75
	Owner:	74
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.76
)

(DocAct.77
	Doc:	74
)

(SEd.78
	Name:	"DCSewerDesign.Line.findUpstreamLines"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 29. Juni 2004 16:02:23"
	GUIName:	"Script"
	Win:	79
	CSMgr:	80
	DocExts:	81
	Source:	"' DCSewerDesign.Line.findUpstreamLines\n' Arguments: The Line FTab and a record in it\n' Returns the records of all Lines that are connected to the Line\n' 0.1 m snapping interval\n' (c) 2000,2004 DORSCH Consult\n\nftb_Lines = self.get(0)\nrec_Line = self.get(1)\n\nfna_LineShape = ftb_Lines.findField(\"Shape\")\n\npll_Line = ftb_Lines.returnValue(fna_LineShape, rec_Line)\n\n'increases the speed, because it uses ArcView's spatial index\nftb_Lines.selectByPolyline(pll_Line, #VTAB_SELTYPE_NEW) \n\npnt_Start = pll_Line.along(0)\n
\nlst_Lines = List.make\nbmp_Lines = ftb_Lines.getSelection\nbmp_Lines.clear(rec_Line)\n\n' second run is necessary because selectByPolyline returns also Lines that\n' cross the Line rather than start at it\nlstUpstream = List.make\nfor each rec_ConnectedLine in bmp_Lines\n  pll_Line = ftb_Lines.returnValue(fna_LineShape, rec_ConnectedLine)\n  if(pnt_Start.distance(pll_Line.along(100)) < 0.1) then\n      lstUpstream.add(rec_ConnectedLine.clone)\n  end\nend\nreturn lstUpstream.deepclone"
	FontSize:	1
)

(DocWin.79
	Owner:	78
	X:	489
	Y:	456
	W:	928
	H:	484
)

(CSMgr.80
)

(DocAct.81
	Doc:	78
)

(SEd.82
	Name:	"DCSewerDesign.Lines.takeoverManholeData"
	Creator:	"sdteffen"
	CreationDate:	"Sonntag, 28. Mai 2000 20:04:04"
	GUIName:	"Script"
	Win:	83
	CSMgr:	84
	DocExts:	85
	Source:	"' DCSewerDesign.Lines.takeoverManholeData\n\n' lets the Lines take over data for the upstream and downstream\n' manholes\n' REQUIRES that the lines are flipped to flow direction\n\n' (c) 2000,2004 DORSCH Consult\n\n  Msgbox.info(\"Make sure that the lines are flipped to flow direction.\", \"DC Sewer Design\")\n\n'get the line table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  thmLine = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (thmLine.asString = \"nil\") then\n
    exit\n  end\n  ftbLine = thmLine.GetFTab \n\n'get the manhole table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  thmManhole = Msgbox.Choice (themeList, \"Select a Point Theme.\", \"Select a Theme\")   \n  if (thmManhole.asString = \"nil\") then\n    exit\n  end\n  ftbManhole = thmManhole.GetFTab \n\n ' get the manhole data field\n lstManholeFields = ftbManhole.getFields.clone\n lstManholeFields.remove(0)\n fldManholeData = Msgbox.choice(lstManholeFields, \"Select the Manhole Data Field.\",\"Select a 
Field\")\n if(fldManholeData.asString = \"nil\")then\n  exit\n end\n\n ' get the upstream and downstream data field\n lstLineFields = ftbLine.getFields.clone\n lstLineFields.remove(0)\n fldUpstreamData = Msgbox.choice(lstLineFields, \"Select the Upstream Data Field.\",\"Select a Field\")\n if(fldUpstreamData.asString = \"nil\")then\n  exit\n end\n\n if(fldUpstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Upstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldDownstreamData = M
sgbox.choice(lstLineFields, \"Select the Downstream Data Field.\",\"Select a Field\")\n if(fldDownstreamData.asString = \"nil\")then\n  exit\n end\n\n if(fldDownstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Downstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldLineShape = ftbLine.findField(\"Shape\") \n ftbLine.setEditable(true)\n numTotal = ftbLine.getNumRecords\n numComplete = 0\n av.showStopButton\n  \n for each recLine in ftbLine\n   pllLine = ftbLine.returnValue(fl
dLineShape, recLine)\n   pntUpstream = pllLine.asList.get(0).get(0)\n   lstLine = pllLine.asList\n   if(lstLine.count > 1)then\n     System.echo(\"Error: Multipart polylines are not allowed.\")\n   else\n     lstLine = lstLine.get(0)\n     pntDownstream = lstLine.get(lstLine.count-1)\n    \n     ftbManhole.selectByPoint(pntUpstream, 0.1, #VTAB_SELTYPE_NEW) \n     bmpManholes = ftbManhole.getSelection\n     for each recManhole in bmpManholes\n       recUpstream = recManhole\n     end\n     objUpstream = ftbManhole.returnVal
ue(fldManholeData, recUpstream)\n     ftbLine.setValue(fldUpstreamData, recLine, objUpstream)\n     \n     ftbManhole.selectByPoint(pntDownstream, 0.1, #VTAB_SELTYPE_NEW) \n     bmpManholes = ftbManhole.getSelection\n     for each recManhole in bmpManholes\n       recDownstream = recManhole\n     end\n     objDownstream = ftbManhole.returnValue(fldManholeData, recDownstream)\n     ftbLine.setValue(fldDownstreamData, recLine, objDownstream)\n   end\n   ' update status display   \n   numComplete = numComplete + 1\n   if(a
v.setStatus((numComplete/numTotal)*100).not)then\n     'user hit the stop button\n     exit\n   end\n end   \n \n ftbLine.setEditable(false)\n av.clearStatus"
	FontSize:	1
)

(DocWin.83
	Owner:	82
	X:	190
	Y:	-9
	W:	1290
	H:	899
)

(CSMgr.84
)

(DocAct.85
	Doc:	82
)

(SEd.86
	Name:	"DCSewerDesign.Lines.takeoverMinimumValuesFromBuffer"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 12:41:39"
	GUIName:	"Script"
	Win:	87
	CSMgr:	88
	DocExts:	89
	Source:	"' DCSewerDesign.Lines.takeoverMinimumValuesFromBuffer\n\n' (c) 2004 DORSCH Consult\n\n' create a buffer around the line and find the minimum\n' elevation from a point theme\n' requires pipe thene (polyline)\n' require spot elevation theme (point)\n\n'get the line table\nviewActive = av.GetActiveDoc \nthemeList = viewActive.GetThemes \nlstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\nthmLine = Msgbox.Choice (lstLineThemes, \"Select the Line Theme.\", \"DC Sewer Design\")   \nif (thmLine.asString 
= \"nil\") then\n  exit\nend\nftbLine = thmLine.GetFTab \n\n'get the  table\nviewActive = av.GetActiveDoc \nthemeList = viewActive.GetThemes \nlstPointThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\nthmPoint = Msgbox.Choice (lstpointThemes, \"Select the Point Theme.\", \"DC Sewer Design\")   \nif(thmPoint.asString = \"nil\") then\n  exit\nend\nftbPoint = thmPoint.GetFTab \n\n' get the point data field\nlstPointFields = ftbpoint.getFields.clone\nlstPointFields.remove(0)\nfldPointData = Msgbox.choice(lstpointF
ields, \"Select the Point Data Field.\",\"Select a Field\")\nif(fldPointData.asString = \"nil\")then\n  exit\nend\n\n' get the line data field\nlstLineFields = ftbLine.getFields.clone\nlstLineFields.remove(0)\nfldLineData = Msgbox.choice(lstLineFields, \"Select the Line Data Field.\",\"Select a Field\")\nif(fldLineData.asString = \"nil\")then\n  exit\nend\n\nif(fldLineData.getType <> fldpointData.getType)then\n Msgbox.info(\"Upstream Data Type doesn't match point Data Type\", \"DC Sewer Design\")\n exit\nend\n\nstrBufferDistance = MsgBox.in
put(\"Specify the Buffer Distance:\",\"DC Sewer Design\",\"5.0\")\nif((strBufferDistance.asString = \"nil\")or(strBufferDistance.isNumber.not))then\n  exit\nend\nnumBufferDistance = strBufferDistance.asNumber\n\nfldLineShape = ftbLine.findField(\"Shape\") \nfldPointShape = ftbpoint.findField(\"Shape\")\nftbLine.setEditable(true)\nnumTotal = ftbLine.getNumRecords\nnumComplete = 0\nav.showStopButton\n\nfor each recLine in ftbLine\n pllLine = ftbLine.returnValue(fldLineShape, recLine)\n plgnBuffer = pllLine.returnBuffered(numBufferDista
nce)\n ftbPoint.selectByPolygon(plgnBuffer, #VTAB_SELTYPE_NEW)\n numMinimumValue = Number.makeNull\n for each recPoint in ftbPoint.getSelection\n   numValue = ftbPoint.returnValue(fldPointData, recPoint)\n   if((numMinimumValue.isNull) or (numValue < numMinimumValue))then\n     numMinimumValue = numValue\n   end\n end\n ftbLine.setValue(fldLineData, recLine, numMinimumValue)\n \n ' update status display   \n numComplete = numComplete + 1\n if(av.setStatus((numComplete/numTotal)*100).not)then\n   'user hit the stop button
\n   exit\n end\nend   \n \nftbpoint.setEditable(false)\nav.clearStatus\n\n\n"
	SearchStr:	"manhole"
	FontSize:	1
)

(DocWin.87
	Owner:	86
	X:	5
	Y:	5
	W:	790
	H:	733
)

(CSMgr.88
)

(DocAct.89
	Doc:	86
)

(SEd.90
	Name:	"DCSewerDesign.Lines.validate"
	Creator:	"sdteffen"
	CreationDate:	"Thursday, March 23, 2000 09:26:45"
	GUIName:	"Script"
	Win:	91
	CSMgr:	92
	DocExts:	93
	Source:	"' DCSewerDesign.Lines.validate\n\n' checks if the lines only have one vertex\n\n' (c) 2000 DORSCH Consult\n\n'get the table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  LineTheme = Msgbox.Choice (themeList, \"Select a Polyline Theme.\", \"Select a Theme\")   \n  if (LineTheme.asString = \"nil\") then\n    exit\n  end\n  thmLine = viewActive.FindTheme(LineTheme.AsString)   \n  ftbLine = thmLine.GetFTab \n \n fldShape = ftbLine.findField(\"Shape\")\n \n 'data for status display\n  numCounter = 0 \n  numTotal 
= ftbLine.GetNumRecords \n  \n 'give the user a chance to kill script\n av.showStopButton \n  \nbmpInvalid = Bitmap.make(ftbLine.getNumRecords)\nbmpInvalid.clearAll\n    \n' run over all records in the table\n  for each recLine in ftbLine\n\n   ' get the Upstream Manhole\n    pllLine = ftbLine.returnValue(fldShape, recLine)\n    if((pllLine.asList.count <> 1)or(pllLine.asList.get(0).count <> 2)or(pllLine.returnLength < 1))then\n      bmpInvalid.set(recLine)\n    end\n\n    'update status display\n    if(av.setStatus((numCoun
ter/numTotal)*100).not)then\n      'user hit the stop button\n      exit\n    end\n    numCounter = numCounter+1\n  end\n\n  ftbLine.setSelection(bmpInvalid)\n  ftbLine.updateSelection\n  Msgbox.info(\"The Theme contains \"+bmpInvalid.count.asString+\" invalid features.\", \"DC Sewer Design\")\n  \n av.clearStatus"
	FontSize:	1
)

(DocWin.91
	Owner:	90
	X:	126
	Y:	151
	W:	1063
	H:	612
)

(CSMgr.92
)

(DocAct.93
	Doc:	90
)

(SEd.94
	Name:	"DCSewerDesign.List.flip"
	Creator:	"sdteffen"
	CreationDate:	"Samstag, 27. Mai 2000 17:42:13"
	GUIName:	"Script"
	Win:	95
	CSMgr:	96
	DocExts:	97
	Source:	"' DCSewerDesign.List.flip\n\n' returns the List given as argument in reverse order\n\n' (c) 2000 DORSCH Consult\n\nlstNormal = self\n\nlstFlip = List.make\n\nfor each i in (lstNormal.count-1)..0\n  lstFlip.add(lstNormal.get(i).clone)\nend\n\nreturn lstFlip.deepclone"
	FontSize:	1
)

(DocWin.95
	Owner:	94
	X:	18
	Y:	396
	W:	693
	H:	432
)

(CSMgr.96
)

(DocAct.97
	Doc:	94
)

(SEd.98
	Name:	"DCSewerDesign.Manhole.findDownstreamLine"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 08. November 2002 06:55:14"
	GUIName:	"Script"
	Win:	99
	CSMgr:	100
	DocExts:	101
	Source:	"' DCSewerDesign.Manhole.findDownstreamLine\n' Arguments: The Line FTab and a Point (at the location of the manhole)\n' Returns the record of the line downstream of the manhole\n\n' 0.1 map units snap tolerance\n\n' (c) 2000, 2002 DORSCH Consult\n\nftbLines = self.get(0)\npntManhole = self.get(1)\n\n'increases the speed, because it uses ArcView's spatial index\nftbLines.selectByPoint(pntManhole, 1.0, #VTAB_SELTYPE_NEW)\nbmpLines = ftbLines.getSelection\nlstLines = List.make\nfldLineShape = ftbLines\nfor each recConnectedLin
e in bmpLines\n  pllConnectedLine = ftbLines.returnValue(ftbLines.findField(\"Shape\"),recConnectedLine)\n  nLastVertex = pllConnectedLine.asList.get(0).count-1\n  if(pllConnectedLine.asList.get(0).get(0).distance(pntManhole) <= 0.1)then\n    return recConnectedLine\n  end\nend\n\nreturn nil"
	FontSize:	1
)

(DocWin.99
	Owner:	98
	X:	572
	Y:	307
	W:	870
	H:	420
)

(CSMgr.100
)

(DocAct.101
	Doc:	98
)

(SEd.102
	Name:	"DCSewerDesign.Manhole.findUpstreamLines"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, March 04, 2000 11:29:31 AM"
	GUIName:	"Script"
	Win:	103
	CSMgr:	104
	DocExts:	105
	Source:	"' DCSewerDesign.Manhole.findUpstreamLines\n' Arguments: The Line FTab and a Point (at the location of the manhole)\n' Returns the records of all Lines that are connected to the Line\n\n' 0.1 map units snap tolerance\n\n' (c) 2000, 2002 DORSCH Consult\n\nftbLines = self.get(0)\npntManhole = self.get(1)\n\n'increases the speed, because it uses ArcView's spatial index\nftbLines.selectByPoint(pntManhole, 1.0, #VTAB_SELTYPE_NEW)\nbmpLines = ftbLines.getSelection\nlstLines = List.make\nfldLineShape = ftbLines\nfor each recConnec
tedLine in bmpLines\n  pllConnectedLine = ftbLines.returnValue(ftbLines.findField(\"Shape\"),recConnectedLine)\n  nLastVertex = pllConnectedLine.asList.get(0).count-1\n  if(pllConnectedLine.asList.get(0).get(nLastVertex).distance(pntManhole) <= 0.1)then\n    lstLines.add(recConnectedLine.clone)\n  end\nend\n\nreturn lstLines.deepclone"
	FontSize:	1
)

(DocWin.103
	Owner:	102
	X:	606
	Y:	427
	W:	766
	H:	533
)

(CSMgr.104
)

(DocAct.105
	Doc:	102
)

(SEd.106
	Name:	"DCSewerDesign.Manholes.takeoverLineData"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 07. Juni 2000 10:47:44"
	GUIName:	"Script"
	Win:	107
	CSMgr:	108
	DocExts:	109
	Source:	"' DCSewerDesign.Manholes.takeoverLineData\n\n' lets the Manholes take over data from the upstream and downstream\n' fields of the lines\n' REQUIRES that the lines are flipped to flow direction\n\n' (c) 2000 DORSCH Consult\n\n  Msgbox.info(\"Make sure that the lines are flipped to flow direction.\", \"DC Sewer Design\")\n\n'get the line table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  thmLine = Msgbox.Choice (lstLine
Themes, \"Select the Line Theme.\", \"DC Sewer Design\")   \n  if (thmLine.asString = \"nil\") then\n    exit\n  end\n  ftbLine = thmLine.GetFTab \n\n'get the manhole table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstManholeThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\n  thmManhole = Msgbox.Choice (lstManholeThemes, \"Select the Manhole Theme.\", \"DC Sewer Design\")   \n  if (thmManhole.asString = \"nil\") then\n    exit\n  end\n  ftbManhole = thmManhole.GetFTab \n\n ' get th
e manhole data field\n lstManholeFields = ftbManhole.getFields.clone\n lstManholeFields.remove(0)\n fldManholeData = Msgbox.choice(lstManholeFields, \"Select the Manhole Data Field.\",\"Select a Field\")\n if(fldManholeData.asString = \"nil\")then\n  exit\n end\n\n ' get the upstream and downstream data field\n lstLineFields = ftbLine.getFields.clone\n lstLineFields.remove(0)\n fldUpstreamData = Msgbox.choice(lstLineFields, \"Select the Upstream Data Field.\",\"Select a Field\")\n if(fldUpstreamData.asString = \"nil\")then\n  exit\n
 end\n\n if(fldUpstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Upstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldDownstreamData = Msgbox.choice(lstLineFields, \"Select the Downstream Data Field.\",\"Select a Field\")\n if(fldDownstreamData.asString = \"nil\")then\n  exit\n end\n\n if(fldDownstreamData.getType <> fldManholeData.getType)then\n   Msgbox.info(\"Downstream Data Type doesn't match Manhole Data Type\", \"DC Sewer Design\")\n   exit\n end\n\n fldLineShape = ftb
Line.findField(\"Shape\") \n fldManholeShape = ftbManhole.findField(\"Shape\")\n ftbManhole.setEditable(true)\n numTotal = ftbManhole.getNumRecords\n numComplete = 0\n av.showStopButton\n  \n for each recManhole in ftbManhole\n   pntManhole = ftbManhole.returnValue(fldManholeShape, recManhole)\n   ftbLine.selectByPoint(pntManhole, 0.1, #VTAB_SELTYPE_NEW)\n   objValue = nil\n   for each recLine in ftbLine.getSelection\n     pllLine = ftbLine.returnValue(fldLineShape, recLine)\n     if(pntManhole.distance(pllLine.asList.get(0
).get(0)) < 0.1)then\n       objValue = ftbLine.returnValue(fldUpstreamData, recLine)\n     else\n       lstLine = pllLine.asList\n       if(lstLine.count > 1)then\n         System.echo(\"Error: Multipart polylines are not allowed.\")\n       else\n         lstLine = lstLine.get(0)\n         pntDownstream = lstLine.get(lstLine.count-1)\n         if(pntDownstream.distance(pntManhole) < 0.1)then\n           objValue = ftbLine.returnValue(fldDownstreamData, recLine)\n         end\n       end\n     end\n\n     break\n   end\n   f
tbManhole.setValue(fldManholeData, recManhole, objValue)\n   \n   ' update status display   \n   numComplete = numComplete + 1\n   if(av.setStatus((numComplete/numTotal)*100).not)then\n     'user hit the stop button\n     exit\n   end\n end   \n \n ftbManhole.setEditable(false)\n av.clearStatus"
	FontSize:	1
)

(DocWin.107
	Owner:	106
	X:	20
	Y:	20
	W:	761
	H:	706
)

(CSMgr.108
)

(DocAct.109
	Doc:	106
)

(SEd.110
	Name:	"DCSewerDesign.NetworkCalculator.calculate"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 28. Januar 2005 21:56:31"
	GUIName:	"Script"
	Win:	111
	CSMgr:	112
	DocExts:	113
	Source:	"'DCSewerDesign.NetworkCalculator.calculate\n\n' Calculate a table column using upstream and downstream values\n\n' (c) 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY; without even the implied
 warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\nblnDebug = false\n\nstrFormula = MsgBox.input(\"Please insert your network calculator formula:\", \"DC Network Calculator\", \"\")\nif(strFormula.is(String).not)then\n  exit\nen
d\n\n' TODO: Speed up if \"Downstream.\" and \"Upstream.\" are not used => use standard calculator\n\n' Lowercase copy of the formula to make syntax case-independent\nstrLCaseFormula = strFormula.clone\nstrLCaseFormula = strLCaseFormula.lcase\n\n' Calculation can be upstream or downstream\nblnUpstream = MsgBox.yesNoCancel(\"Perform upstream calculation? (Selecting No will perform calculations in downstream direction)\", \"DC Network Calculator\", true)\nif(blnUpstream = nil)then\n  ' User selected cancel\n  exit\nend\n\ntableNetw
ork = av.getActiveDoc\nftbNetwork = tableNetwork.getVTab\nif(ftbNetwork.is(FTab).not)then\n  MsgBox.error(\"Fatal Error: Function getVTab() did not return an FTab.\",\"DCSewerDesign.NetworkCalculator.calculate()\")\n  exit\nend\nfldNetwork = tableNetwork.getActiveField\n\n' Remember the original selection\n\nbmSelection = ftbNetwork.getSelection.clone\nbmWork = bmSelection.clone\n\n' Handle case where no records are selected\nif(bmWork.count = 0)then\n  bmWork.setAll\nend\n\nbmOne = bmWork.clone\nbmOne.clearAll\n\n' Ordererd list\nl
stOrdered = List.make\n\n' Unordered list as copied from Bitmap\nlstUnordered = List.make\n\nfldNetworkShape = ftbNetwork.findField(\"shape\")\n\n' Prevent endless loops\nnumDeadlock = bmWork.count*bmWork.count\n\n' Loop over all selected records\nfor each recWork in bmWork\n  lstUnordered.add(recWork.clone)\nend\n\nnumToGo = bmWork.count * 2\nnumDone = 0\n\n' Try to order the list\nnumI = 0\nwhile(lstUnordered.count > 0)\n  recWork = lstUnordered.get(0)\n  pntDownstream = ftbNetwork.returnValue(fldNetworkShape, recWork).along(100
)\n  recDownstream = av.run(\"DCSewerDesign.Manhole.findDownstreamLine\", {ftbNetwork, pntDownstream})\n  if(recDownstream = nil)then\n    lstOrdered.insert(recWork.clone)\n    lstUnordered.remove(0)\n    numDone = numDone + 1\n  elseif(lstUnordered.findByValue(recDownstream) = -1)then\n    recWorkClone = recWork.clone\n    lstOrdered.insert(recWorkClone)\n    intPosition = lstOrdered.findByValue(recDownstream)\n    numDone = numDone + 1 \n    if(intPosition <> -1)then\n      lstOrdered.shuffle(recWorkClone, intPosition+
1)\n    end\n    lstUnordered.remove(0)\n  else\n    lstUnordered.shuffle(recWork, lstUnordered.count)\n  end\n  numI = numI+1\n  if(numI = numDeadlock)then\n    MsgBox.error(\"FATAL ERROR: System leads to endless loop. Aborting\", \"DC Sewer Design\")\n    exit\n  end\nend\n\nnumCount = lstOrdered.count\nif(blnUpstream)then\n  numStart = 0\n  numEnd = numCount-1\n  numStep = 1\nelse\n  numStart = numCount-1\n  numEnd = 0\n  numStep = -1\nend\n' TODO: Speed up by caching downstream IDs\nfor each numI in numStart..numEnd by numStep\n  r
ecWork = lstOrdered.get(numI)\n  ' Rewrite Formula\n  strLCaseFormulaEat = strLCaseFormula.clone\n  strFormulaEat = strFormula.clone\n  strFormulaRewrite = \"\"\n  blnNil = false\n  ' TODO: Refactor\n  ' Replace Downstream values\n  while(strFormulaEat.count > 0)\n    numPos = strLCaseFormulaEat.indexOf(\"downstream.[\")\n    if(numPos <> -1)then\n      strFormulaRewrite = strFormulaRewrite+strFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 12\n      strLCaseFormulaEat = strLCaseFormulaEat.right(
numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      numPos = strLCaseFormulaEat.indexOf(\"]\")\n      if(numPos < 1)then\n        MsgBox.error(\"Syntax Error: Could not find \"+\"[\".quote,\"DC Network Calculator\")\n        exit\n      end\n      strField = strFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 1\n      strLCaseFormulaEat = strLCaseFormulaEat.right(numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      ' Evaluate downstream part of formula\n      pntDownstream 
= ftbNetwork.returnValue(fldNetworkShape, recWork).along(100)\n      recDownstream = av.run(\"DCSewerDesign.Manhole.findDownstreamLine\", {ftbNetwork, pntDownstream})\n      if(recDownstream = nil)then\n        blnNil = true\n      else\n        fldField = ftbNetwork.findField(strField)\n        if(fldField = nil)then\n          MsgBox.error(\"FATAL ERROR: Could not find field \"+strField.quote, \"DC Network Calculator\")\n          exit\n        end\n        strValue = ftbNetwork.returnValue(fldField, recDownstream).asStr
ing\n        strFormulaRewrite = strFormulaRewrite + strValue\n      end\n    else\n      strFormulaRewrite = strFormulaRewrite + strFormulaEat\n      strFormulaEat = \"\"\n      strLCaseFormulaEat = \"\"\n    end\n  end\n  if(blnDebug)then\n    System.echo(strFormulaRewrite)\n  end\n  strLCaseFormulaEat = strLCaseFormula.clone\n  strLCaseFormulaEat = strLCaseFormulaEat.lcase\n  strFormulaEat = strFormulaRewrite.clone\n  strFormulaRewrite = \"\"\n  ' TODO: Refactor\n  ' Replace upstream values\n  while(strFormulaEat.count > 0)\n   
 numPos = strLCaseFormulaEat.indexOf(\"upstream.[\")\n    if(numPos <> -1)then\n      strFormulaRewrite = strFormulaRewrite+strFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 10\n      strLCaseFormulaEat = strLCaseFormulaEat.right(numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      numPos = strLCaseFormulaEat.indexOf(\"]\")\n      if(numPos < 1)then\n        MsgBox.error(\"Syntax Error: Could not find \"+\"[\".quote,\"DC Network Calculator\")\n        exit\n      end\n      strField = s
trFormulaEat.left(numPos)\n      numEat = strLCaseFormulaEat.count - numPos - 1\n      strLCaseFormulaEat = strLCaseFormulaEat.right(numEat)\n      strFormulaEat = strFormulaEat.right(numEat)\n      ' Evaluate Upstream part of formula\n      pntUpstream = ftbNetwork.returnValue(fldNetworkShape, recWork).along(0)\n      lstUpstream = av.run(\"DCSewerDesign.Manhole.findUpstreamLines\", {ftbNetwork, pntUpstream})\n      if(lstUpstream.count < 0)then\n        blnNil = true\n      else\n        ' TODO: Allow to use maximum/
minimum upstream values\n        recUpstream = lstUpstream.get(0)\n        if(blnDebug)then\n            System.echo(\"Upstream ID: \"+ftbNetwork.returnValue(ftbNetwork.findField(\"dc_id\"), recUpstream))\n        end\n        fldField = ftbNetwork.findField(strField)\n        if(fldField = nil)then\n          MsgBox.error(\"FATAL ERROR: Could not find field \"+strField.quote, \"DC Network Calculator\")\n          exit\n        end\n        strValue = ftbNetwork.returnValue(fldField, recUpstream).asString\n        strFormulaR
ewrite = strFormulaRewrite + strValue\n      end\n    else\n      strFormulaRewrite = strFormulaRewrite + strFormulaEat\n      strFormulaEat = \"\"\n      strLCaseFormulaEat = \"\"\n    end\n  end\n\n  ' Write or calculate values  \n  if(blnNil)then\n    ftbNetwork.setValue(fldNetwork, recWork, nil)\n    if(blnDebug)then\n      System.echo(\"Writing nil value.\")\n    end\n  else\n    if(blnDebug)then\n      System.echo(strFormulaRewrite)\n    end\n    bmOne.clearAll\n    bmOne.set(recWork)\n    ftbNetwork.setSelection(bmOne)\n    ftb
Network.updateSelection\n    if(ftbNetwork.calculate(strFormulaRewrite, fldNetwork).not)then\n      MsgBox.error(\"Calculation of formula \"+strFormulaRewrite.quote+\" failed.\", \"DC Network Calculator\")\n      exit\n    end\n  end\n  if(blnDebug)then\n    System.echo(ftbNetwork.returnValue(ftbNetwork.findField(\"dc_id\"), recWork))\n  end\n  ' Update status display\n  if(av.setStatus((numDone/numToGo)*100).not)then\n    ' User hit the stop button\n    exit\n  end\n\n  numDone = numDone + 1\n  ' Update status display\n  if(av.set
Status((numDone/numToGo)*100).not)then\n    ' User hit the stop button\n    exit\n  end  \nend\n\n' Restore the original selection\nftbNetwork.setSelection(bmSelection)\nftbNetwork.updateSelection"
	SearchStr:	"field"
	FontSize:	1
)

(DocWin.111
	Owner:	110
	Open:	1
	W:	801
	H:	1067
)

(CSMgr.112
)

(DocAct.113
	Doc:	110
)

(SEd.114
	Name:	"DCSewerDesign.NetworkCalculator.update"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 28. Januar 2005 21:58:39"
	GUIName:	"Script"
	Win:	115
	CSMgr:	116
	DocExts:	117
	Source:	"'DCSewerDesign.NetworkCalculator.update\n\n' Enable the NetworkCalculator if the table belongs to a line theme and is\n' editable\n\n' (c) 2004, 2005 DORSCH Consult\n\n' This library is free software; you can redistribute it and/or\n' modify it under the terms of the GNU Lesser General Public\n' License as published by the Free Software Foundation; either\n' version 2.1 of the License, or (at your option) any later version.\n\n' This library is distributed in the hope that it will be useful,\n' but WITHOUT ANY WARRANTY;
 without even the implied warranty of\n' MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n' Lesser General Public License for more details.\n\n' You should have received a copy of the GNU Lesser General Public\n' License along with this library; if not, write to the Free Software\n' Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n\n' Update script for menu\n' No arguments\n' Returns nothing\n\ntableActive = av.getActiveDoc\nblnEnabled = false\nif(tableActive.getVTab.isEditable
)then\n  if(tableActive.getActiveField <> nil)then\n    if(tableActive.getVTab.findField(\"Shape\")<>nil)then\n      if(tableActive.getVTab.findField(\"Shape\").getType = #FIELD_SHAPELINE)then\n        blnEnabled = true\n      end\n    end\n  end\nend\nself.setEnabled(blnEnabled)\n\n"
	FontSize:	1
)

(DocWin.115
	Owner:	114
	Open:	1
	X:	801
	Y:	533
	W:	801
	H:	533
)

(CSMgr.116
)

(DocAct.117
	Doc:	114
)

(SEd.118
	Name:	"DCSewerDesign.Profile.buildLineList"
	Creator:	"sdteffen"
	CreationDate:	"Freitag, 26. Mai 2000 09:40:59"
	GUIName:	"Script"
	Win:	119
	CSMgr:	120
	DocExts:	121
	Source:	"' DCSewerDesign.Profile.buildLineList\n\n' performs the necessary network trace to establish a list of lines\n\n' argument: ftab of the lines\n' returns the list containing the record numbers\n\n' (c) 2000 DORSCH Consult\n\n"
	FontSize:	1
)

(DocWin.119
	Owner:	118
	X:	400
	Y:	89
	W:	586
	H:	535
)

(CSMgr.120
)

(DocAct.121
	Doc:	118
)

(SEd.122
	Name:	"DCSewerDesign.Profile.create"
	Creator:	"sdteffen"
	CreationDate:	"Donnerstag, 25. Mai 2000 15:58:53"
	GUIName:	"Script"
	Win:	123
	CSMgr:	124
	DocExts:	125
	Source:	"' DCSewerDesign.Profile.create\n\n' creates a longitudinal section for the selected lines\n\n' (c) 2000 DORSCH Consult\n\n'get the line table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstLineThemes = av.run(\"DCSewerDesign.ThemeList.returnLineThemes\", themeList)\n  for each thmLine in lstLineThemes\n    if(thmLine.getName.left(6) <> \"Profil\")then\n      lstLineThemes.shuffle(thmLine, 0)\n      break\n    end\n  end\n  thmLine = Msgbox.Choice (lstLineThemes, \"Select the Sewer Line Theme.\", \"Cre
ating Profile\")   \n  if (thmLine.asString = \"nil\") then\n    exit\n  end\n  ftbLine = thmLine.GetFTab \n\n'get the manhole table\n  viewActive = av.GetActiveDoc \n  themeList = viewActive.GetThemes \n  lstManholeThemes = av.run(\"DCSewerDesign.ThemeList.returnPointThemes\", themeList)\n  thmManhole = Msgbox.Choice (lstManholeThemes, \"Select the Manhole Theme.\", \"Creating Profile\")   \n  if (thmManhole.asString = \"nil\") then\n    exit\n  end\n  ftbManhole = thmManhole.GetFTab \n\n' get one selected line\nbmpSelectedLines = ft
bLine.getSelection.clone\nif(bmpSelectedLines.count < 2)then\n  MsgBox.info(\"Please select the Lines for which the Profile should be created\",\"DC Sewer Design\")\n  exit\nend\nrecTrace = bmpSelectedLines.getNextSet(-1)\nlstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\nlstConnectedSelected = List.make\nfor each recConnected in lstConnectedLines\n  if(bmpSelectedLines.get(recConnected))then\n    lstConnectedSelected.add(recConnected)\n  end\nend\n\nav.showStopButton\nnumSelected = bmpSele
ctedLines.count\n\n' trace to end section (of selection)\nnumFreezePrevent = 0\nlstTried = List.make\nwhile(lstConnectedSelected.count = 2)\n    if((recTrace = lstConnectedSelected.get(0))or(lstTried.findByValue(recTrace)<>(-1)))then\n    recTrace = lstConnectedSelected.get(1)\n  else\n    recTrace = lstConnectedSelected.get(0)\n  end\n  if(lstConnectedSelected.findByValue(recTrace) = -1)then\n    lstConnectedSelected.add(recTrace)\n  end\n  lstConnectedSelected = List.make\n  strControl = \"\"\n  lstConnectedLines=av.run(\"D
CSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\n  for each recConnected in lstConnectedLines\n    if((bmpSelectedLines.get(recConnected)and(lstConnectedSelected.find(recConnected) = -1)))then\n      lstConnectedSelected.add(recConnected)\n      lstTried.add(recConnected)\n      strControl = strControl ++ftbLine.returnValue(ftbLine.findField(\"dc_id\"), recConnected).asString\n    end\n  end\n  numFreezePrevent = numFreezePrevent+1\n  if(numFreezePrevent = 1000)then\n    MsgBox.info(\"Went into endless loop. C
heck the Topology.\", \"DC Sewer Design\")\n    exit\n  end\n  if(av.setStatus(0).not)then\n    exit\n  end\nend\nif(lstConnectedSelected.count>2)then\n  MsgBox.info(\"Can't draw Profile for forks. Please check the selection.\",\"DC Sewer Design\")\n  exit\nend\n\n' bounce: start the real trace to other end of selection\n\nlstProfileLines = List.make\nlstProfileLines.add(recTrace)\n\nrecTrace = lstConnectedSelected.get(0)\nlstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\nlstConnectedSelected = Li
st.make\nfor each recConnected in lstConnectedLines\n  if(bmpSelectedLines.get(recConnected))then\n    lstConnectedSelected.add(recConnected)\n  end\nend\nlstProfileLines.add(recTrace)\n\nwhile(lstConnectedSelected.count = 2)\n  if(lstProfileLines.findByValue(lstConnectedSelected.get(0)) <> -1)then\n    recTrace = lstConnectedSelected.get(1)\n  else\n    recTrace = lstConnectedSelected.get(0)\n  end\n  lstProfileLines.add(recTrace)\n  lstConnectedLines=av.run(\"DCSewerDesign.Line.findConnectedLines\",{ftbLine,recTrace})\n  l
stConnectedSelected = List.make\n  for each recConnected in lstConnectedLines\n    if(bmpSelectedLines.get(recConnected))then\n      lstConnectedSelected.add(recConnected)\n    end\n  end\n  if(av.setStatus(lstProfileLines.count/numSelected*100).not)then\n    exit\n  end\nend\nif(lstConnectedSelected.count>2)then\n  MsgBox.info(\"Can't draw Profile for forks. Please check the selection.\",\"DC Sewer Design\")\n  exit\nend\nif(lstProfileLines.count <> bmpSelectedLines.count)then\n  MsgBox.info(\"Selected Lines are not fully con
nected. Please check.\",\"DC Sewer Design\")\n  exit\nend\n\nftbLine.setSelection(bmpSelectedLines)\n\n' build Manhole list\n\nlstProfileManholes = List.make\n\nlstPreviousManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,lstProfileLines.get(0)}).clone\nlstManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,lstProfileLines.get(1)}).clone\nfor each recManhole in lstPreviousManholes\n  if(lstManholes.findByValue(recManhole) = -1)then\n    lstProfileManholes.add(recManhole)\n  end\nend\n\n
for each recLine in lstProfileLines\n  lstManholes = av.run(\"DCSewerDesign.Line.findManholes\",{ftbLine,ftbManhole,recLine})\n  for each recManhole in lstManholes\n    if(lstProfileManholes.findByValue(recManhole) = -1)then\n      lstProfileManholes.add(recManhole)\n    end\n  end\nend\n\n' check if there are enough manholes\nif(lstProfileManholes.count <> (lstProfileLines.count + 1))then\n  MsgBox.info(\"Only found\"++lstProfileManholes.count.asString++\"Manholes. Should find\"++(lstProfileLines.count+1).asString++\".\"+NL+
\n              \"See the Selection for details.\",\"DC Sewer Design\")\n  bmpManholes = ftbManhole.getSelection\n  bmpManholes.clearAll\n  for each recManhole in lstProfileManholes\n    bmpManholes.set(recManhole.clone)\n  end\n  ftbManhole.setSelection(bmpManholes)\n  ftbManhole.updateSelection\n  exit\nend\n\n'information about the configuration file\n  MsgBox.info(\"One mapping per line, '=' as separator\"+NL+\n  \"Manhole.ID=???    Manhole.Diameter=???\"+NL+\n  \"Manhole.InvertLevel = ??? Manhole.Elevation = ???\"+NL+\n  \"Line.
Diameter=???, Line.Gradient=???, Line.MaximumFlow=???\"\n  ,\"Field Configuration File\")\n  \n'get the configuration file\n  lstConfFiles = FileDialog.returnFiles({\"*.txt\"},{\"Text Files (*.txt)\"},\"Select Configuration File\",0)\n if(lstConfFiles.count = 0 )then\n   exit\n end\n\n 'open the configuration file\n lnfConfiguration = LineFile.make(lstConfFiles.get(0), #FILE_PERM_READ)\n\n fldManholeID=nil\n fldManholeDiameter=nil\n fldManholeInvertLevel=nil\n fldManholeElevation=nil\n fldLineDiameter = nil\n fldLineGradient = nil\n 
fldLineMaximumFlow = nil\n \n strLine=lnfConfiguration.readElt\n 'process the configuration file \n while (not (strLine=nil ))\n    lstConfTokens = strLine.asTokens(\"=\")\n    if(lstConfTokens.count=2)then\n      strScriptFieldName = lstConfTokens.get(0).trim.lcase\n      strTableFieldName = lstConfTokens.get(1).trim.lcase\n      if(strScriptFieldName = \"manhole.id\")then\n        fldManholeID=ftbManhole.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"manhole.diameter\")then\n        fldManholeDiame
ter=ftbManhole.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"manhole.invertlevel\")then\n        fldManholeInvertLevel=ftbManhole.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"manhole.elevation\")then\n        fldManholeElevation=ftbManhole.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"line.diameter\")then\n        fldLineDiameter = ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"line.gradient\")then\n        fldLi
neGradient = ftbLine.findField(strTableFieldName)\n      end\n      if(strScriptFieldName = \"line.maximumflow\")then\n        fldLineMaximumFlow = ftbLine.findField(strTableFieldName)\n      end\n    end\n    strLine = lnfConfiguration.readElt\n end\n \n 'close the configuration file\n lnfConfiguration.close\n \n 'check if configuration was successful\n  if((fldManholeID=nil)or(fldManholeDiameter=nil)or(fldManholeInvertLevel=nil)or(fldManholeElevation=nil) or\n      (fldLineDiameter = nil) )then\n    MsgBox.error(\"Field ma
tching not successful. Check your tables and configuration file.\",\"DC Sewer Design\")\n    exit\n  end\n  \n  fldManholeShape = ftbManhole.findField(\"Shape\")\n  fldLineShape = ftbLine.findField(\"Shape\")\n  \n  flnProfile = av.getProject.getWorkDir.makeTmp(\"profile\",\"shp\")\n  ftbProfile = FTab.makeNew(flnProfile,PolyLine)\n  \n  ftbProfile.setEditable(true)\n  fldProfileShape = ftbProfile.findField(\"Shape\")\n  ftbProfile.addFields({Field.make(\"id\", #FIELD_DECIMAL, 4, 0),Field.make(\"style\",#FIELD_CHAR,16,0)})\n  fldProfile
Style = ftbProfile.findField(\"style\")\n  \n  ' flip lists if necessary \n  ' will have the upstream end on the left side then\n  \n  numUpstreamInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, lstProfileManholes.get(0))\n  numDownstreamInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, lstProfileManholes.get(lstProfileManholes.count-1))\n  if(numDownstreamInvertLevel > numUpstreamInvertLevel)then\n    lstProfileManholes = av.run(\"DCSewerDesign.List.flip\", lstProfileManholes)\n    lstProfileLines 
= av.run(\"DCSewerDesign.List.flip\", lstProfileLines)\n  end\n  \n  ' create the Profile View\n  strFirstManhole = ftbManhole.returnValue(fldManholeID, lstProfileManholes.get(0)).asString\n  strLastManhole = ftbManhole.returnValue(fldManholeID, lstProfileManholes.get(lstProfileManholes.count-1)).asString\n  strViewName = \"Profile\"++strFirstManhole++\"-\"++strLastManhole\n  lstViews = av.getProject.getDocsWithGUI(av.findGUI(\"View\"))\n  for each viewCheck in lstViews\n    if(viewCheck.getName = strViewName)then\n      bln
Overwrite = MsgBox.yesNo(\"A view named'\"+strViewName+\"' already exists.\"+NL+\"Overwrite it?\", \"DC Sewer Design\", true)\n      if(blnOverwrite)then\n        av.getProject.removeDoc(av.getProject.findDoc(strViewName))      \n      else\n        exit\n      end\n    end\n  end\n  viewProfile = View.make\n  viewProfile.setName(strViewName)\n  viewProfile.getWin.activate\n\n  ' draw Manholes\n  \n  numX = 1000.0\n  numY = 1000.0\n  for each i in 0..(lstProfileManholes.count-1)\n    recProfile = ftbProfile.addRecord\n    recManhole
 = lstProfileManholes.get(i)\n    numDiameter = ftbManhole.returnValue(fldManholeDiameter, recManhole)\n    numInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recManhole)\n    numElevation = ftbManhole.returnValue(fldManholeElevation, recManhole)\n    pntLowerLeft = Point.make(numX-(numDiameter/2000), numY+(numInvertLevel*10))\n    pntUpperLeft = Point.make(numX-(numDiameter/2000), numY+(numElevation*10))\n    pntUpperRight = Point.make(numX+(numDiameter/2000), numY+(numElevation*10))\n    pntLowerRigh
t = Point.make(numX+(numDiameter/2000), numY+(numInvertLevel*10))\n    pllManhole = Polyline.make({{pntLowerLeft,pntUpperLeft,pntUpperRight, pntLowerRight, pntLowerLeft}})\n    ftbProfile.setValue(fldProfileShape, recProfile, pllManhole)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n    \n    recProfile = ftbProfile.addRecord\n    pntCenterlineStart = Point.make(numX, numY+(numElevation*10))\n    pntCenterlineEnd = Point.make(numX, numY+(ftbManhole.returnValue(fldManholeInvertLevel, lstProfileMa
nholes.get(lstProfileManholes.count-1))*10)-12)\n    pllManholeCenterline = Polyline.make({{pntCenterlineStart, pntCenterlineEnd}})\n    ftbProfile.setValue(fldProfileShape, recProfile, pllManholeCenterline)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\") \n    \n    if(i < lstProfileLines.count)then\n      numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n    end\n  end\n  \n  ' draw Lines\n  \n  numX = 1000.0\n  for each i in 0..(lstProfileLines.count-1)\n    recProfil
e = ftbProfile.addRecord\n    recLine = lstProfileLines.get(i)\n    recUpstreamManhole = lstProfileManholes.get(i)\n    recDownstreamManhole = lstProfileManholes.get(i+1)\n    numLineDiameter = ftbLine.returnValue(fldLineDiameter, recLine)\n    numUpstreamManholeDiameter = ftbManhole.returnValue(fldManholeDiameter, recUpstreamManhole)\n    numDownstreamManholeDiameter = ftbManhole.returnValue(fldManholeDiameter, recDownstreamManhole)\n    numUpstreamInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recUp
streamManhole)\n    numDownstreamInvertLevel = ftbManhole.returnValue(fldManholeInvertLevel, recDownstreamManhole)\n    numLineLength = ftbLine.returnValue(fldLineShape,recLine).returnLength\n    pntUpstreamInvert=Point.make(numX+(numUpstreamManholeDiameter/2000), numY+(numUpstreamInvertLevel*10))\n    pntDownstreamInvert=Point.make(numX+numLineLength-(numDownstreamManholeDiameter/2000), numY+(numDownstreamInvertLevel*10))\n    pllInvert = Polyline.make({{pntUpstreamInvert, pntDownstreamInvert}})\n    ftbProfile.
setValue(fldProfileShape, recProfile, pllInvert)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n\n    recProfile = ftbProfile.addRecord\n    pntUpstreamUpperLevel = pntUpstreamInvert+Point.make(0,numLineDiameter/100)\n    pntDownstreamUpperLevel = pntDownstreamInvert+Point.make(0,numLineDiameter/100)\n    pllUpper = Polyline.make({{pntUpstreamUpperLevel, pntDownstreamUpperLevel}})\n    ftbProfile.setValue(fldProfileShape, recProfile, pllUpper)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"b
old\")\n\n    recProfile = ftbProfile.addRecord\n    numUpstreamElevation = ftbManhole.returnValue(fldManholeElevation, recUpstreamManhole)\n    numDownstreamElevation = ftbManhole.returnValue(fldManholeElevation, recDownstreamManhole)\n    pntUpstreamElevation = Point.make(numX+(numUpstreamManholeDiameter/2000), numY+(numUpstreamElevation*10))\n    pntDownstreamElevation = Point.make(numX+numLineLength-(numDownstreamManholeDiameter/2000), numY+(numDownstreamElevation*10))\n    pllElevation = Polyline.make({{pntUps
treamElevation, pntDownstreamElevation}})\n    ftbProfile.setValue(fldProfileShape, recProfile, pllElevation)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n    \n    numX = numX + numLineLength\n  end\n  \n  ' manhole IDs\n  viewProfile.setUnits(#UNITS_LINEAR_METERS)\n  viewProfile.getDisplay.setDistanceUnits(#UNITS_LINEAR_METERS)\n  viewProfile.getDisplay.zoomToScale(1000)\n  \n  numTotalLength = numX - 1000.0\n  numX = 1000.0\n  numY = numY + (ftbManhole.returnValue(fldManholeInvertLevel, lstProfileMan
holes.get(lstProfileManholes.count-1))*10)-15\n  recProfile = ftbProfile.addRecord\n  pntFrameLowerLeft = Point.make(numX-60, numY-5)\n  pntSize = Point.make(numTotalLength+60+20, 8)\n  pllIDFrame = Rect.make(pntFrameLowerLeft, pntSize).asPolygon.asPolyline\n  ftbProfile.setValue(fldProfileShape, recProfile, pllIDFrame)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  pntIDLocation = Point.make(numX-58, numY)\n  gtxIDLabel = GraphicText.make(\"Schacht-Nr.\", pntIDLocation)\n  viewProfile.getGraphics.ad
d(gtxIDLabel)\n  tpsID = TextPositioner.make(Point)\n  tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\n  tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  tpsID.Calculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n  gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n  for each symText in gtxIDLabel.returnSymbols\n    viewProfile.getDisplay.hookupSymbol(symText)\n  end\n\n\n  for each i in 0..(lstProfileManholes.count-1)\n    recManhole = lstProfileManholes.get(i)\n    strManholeID = ftbManhole.returnValue(fldManholeID, recManhole).as
String\n    if(strManholeID = \"\")then\n      strManholeID = \" \"\n    end\n    pntIDLocation = Point.make(numX, numY)\n    gtxManhole = GraphicText.make(strManholeID, pntIDLocation)\n    viewProfile.getGraphics.add(gtxManhole)\n    tpsID = TextPositioner.make(pntIDLocation.getClass)\n    tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n    tpsID.Calculate(pntIDLocation, gtxManhole.GetExtent, 1, nil)\n    gtxManhole.SetOrigin(tpsID.GetOrigin)\n    for each symText in gtxManh
ole.returnSymbols\n      viewProfile.getDisplay.hookupSymbol(symText)\n    end\n    if(i < lstProfileLines.count)then\n      numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n    end    \n  end\n  \n  ' manhole elevations\n\n  numX = 1000.0\n  numY = numY - 6.0\n  recProfile = ftbProfile.addRecord\n  pntFrameLowerLeft = Point.make(numX-60, numY-19)\n  pntSize = Point.make(numTotalLength+60+20,20)\n  pllIDFrame = Rect.make(pntFrameLowerLeft, pntSize).asPolygon.asPolyline\n  ftbProfile.setV
alue(fldProfileShape, recProfile, pllIDFrame)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  pntIDLocation = Point.make(numX-58, numY-7)\n  gtxIDLabel = GraphicText.make(\"Gelaendehoehe in m N.N.\", pntIDLocation)\n  viewProfile.getGraphics.add(gtxIDLabel)\n  tpsID = TextPositioner.make(Point)\n  tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\n  tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  tpsID.Calculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n  gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n  for each
 symText in gtxIDLabel.returnSymbols\n    viewProfile.getDisplay.hookupSymbol(symText)\n  end\n\n  for each i in 0..(lstProfileManholes.count-1)\n    recManhole = lstProfileManholes.get(i)\n    strManholeElevation = ftbManhole.returnValue(fldManholeElevation, recManhole).setFormat(\"d.dd\").asString\n    if(strManholeElevation = \"\")then\n      strManholeElevation=\" \"\n    end\n    pntIDLocation = Point.make(numX, numY)\n    gtxManhole = GraphicText.make(strManholeElevation, pntIDLocation)\n    gtxManhole.setAngle(90)\n   
 viewProfile.getGraphics.add(gtxManhole)\n    tpsID = TextPositioner.make(pntIDLocation.getClass)\n    tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_BELOW)\n    tpsID.Calculate(pntIDLocation, gtxManhole.GetExtent, 1, nil)\n    gtxManhole.SetOrigin(tpsID.GetOrigin)\n    for each symText in gtxManhole.returnSymbols\n      viewProfile.getDisplay.hookupSymbol(symText)\n    end\n    if(i < lstProfileLines.count)then\n      numX = numX + ftbLine.returnValue(fldLineShape,lstProfi
leLines.get(i)).returnLength\n    end    \n  end\n  \n  ' invert levels\n  \n  numX = 1000.0\n  numY = numY - 20.0\n  recProfile = ftbProfile.addRecord\n  pntFrameLowerLeft = Point.make(numX-60, numY-19)\n  pntSize = Point.make(numTotalLength+60+20,20)\n  pllIDFrame = Rect.make(pntFrameLowerLeft, pntSize).asPolygon.asPolyline\n  ftbProfile.setValue(fldProfileShape, recProfile, pllIDFrame)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  pntIDLocation = Point.make(numX-58, numY-7)\n  gtxIDLabel = GraphicTex
t.make(\"Sohlhoehe in m N.N.\", pntIDLocation)\n  viewProfile.getGraphics.add(gtxIDLabel)\n  tpsID = TextPositioner.make(Point)\n  tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\n  tpsID.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  tpsID.Calculate(pntIDLocation, gtxIDLabel.GetExtent, 1, nil)\n  gtxIDLabel.SetOrigin(tpsID.GetOrigin)\n  for each symText in gtxIDLabel.returnSymbols\n    viewProfile.getDisplay.hookupSymbol(symText)\n  end\n\n  for each i in 0..(lstProfileManholes.count-1)\n    recManhole = lstProfileManholes.get(i
)\n    strManholeElevation = ftbManhole.returnValue(fldManholeInvertLevel, recManhole).setFormat(\"d.dd\").asString\n    if(strManholeElevation = \"\")then\n      strManholeElevation = \" \"\n    end\n    pntIDLocation = Point.make(numX, numY)\n    gtxManhole = GraphicText.make(strManholeElevation, pntIDLocation)\n    gtxManhole.setAngle(90)\n    viewProfile.getGraphics.add(gtxManhole)\n    tpsID = TextPositioner.make(pntIDLocation.getClass)\n    tpsID.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsID.SetVAlign(#TEXTPOSIT
IONER_VALIGN_BELOW)\n    tpsID.Calculate(pntIDLocation, gtxManhole.GetExtent, 1, nil)\n    gtxManhole.SetOrigin(tpsID.GetOrigin)\n    for each symText in gtxManhole.returnSymbols\n      viewProfile.getDisplay.hookupSymbol(symText)\n    end\n\n    if(i < lstProfileLines.count)then\n      numX = numX + ftbLine.returnValue(fldLineShape,lstProfileLines.get(i)).returnLength\n    end    \n  end\n\n  ' level reach length\n  numY = av.run(\"DCSewerDesign.Profile.LineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, num
Y-19, fldLineShape, \"Haltungslaenge in m\", lstProfileLines})\n  \n  ' level reach diameter\n  numY = av.run(\"DCSewerDesign.Profile.LineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldLineDiameter, \"Querschnitt in mm\", lstProfileLines})\n  \n  ' gradient\n  if(fldLineGradient <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.LineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldLineGradient, \"Gefaelle in m/km\", lstProfileLines})\n  end\n\n  ' maximum flow\n  if(fldLineMaximum
Flow <> nil)then\n    numY = av.run(\"DCSewerDesign.Profile.LineDataBox.create\", {ftbProfile, ftbLine, viewProfile, 1000.0, numY, fldLineMaximumFlow, \"Max. Q in l/s\", lstProfileLines})\n  end\n\n  \n  ' draw Bounding Box\n\n  numBoundingBoxTop = 1000 + (ftbManhole.returnValue(fldManholeInvertLevel, lstProfileManholes.get(lstProfileManholes.count-1))*10)-8  \n  pntBoundingBoxOrigin = Point.make(1000-60, numY)\n  pntBoundingBoxSize = Point.make(numTotalLength+60+20, numBoundingBoxTop-numY-4)\n  pllBoundingBox = Rect.mak
e(pntBoundingBoxOrigin, pntBoundingBoxSize).asPolygon.asPolyline\n  recProfile = ftbProfile.addRecord\n  ftbProfile.setValue(fldProfileShape, recProfile, pllBoundingBox)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"bold\")\n  \n  ftbProfile.setEditable(false)\n  thmProfile = FTheme.make(ftbProfile)\n  viewProfile.addTheme(thmProfile)\n  lgdProfile = thmProfile.getLegend\n  lgdProfile.setLegendType(#LEGEND_TYPE_UNIQUE)\n  lgdProfile.unique(thmProfile, \"style\")\n  for each symUnique in lgdProfile.getSymbols\n    s
ymUnique.setColor(Color.getBlack)\n  end\n  lgdProfile.getSymbols.get(0).setSize(1)\n  thmProfile.updateLegend\n  \n  av.clearStatus\n  thmProfile.setVisible(true) \n  rctExtent = viewProfile.ReturnExtent\n  viewProfile.GetDisplay.SetExtent(rctExtent.Scale(1.1))\n  \n  av.GetProject.SetModified(true)  \n  "
	SearchStr:	"system.echo"
	FontSize:	1
)

(DocWin.123
	Owner:	122
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.124
)

(DocAct.125
	Doc:	122
)

(SEd.126
	Name:	"DCSewerDesign.Profile.CumulativeLineDataBox.create"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 25. Februar 2004 18:43:37"
	GUIName:	"Script"
	Win:	127
	CSMgr:	128
	DocExts:	129
	Source:	"' DCSewerDesign.Profile.CumulativeLineDataBox.create\n\n' arguments: Profile FTab, Line FTab, active View, X-Coordinate, \n'            Y-Coordinate, Data Fieldname, Label String, Line Record List,\n'            Int Precision, Int Height\n\n' returns the new Y-Coordinate\n\n' (c) 2000 - 2004 DORSCH Consult\n\n' Parameter\nif(self.count <> 10)then\n  System.echo(\"DCSewerDesign.Profile.CumulativeLineDataBox.create: ERROR: Expected 10 arguments\")\n  exit\nend\nftbProfile = self.get(0)\nftbLine = self.get(1)\nviewActive = self.
get(2)\nnumX = self.get(3)\nnumY = self.get(4)\nfldData = self.get(5)\nstrLabel = self.get(6)\nlstLineRecords = self.get(7)\nnumPrecision = self.get(8)\nnumHeight = self.get(9)\n\nnumI = 0\nfor each objArgument in self\n  if(objArgument.asString=\"nil\")then\n    System.echo(\"DCSewerDesign.ProfileCumulativeLineDataBox.create: Argument\"++numI.asString++\"=nil\")\n  end\n  numI = numI+1\nend\n\nstrFormat = \"dd\"\nif(numPrecision > 0)then\n  strFormat = \"d.\"\n  for each i in 1..numPrecision\n     strFormat = strFormat+\"d\"\n  end\nend\n\nfl
dProfileShape = ftbProfile.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\nfldProfileStyle = ftbProfile.findField(\"style\")\n\n' label the box\n\ngtxLabel = GraphicText.make(strLabel,Point.make(0,0))\nviewActive.getGraphics.add(gtxLabel)\n'numHeight = gtxLabel.getExtent.getY+1\ntpsLabel = TextPositioner.make(Point)\ntpsLabel.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\ntpsLabel.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\npntLabelLocation = Point.make(numX-58, numY-(numHeight/2)+1)\ntpsLabel.calculate(pntLabelLocatio
n, gtxLabel.GetExtent, 1, nil)\ngtxLabel.SetOrigin(tpsLabel.GetOrigin)\nfor each symText in gtxLabel.returnSymbols\n  viewActive.getDisplay.hookupSymbol(symText)\nend\n\nrecProfile = ftbProfile.addRecord\npntVerticalLineStart = Point.make(numX, numY)\npntVerticalLineEnd = Point.make(numX, numY-numHeight)\npllVerticalLine = Polyline.make({{pntVerticalLineStart, pntVerticalLineEnd}})\nftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\nstrPreviou
sText = \" \"\nnumCumulativeLength = 0\n\n' draw data texts\nnumWidth = 0\nfor each i in 0..(lstLineRecords.count-1)\n  recLine = lstLineRecords.get(i)\n  numLength = ftbLine.returnValue(fldLineShape, recLine).returnLength\n  if(fldData.isTypeShape)then\n    strText = ftbLine.returnValue(fldData, recLine).returnLength.setFormat(strFormat).asString\n  else\n    strText = ftbLine.returnValue(fldData, recLine)\n    if(strText.is(Number))then\n      strText = strText.setFormat(strFormat).asString\n    end\n  end\n  if((strText =
 nil)or(strText=\"\"))then\n    strText = \" \"\n  end\n  if((strText <> strPreviousText) and(i<>0))then\n    pntTextLocation = Point.make(numX+numWidth-(numCumulativeLength/2),numY-(numHeight/2)+1)\n    gtxText = GraphicText.make(strPreviousText, pntTextLocation)\n    viewActive.getGraphics.add(gtxText)\n    tpsText = TextPositioner.make(Point)\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n    tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n    gtx
Text.setOrigin(tpsText.getOrigin)\n    for each symText in gtxText.returnSymbols\n      viewActive.getDisplay.hookupSymbol(symText)\n    end\n    recProfile = ftbProfile.addRecord\n    pllVerticalLine.move(numCumulativeLength, 0)\n    ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\n    ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n    numCumulativeLength = 0\n  end\n  numWidth = numWidth + numLength\n  numCumulativeLength = numCumulativeLength + numLength\n  strPreviousText = strText\nen
d\n\nif(strPreviousText <> \" \")then\n  pntTextLocation = Point.make(numX+numWidth-(numCumulativeLength/2),numY-(numHeight/2)+1)\n    gtxText = GraphicText.make(strPreviousText, pntTextLocation)\n    viewActive.getGraphics.add(gtxText)\n    tpsText = TextPositioner.make(Point)\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n    tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n    gtxText.setOrigin(tpsText.getOrigin)\n    for each symText in gtxText.
returnSymbols\n      viewActive.getDisplay.hookupSymbol(symText)\n    end\nend\n\n'draw the box\npntBoxOrigin = Point.make(numX-60, numY-numHeight)\npntBoxSize = Point.make(numWidth+60+20, numHeight)\npllFrame = Rect.make(pntBoxOrigin, pntBoxSize).asPolygon.asPolyline\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllFrame)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\nreturn numY-numHeight\n"
	SearchStr:	"isTypeShape"
	FontSize:	1
)

(DocWin.127
	Owner:	126
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.128
)

(DocAct.129
	Doc:	126
)

(SEd.130
	Name:	"DCSewerDesign.Profile.LineDataBox.create"
	Creator:	"sdteffen"
	CreationDate:	"Sonntag, 28. Mai 2000 10:04:47"
	GUIName:	"Script"
	Win:	131
	CSMgr:	132
	DocExts:	133
	Source:	"' DCSewerDesign.Profile.LineDataBox.create\n\n' arguments: Profile FTab, Line FTab, active View, X-Coordinate, \n'            Y-Coordinate, Data Fieldname, Label String, Line Record List,\n'            Int Precision, Int Height\n\n' returns the new Y-Coordinate\n\n' (c) 2000 DORSCH Consult\n\n' Parameter\nif(self.count <> 10)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: ERROR: Expected 10 arguments, got \"+self.count.asString)\n  exit\nend\nftbProfile = self.get(0)\nif(ftbProfile.is(FTab).not)then\n  System.
echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 0 is not an FTab\")\n  exit\nend\nftbLine = self.get(1)\nif(ftbLine.is(FTab).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 1 is not an FTab\")\n  exit\nend\nviewActive = self.get(2)\nif(viewActive.is(View).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 2 is not a View\")\n  exit\nend\nnumX = self.get(3)\nif(numX.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 3 is not a Nu
mber\")\n  exit\nend\nnumY = self.get(4)\nif(numY.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 4 is not a Number\")\n  exit\nend\nfldData = self.get(5)\nif(fldData.is(Field).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 5 is not a Field\")\n  exit\nend\nstrLabel = self.get(6)\nif(strLabel.is(String).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 6 is not a String\")\n  exit\nend\nlstLineRecords = self.get(7)\nif(lstLineRecords.is(
List).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 7 is not a Number\")\n  exit\nend\nnumPrecision = self.get(8)\nif(numPrecision.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 8 is not a Number\")\n  exit\nend\nnumHeight = self.get(9)\nif(numHeight.is(Number).not)then\n  System.echo(\"DCSewerDesign.Profile.LineDataBox.create: Argument 9 is not a Number\")\nend\n\nstrFormat = \"dd\"\nif(numPrecision > 0)then\n  strFormat = \"d.\"\n  for each i in 1..numPrecision
\n     strFormat = strFormat+\"d\"\n  end\nend\n\nfldProfileShape = ftbProfile.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\nfldProfileStyle = ftbProfile.findField(\"style\")\n\n' label the box\n\ngtxLabel = GraphicText.make(strLabel,Point.make(0,0))\nviewActive.getGraphics.add(gtxLabel)\n'numHeight = gtxLabel.getExtent.getY+1\ntpsLabel = TextPositioner.make(Point)\ntpsLabel.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\ntpsLabel.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\npntLabelLocation = Point.make(numX-58, numY-(numHe
ight/2)+1)\ntpsLabel.calculate(pntLabelLocation, gtxLabel.GetExtent, 1, nil)\ngtxLabel.SetOrigin(tpsLabel.GetOrigin)\nfor each symText in gtxLabel.returnSymbols\n  viewActive.getDisplay.hookupSymbol(symText)\nend\n\nrecProfile = ftbProfile.addRecord\npntVerticalLineStart = Point.make(numX, numY)\npntVerticalLineEnd = Point.make(numX, numY-numHeight)\npllVerticalLine = Polyline.make({{pntVerticalLineStart, pntVerticalLineEnd}})\nftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\nftbProfile.setValue(fldPr
ofileStyle, recProfile, \"normal\")\n\n' draw data texts\nnumWidth = 0\nfor each i in 0..(lstLineRecords.count-1)\n  recLine = lstLineRecords.get(i)\n  numLength = ftbLine.returnValue(fldLineShape, recLine).returnLength\n  if(fldData.isTypeShape)then\n    strText = ftbLine.returnValue(fldData, recLine).returnLength.setFormat(strFormat).asString\n  else\n    strText = ftbLine.returnValue(fldData, recLine)\n    if(strText.is(Number))then\n      strText = strText.setFormat(strFormat).asString\n    end\n  end\n  pntTextLocation
 = Point.make(numX+numWidth+(numLength/2),numY-(numHeight/2)+1)\n  gtxText = GraphicText.make(strText, pntTextLocation)\n  viewActive.getGraphics.add(gtxText)\n  tpsText = TextPositioner.make(Point)\n  tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n  tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  tpsText.calculate(pntTextLocation, gtxText.getExtent, 1, nil)\n  gtxText.setOrigin(tpsText.getOrigin)\n  for each symText in gtxText.returnSymbols\n    viewActive.getDisplay.hookupSymbol(symText)\n  end\n  recProfile = ft
bProfile.addRecord\n  pllVerticalLine.move(numLength, 0)\n  ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  numWidth = numWidth + numLength\nend\n\n'draw the box\npntBoxOrigin = Point.make(numX-60, numY-numHeight)\npntBoxSize = Point.make(numWidth+60+20, numHeight)\npllFrame = Rect.make(pntBoxOrigin, pntBoxSize).asPolygon.asPolyline\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllFrame)\nftbProfile.
setValue(fldProfileStyle, recProfile, \"normal\")\n\nreturn numY-numHeight\n"
	SearchStr:	"format"
	FontSize:	1
)

(DocWin.131
	Owner:	130
	X:	801
	W:	801
	H:	533
)

(CSMgr.132
)

(DocAct.133
	Doc:	130
)

(SEd.134
	Name:	"DCSewerDesign.Profile.linkToLayout"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 17. November 2004 10:05:18"
	GUIName:	"Script"
	Win:	135
	CSMgr:	136
	DocExts:	137
	Source:	"' DCSewerDesign.Profile.linkToLayout\n\n' Establish a link from a designed profile back\n' to the layout via the dc_id field; use the minimum\n' error for the two x coordinates to establish the link\n\n' (c) 2004 DORSCH Consult\n\n' Called from menu.\n' No arguments.\n' Returns nothing.\n\nviewActive = av.getActiveDoc\nlstThemes = viewActive.getActiveThemes\nftbProfile = lstThemes.get(0).getFTab\nftbLine = lstThemes.get(1).getFTab\nif(lstThemes.get(0).getFTab.isEditable)then\n  ftbProfile = lstThemes.get(1).getFTab\n  ftbLin
e = lstThemes.get(0).getFTab\nend\nfldProfileDcId = ftbProfile.findField(\"dc_id\")\nif(fldProfileDcId.asString = \"nil\")then\n  MsgBox.error(\"Could not find field 'dc_id' in ground profile theme.\", \"DC Sewer Design\")\n  exit\nend\n\nfldLineDcId = ftbLine.findField(\"dc_id\")\nif(fldLineDcId.asString = \"nil\")then\n  lstFields = {Field.make(\"dc_id\", #FIELD_CHAR, 16, 0)}\n  ftbLine.addFields(lstFields)\n  fldLineDcId = ftbLine.findField(\"dc_id\")\nend\n\nfldLineUpstream = ftbLine.findField(\"upstream\")\nif(fldLineUpstream.asString 
= \"nil\")then\n  lstFields = {Field.make(\"upstream\", #FIELD_FLOAT, 16,3)}\n  ftbLine.addFields(lstFields)\n  fldLineUpstream = ftbLine.findField(\"upstream\")\nend\n\nfldLineDownstream = ftbLine.findField(\"downstream\")\nif(fldLineDownstream.asString = \"nil\")then\n  lstFields = {Field.make(\"downstream\", #FIELD_FLOAT, 16,3)}\n  ftbLine.addFields(lstFields)\n  fldLineDownstream = ftbLine.findField(\"downstream\")\nend\n\nfldLineShape = ftbLine.findField(\"shape\")\nfldProfileShape = ftbProfile.findField(\"shape\")\n\nfor each recLine 
in ftbLine\n  pllLine = ftbLine.returnValue(fldLineShape, recLine)\n  lstLinePoints = List.make\n  lstLinePoints.add(pllLine.along(0).clone)\n  lstLinePoints.add(pllLine.along(100).clone)\n  \n  ' ATTENTION: This implies a maximum trench depth of 20m\n  ftbProfile.selectByPoint(lstLinePoints.get(0), 200, #VTAB_SELTYPE_NEW)\n  \n  lstLineX = {lstLinePoints.get(0).getX, lstLinePoints.get(1).getX}\n  lstLineX.sort(true)\n  \n  bmpSelection = ftbProfile.getSelection\n  \n  ' Allow 10% error on each side\n  numMaxError = (lstL
ineX.get(1)-lstLineX.get(0))/2\n  numMinError = numMaxError\n  strDcId = nil\n  for each recProfile in bmpSelection\n    pllProfile = ftbProfile.returnValue(fldProfileShape, recProfile)\n    lstProfileX =  {pllProfile.along(0).getX, pllProfile.along(100).getX}\n    lstProfileX.sort(true)\n    numError = (lstProfileX.get(0)-lstLineX.get(0)).abs+(lstProfileX.get(1)-lstLineX.get(1)).abs\n    if(numError < numMinError)then\n      strDcId = ftbProfile.returnValue(fldProfileDcId, recProfile)\n      numMinError = numError\n 
   end\n  end\n  ftbLine.setValue(fldLineDcId, recLine, strDcId)\n  ftbLine.setValue(fldLineUpstream, recLine, (lstLinePoints.get(0).getY-1000)/10)\n  ftbLine.setValue(fldLineDownstream, recLine, (lstLinePoints.get(1).getY-1000)/10)\nend"
	FontSize:	1
)

(DocWin.135
	Owner:	134
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.136
)

(DocAct.137
	Doc:	134
)

(SEd.138
	Name:	"DCSewerDesign.Profile.linkToLayout.update"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 17. November 2004 10:12:23"
	GUIName:	"Script"
	Win:	139
	CSMgr:	140
	DocExts:	141
	Source:	"' DCSewerDesign.Profile.linkToLayout.update\n\n' (c) 2004 DORSCH Consult\n\n' Enable the \"Link Profile to Layout\" menu when two Polyline themes are\n' activated and one of them (the Profile theme) is editable\n\nviewActive = av.getActiveDoc\nlstThemes = viewActive.getActiveThemes\nblnEnabled = false\nif(lstThemes.count = 2)then\n  self.setEnabled(false)\n  if(((lstThemes.get(0).getFTab.getShapeClass.getClassName = \"Polyline\")and\n     (lstThemes.get(1).getFTab.getShapeClass.getClassName = \"Polyline\"))and\n     ((lstTheme
s.get(1).getFTab.isEditable)or(lstThemes.get(0).getFTab.isEditable)))then\n    blnEnabled = true\n  end\nend\n\nself.setEnabled(blnEnabled)\n"
	FontSize:	1
)

(DocWin.139
	Owner:	138
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.140
)

(DocAct.141
	Doc:	138
)

(SEd.142
	Name:	"DCSewerDesign.Profile.ManholeDataBox.create"
	CreationDate:	"Montag, 11. November 2002 07:24:23"
	GUIName:	"Script"
	Win:	143
	CSMgr:	144
	DocExts:	145
	Source:	"' DCSewerDesign.Profile.ManholeDataBox.create\n\n' arguments: Profile FTab, Line FTab, Manhole FTab, active View, X-Coordinate, \n'            Y-Coordinate, Data Fieldname, Label String, Manhole\n'             Record List, Line Record List,\n'            int Precision, boolean verticalText, number Height\n' returns the new Y-Coordinate\n\n' (c) 2000 - 2004 DORSCH Consult\n\n' Parameter\nif(self.count <> 13)then\n  System.echo(\"DCSewerDesign.Profile.ManholeDataBox.create: ERROR: Expected 13 arguments\")\n  exit\nend\nftbPro
file = self.get(0)\nftbLine = self.get(1)\nftbManhole = self.get(2)\nviewActive = self.get(3)\nnumX = self.get(4)\nnumY = self.get(5)\nfldData = self.get(6)\nstrLabel = self.get(7)\nlstManholeRecords = self.get(8)\nlstLineRecords = self.get(9)\nnumPrecision = self.get(10)\nblnVerticalText = self.get(11)\nnumHeight = self.get(12)\n\nfldProfileShape = ftbProfile.findField(\"Shape\")\nfldLineShape = ftbLine.findField(\"Shape\")\nfldProfileStyle = ftbProfile.findField(\"style\")\n\n' label the box\n\ngtxLabel = GraphicText.make(strLabel
,Point.make(0,0))\nviewActive.getGraphics.add(gtxLabel)\nif(numHeight = nil)then\n  numHeight = (gtxLabel.getExtent.getY*(numPrecision))\nend\ntpsLabel = TextPositioner.make(Point)\ntpsLabel.SetHAlign(#TEXTPOSITIONER_HALIGN_RIGHT)\ntpsLabel.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\npntLabelLocation = Point.make(numX-58, numY-(numHeight/2)+1)\ntpsLabel.calculate(pntLabelLocation, gtxLabel.GetExtent, 1, nil)\ngtxLabel.SetOrigin(tpsLabel.GetOrigin)\nfor each symText in gtxLabel.returnSymbols\n  viewActive.getDisplay.hookupSym
bol(symText)\nend\n\nrecProfile = ftbProfile.addRecord\npntVerticalLineStart = Point.make(numX, numY)\npntVerticalLineEnd = Point.make(numX, numY-numHeight)\npllVerticalLine = Polyline.make({{pntVerticalLineStart, pntVerticalLineEnd}})\n'ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\nstrFormat = \"dd\"\nif(numPrecision > 0)then\n  strFormat = \"d.\"\n  for each i in 1..numPrecision\n     strFormat = strFormat+\"d\"\n  end\nend\n\n' draw data texts\nnu
mWidth = 0\nfor each i in 0..(lstManholeRecords.count-1)\n  recManhole = lstManholeRecords.get(i)\n  if(i < lstLineRecords.count) then\n    recLine = lstLineRecords.get(i)\n  end\n  numLength = ftbLine.returnValue(fldLineShape, recLine).returnLength\n  strText = ftbManhole.returnValue(fldData, recManhole)\n  if(strText.is(Number))then\n    strText = strText.setFormat(strFormat).asString\n  end\n  if(blnVerticalText)then\n    pntTextLocation = Point.make(numX+numWidth,numY)\n  else\n    pntTextLocation = Point.make(numX+n
umWidth,numY-(numHeight/2)+1)\n  end  \n  gtxText = GraphicText.make(strText, pntTextLocation)\n  if(blnVerticalText)then\n    gtxText.setAngle(90)\n  end\n  viewActive.getGraphics.add(gtxText)\n  tpsText = TextPositioner.make(Point)\n  if(blnVerticalText)then\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_BELOW)\n  else\n    tpsText.SetHAlign(#TEXTPOSITIONER_HALIGN_CENTER)\n    tpsText.SetVAlign(#TEXTPOSITIONER_VALIGN_ON)\n  end\n  tpsText.calculate(pntTextLocation, gt
xText.getExtent, 1, nil)\n  gtxText.setOrigin(tpsText.getOrigin)\n  for each symText in gtxText.returnSymbols\n    viewActive.getDisplay.hookupSymbol(symText)\n  end\n  recProfile = ftbProfile.addRecord\n  pllVerticalLine.move(numLength, 0)\n  'ftbProfile.setValue(fldProfileShape, recProfile, pllVerticalLine)\n  ftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n  if(i< lstLineRecords.count)then\n    numWidth = numWidth + numLength\n  end\nend\n\n'draw the dividing line\npntLineOrigin = Point.make(numX-60, numY)\n
pntLineEnd = pntLineOrigin.clone.move(numWidth+60+20, 0)\npllFrame = Line.make(pntLineOrigin, pntLineEnd).asPolyline\n\nrecProfile = ftbProfile.addRecord\nftbProfile.setValue(fldProfileShape, recProfile, pllFrame)\nftbProfile.setValue(fldProfileStyle, recProfile, \"normal\")\n\n\nreturn numY-numHeight\n"
	SearchStr:	"ftbLine"
	FontSize:	1
)

(DocWin.143
	Owner:	142
	X:	801
	Y:	533
	W:	801
	H:	533
)

(CSMgr.144
)

(DocAct.145
	Doc:	142
)

(SEd.146
	Name:	"DCSewerDesign.ThemeList.returnLineThemes"
	Creator:	"sdteffen"
	CreationDate:	"Dienstag, 30. Mai 2000 14:09:15"
	GUIName:	"Script"
	Win:	147
	CSMgr:	148
	DocExts:	149
	Source:	"' DCSewerDesign.ThemeList.returnLineThemes\n\n' expects a List of Themes as the Argument. Returns the Themes which contain Lines in a list\n\n' (c) 2000 DORSCH Consult\n\nlstThemes = self\n\nlstLineThemes = List.make\n\nfor each thmCheck in lstThemes\n  strSubName = thmCheck.getSrcName.getSubName\n  if((strSubName = \"Arc\")or(strSubName = \"ArcZ\")or(strSubName=\"line\")) then\n    lstLineThemes.add(thmCheck)\n  end\nend\n\nreturn lstLineThemes.deepclone\n"
	FontSize:	1
)

(DocWin.147
	Owner:	146
	X:	663
	Y:	586
	W:	772
	H:	409
)

(CSMgr.148
)

(DocAct.149
	Doc:	146
)

(SEd.150
	Name:	"DCSewerDesign.ThemeList.returnPointThemes"
	Creator:	"sdteffen"
	CreationDate:	"Mittwoch, 07. Juni 2000 08:16:37"
	GUIName:	"Script"
	Win:	151
	CSMgr:	152
	DocExts:	153
	Source:	"' DCSewerDesign.ThemeList.returnPointThemes\n\n' expects a List of Themes as the Argument. Returns the Themes which contain Points in a list\n\n' (c) 2000 DORSCH Consult\n\nlstThemes = self\n\nlstPointThemes = List.make\n\nfor each thmCheck in lstThemes\n  strSubName = thmCheck.getSrcName.getSubName\n  if((strSubName = \"Node\")or(strSubName=\"Point\")) then\n    lstPointThemes.add(thmCheck)\n  end\nend\n\nreturn lstPointThemes.deepclone\n"
	SearchStr:	"Line"
	FontSize:	1
)

(DocWin.151
	Owner:	150
	X:	65
	Y:	65
	W:	811
	H:	459
)

(CSMgr.152
)

(DocAct.153
	Doc:	150
)

(SEd.154
	Name:	"DCSewerDesignExtension.canUnload"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:09:10 AM"
	GUIName:	"Script"
	Win:	155
	CSMgr:	156
	DocExts:	157
	Source:	"'DCSewerDesignExtension.canUnload\n'return(System.canUnloadLibrary(self.getDependencies.get(0)))\nreturn(true)"
	FontSize:	1
)

(DocWin.155
	Owner:	154
	X:	-4
	Y:	-4
	W:	1034
	H:	643
)

(CSMgr.156
)

(DocAct.157
	Doc:	154
)

(SEd.158
	Name:	"DCSewerDesignExtension.install"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:10:27 AM"
	GUIName:	"Script"
	Win:	159
	CSMgr:	160
	DocExts:	161
	Source:	"'DCSewerDesignExtension.install\n'Make sure there is a project\nif (av.GetProject = nil) then\n  return nil\nend\n\n' The self object for this script is the extension\n\n'Add the menu after the view's Theme menu \ntheMenuBar = av.GetProject.FindGUI(\"View\").GetMenuBar\nm = theMenuBar.FindByLabel(\"Theme\")\nif (m <> nil) then\n  'DC Sewer Design menu\n  theMenuBar.Add(self.Get(0), theMenuBar.getControls.find(m))    \nelse\n'DC Sewer Design menu\n  theMenuBar.Add(self.get(0), 999)\nend\n\n' add the buttons at the end of the butto
n bar\ntheViewButtonBar = av.GetProject.FindGUI(\"View\").getButtonBar\n\n' profile creation button\ntheViewButtonBar.add(self.get(1), 999)\n\nmbTable = av.getProject.findGUI(\"Table\").getMenuBar\n\nmenuTable = mbTable.findByLabel(\"Table\")\nif(menuTable <> nil)then\n  mbTable.add(self.get(2), mbTable.getControls.find(menuTable))\nelse\n  mbTable.add(self.get(2), 999)\nend\n\nav.getProject.findGUI(\"View\").setModified(true)\nav.getProject.findGUI(\"Table\").setModified(true)"
	FontSize:	1
)

(DocWin.159
	Owner:	158
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.160
)

(DocAct.161
	Doc:	158
)

(SEd.162
	Name:	"DCSewerDesignExtension.make"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:11:30 AM"
	GUIName:	"Script"
	Win:	163
	CSMgr:	164
	DocExts:	165
	Source:	"' DCSewerDesignExtension.make\n\nstrVersion = msgbox.input(\"Enter version\",\"Make DC Sewer Design Extension\",\"2.0.6\")\nif (strVersion=nil)then\n  exit\nend\nnumVersion=strVersion.asTokens(\".\").get(1).asNumber\nstrFileNameVersion = strVersion.asTokens(\".\").get(0)+\"_\"+strVersion.asTokens(\".\").get(1)\n\nmyExt = Extension.Make((\"$AVEXT\\dcsewdes.avx\").AsFileName,\n              \"DC Sewer Design\",\n              av.GetProject.FindScript(\"DCSewerDesignExtension.install\"),\n              av.GetProject.FindScript(\"DCSewerDesignE
xtension.uninstall\"),\n              {})\n\n\n'0\nmyExt.Add( av.GetProject.FindGUI(\"View\").GetMenuBar.findByLabel(\"DC Sewer\"))\n\n'1\nmyExt.Add( av.GetProject.FindGUI(\"View\").GetButtonBar.findByScript(\"DCSewerDesign.ComplexProfile.create\"))\n\n'2\nmyExt.add(av.getProject.findGUI(\"Table\").getMenuBar.findByLabel(\"DC Sewer\"))\n\n' Add to the extension the scripts that are attached to the menu items\n' The following line shows how this would work for one such scripts.\n' You may need several such lines.\nfor each d in av.getPr
oject.getDocs\n  if (d.is(SEd) and (d.getName.left(\"DCSewerDesign\".count+1)=\"DCSewerDesign.\"))then\n    myExt.add(d.getScript)\n  end\nend\n\nmyExt.SetAbout(\"Sewer Design Extension \"+strVersion+NL+\"(c) 2000-2004 DORSCH Consult.\"+NL+\n\"This extension is helpful to design sewer networks\")\nmyExt.SetExtVersion(numVersion)\nmyExt.setUnloadScript(av.findScript(\"DCSewerDesignExtension.unload\"))\nmyExt.setCanUnloadScript(av.findScript(\"DCSewerDesignExtension.canUnload\"))\nmyExt.Commit\n\nRFileName = FileName.make(\"$AVEXT/dcsew
des.avx\")\nWFileName = FileName.make(\"$AVEXT/dcsewdes.tmp\")\nRFile = LineFile.make(RFileName, #FILE_PERM_READ)\nWFile = LineFile.make(WFileName, #FILE_PERM_WRITE)\nWFile.setScratch(TRUE)\nwhile (RFile.isAtEnd.not)\n  buf = RFile.ReadElt\n  if ( buf.contains(\"ObjectTag:\").not) then\n    WFile.writeElt(buf)\n  end\nend\nRFile.close\nWFile.flush\nFile.copy(WFilename, RFilename)\nWFile.close"
	FontSize:	1
)

(DocWin.163
	Owner:	162
	X:	145
	Y:	194
	W:	886
	H:	752
)

(CSMgr.164
)

(DocAct.165
	Doc:	162
)

(SEd.166
	Name:	"DCSewerDesignExtension.uninstall"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:15:13 AM"
	GUIName:	"Script"
	Win:	167
	CSMgr:	168
	DocExts:	169
	Source:	"'DCSewerDesignExtension.uninstall\n\n'Make sure there is a project\nif (av.GetProject = nil) then\n  return nil\nend\n\n'Uninstall only if the project is not closing\nif (av.GetProject.IsClosing) then\n  return nil\nend\n\n'The self object for this script is the extension\n'The first root is the menu\n'The second root is the view\n'\n'Remove the menu \ntheMenubar = av.GetProject.FindGUI(\"View\").GetMenuBar\ntheMenuBar.remove(self.Get(0))\n\ntheViewButtonBar = av.GetProject.FindGUI(\"View\").getButtonBar\ntheViewButtonBar.remove(se
lf.get(1))\n\nmbTable = av.getProject.findGUI(\"Table\").getMenuBar\nmbTable.remove(self.get(2))\n\n"
	FontSize:	1
)

(DocWin.167
	Owner:	166
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.168
)

(DocAct.169
	Doc:	166
)

(SEd.170
	Name:	"DCSewerDesignExtension.unload"
	Creator:	"sdteffen"
	CreationDate:	"Saturday, February 26, 2000 10:57:29 AM"
	GUIName:	"Script"
	Win:	171
	CSMgr:	172
	DocExts:	173
	FontSize:	1
)

(DocWin.171
	Owner:	170
	X:	-4
	Y:	-4
	W:	1034
	H:	643
)

(CSMgr.172
)

(DocAct.173
	Doc:	170
)

(SEd.174
	Name:	"Script.saveAllScripts"
	Creator:	"sdteffen"
	CreationDate:	"Montag, 01. März 2004 11:23:03"
	GUIName:	"Script"
	Win:	175
	CSMgr:	176
	DocExts:	177
	Source:	"' Script.saveAllScripts\n\n' (c) 2004 DORSCH Consult\n\n' If the scripts are to be saved elsewhere, change the following line... \n\nstrSaveDir = \"c:\\data\\sandbox\\sourceforge\\dcwaterdesign\\dcsewdes\"\n\nif (File.exists(strSaveDir.asFilename).Not) then\n  MsgBox.Error(\"Working directory:\"++strSaveDir++\"does not exist\", \"\")\n  exit \nend\n\nlstScripts = List.make\n\n' find all scripts\n\nfor each docObj in av.getProject.getDocs\n  if (docObj.is(SEd)) then\n    lstScripts.Add(docObj)\n  end\nend\n\n' Loop over all scripts, write to f
iles\n\nblnOverwrite = nil\nnumWritten = 0\n	\nlstScriptsToWrite = List.make\n\nfor each sedScript in lstScripts\n\n  strSaveDir2 = strSaveDir.clone\n  strScriptName = sedScript.asString ' .substitute(\".\",\",\")\n   \n  flnScript = FileName.merge(strSaveDir2, strScriptName)\n  ' System.echo(flnScript.getFullName)\n  flnScript.setName(strScriptName+\".ave\")\n  if (flnScript.isFile) then\n    if(blnOverwrite = nil)then\n      blnOverwrite = MsgBox.YesNo(\"Overwrite files?\", \"Saving Scripts\", false)\n      if(blnOverwrite.not)then\n
        continue \n      end\n    end\n      \n    ' check if file has been changed\n    txfScript = TextFile.make(flnScript, #FILE_PERM_READ)\n    strFileSource = txfScript.read(txfScript.getSize)\n    blnChanged = false\n    if(strFileSource <> sedScript.getSource)then\n      blnChanged = true\n    end\n    txfScript.close\n    if(blnChanged)then\n    '  File.delete(flnScript)\n    else\n     continue\n    end\n  end \n  \n  txfScript = TextFile.make(flnScript, #FILE_PERM_WRITE)\n  if (txfScript <> nil) then\n    txfScript.wr
ite(sedScript.getSource, sedScript.getSource.count)\n    txfScript.close\n    numWritten = numWritten+1\n  else\n    MsgBox.warning(\"Unable to open file for writing:\"++flnScript.getFullName,\"Saving Scripts\")\n  end\nend\nMsgBox.info(numWritten.asString++\"Scripts were written.\", \"Saving Scripts\")\n"
	FontSize:	1
)

(DocWin.175
	Owner:	174
	X:	-4
	Y:	-4
	W:	1610
	H:	1075
)

(CSMgr.176
)

(DocAct.177
	Doc:	174
)

(LButn.178
	HelpTopic:	"New_button"
	Update:	"Doc.NewUpdate"
	Label:	"&New"
	Click:	"Script.New"
)

(LButn.179
	HelpTopic:	"Open_button"
	Update:	"Doc.OpenUpdate"
	Label:	"&Open"
	Click:	"Doc.Open"
)

(LButn.180
	HelpTopic:	"Run_button"
	Update:	"Script.ActionUpdate"
	Label:	"&Run"
	Click:	"Script.Action"
)

(FN.181
	Path:	"$AVEXT/cadview.avx"
)

(FN.182
	Path:	"$AVEXT/geoproc.avx"
)

(NameDict.183
)

(NameDict.184
	Obj:	185
	Obj:	186
	Obj:	187
)

(AVDict.185
	InternalName:	"Table of Contents Defaults Dialog"
)

(AVDict.186
	InternalName:	"_Thor_"
)

(AVDict.187
	InternalName:	"Geoprocessing"
	Key:	188
	Key:	189
	Value:	190
	Value:	191
)

(AVStr.188
	S:	"Loaded"
)

(AVStr.189
	S:	"Version"
)

(Bool.190
	Truth:	1
)

(Numb.191
	N:	3.10000000000000
)

(DocGUI.192
	Name:	"View"
	Type:	"View"
	Modified:	1
	Visible:	1
	MenuBar:	193
	ButnBar:	328
	Popups:	371
	ToolBar:	393
	NewScript:	"View.New"
	OpenScript:	"Doc.Open"
	ActionScript:	"Doc.Action"
	NewUpdateScript:	"Doc.NewUpdate"
	OpenUpdateScript:	"Doc.OpenUpdate"
	ActionUpdateScript:	"Doc.ActionUpdate"
	Title:	"Views"
	Icon:	470
)

(MenuBar.193
	Child:	194
	Child:	211
	Child:	231
	Child:	255
	Child:	273
	Child:	296
	Child:	312
	Child:	323
)

(PMenu.194
	InternalName:	"File"
	Child:	195
	Child:	196
	Child:	197
	Child:	198
	Child:	199
	Child:	200
	Child:	201
	Child:	202
	Child:	203
	Child:	204
	Child:	205
	Child:	206
	Child:	207
	Child:	208
	Child:	209
	Child:	210
	Label:	"&File"
)

(Choice.195
	Help:	"Closes the active component"
	HelpTopic:	"Close"
	Label:	"&Close"
	Click:	"Project.CloseDoc"
	Shortcut:	"Keys.None"
)

(Choice.196
	Help:	"Closes all components"
	HelpTopic:	"Close_All"
	Label:	"Close &All"
	Click:	"Project.CloseAll"
	Shortcut:	"Keys.None"
)

(Space.197
)

(Choice.198
	Help:	"Allows you to specify the current working directory"
	HelpTopic:	"Set_Working_Directory"
	Label:	"Set &Working Directory..."
	Click:	"Project.SetProjectWorkDir"
	Shortcut:	"Keys.None"
)

(Choice.199
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.200
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.201
)

(Choice.202
	Help:	"Displays the Extensions dialog"
	HelpTopic:	"Extensions"
	Label:	"Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.203
)

(Choice.204
	Help:	"Prints the view"
	HelpTopic:	"Print"
	Label:	"&Print..."
	Click:	"View.Print"
	Shortcut:	"Keys.None"
)

(Choice.205
	Help:	"Edits the printer and the printing options"
	HelpTopic:	"Print_Setup"
	Label:	"P&rint Setup..."
	Click:	"Project.PrintSetup"
	Shortcut:	"Keys.None"
)

(Choice.206
	Help:	"Exports the view"
	HelpTopic:	"Export"
	Update:	"View.HasThemesUpdate"
	Label:	"&Export..."
	Click:	"View.ExportDisp"
	Shortcut:	"Keys.None"
)

(Space.207
)

(Choice.208
	Help:	"Displays the dialog box to delete, edit, and copy data sources"
	HelpTopic:	"Manage_Sources"
	Label:	"&Manage Data Sources..."
	Click:	"View.ManageSources"
	Shortcut:	"Keys.None"
)

(Space.209
)

(Choice.210
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.211
	InternalName:	"Edit"
	Child:	212
	Child:	213
	Child:	214
	Child:	215
	Child:	216
	Child:	217
	Child:	218
	Child:	219
	Child:	220
	Child:	221
	Child:	222
	Child:	223
	Child:	224
	Child:	225
	Child:	226
	Child:	227
	Child:	228
	Child:	229
	Child:	230
	Label:	"&Edit"
)

(Choice.212
	Help:	"Cuts the active themes to the clipboard"
	HelpTopic:	"Cut_Themes"
	Update:	"View.ActiveDeletableThemesUpdate"
	Label:	"Cut T&hemes"
	Click:	"View.CutThemes"
	Shortcut:	"Keys.None"
)

(Choice.213
	Help:	"Copies the active themes to the clipboard"
	HelpTopic:	"Copy_Themes"
	Update:	"View.ActiveThemesUpdate"
	Label:	"Cop&y Themes"
	Click:	"View.CopyThemes"
	Shortcut:	"Keys.None"
)

(Choice.214
	Help:	"Removes the active themes from the view"
	HelpTopic:	"Delete_Themes"
	Update:	"View.ActiveDeletableThemesUpdate"
	Label:	"De&lete Themes"
	Click:	"View.DeleteThemes"
	Shortcut:	"Keys.None"
)

(Space.215
)

(Choice.216
	Disabled:	1
	Help:	"Undo the last edit to graphics on a view"
	HelpTopic:	"Undo_Graphic_Edit_on_a_view"
	Update:	"View.UndoEditUpdate"
	Label:	"&Undo Graphic Edit"
	Click:	"View.UndoEdit"
	Shortcut:	"Keys.Ctrl+Z"
)

(Choice.217
	Disabled:	1
	Invisible:	1
	Help:	"Redo the last edit operation on a theme that was undone"
	HelpTopic:	"Redo_Feature_Edit_on_a_view"
	Update:	"View.RedoEditUpdate"
	Label:	"&Redo Feature Edit"
	Click:	"View.RedoEdit"
	Shortcut:	"Keys.Ctrl+Y"
)

(Space.218
)

(Choice.219
	Disabled:	1
	Help:	"Cuts the selected graphics to the clipboard"
	HelpTopic:	"Cut_Graphics"
	Update:	"View.CutUpdate"
	Label:	"Cu&t Graphics"
	Click:	"View.CutGraphics"
	Shortcut:	"Keys.Ctrl+X"
)

(Choice.220
	Disabled:	1
	Help:	"Copies the selected graphics to the clipboard"
	HelpTopic:	"Copy_Graphics"
	Update:	"View.CopyUpdate"
	Label:	"&Copy Graphics"
	Click:	"View.CopyGraphics"
	Shortcut:	"Keys.Ctrl+C"
)

(Choice.221
	Disabled:	1
	Help:	"Removes the selected graphics from the view"
	HelpTopic:	"Delete_Graphics"
	Update:	"View.DeleteUpdate"
	Label:	"&Delete Graphics"
	Click:	"View.DeleteGraphics"
	Shortcut:	"Keys.Del"
)

(Space.222
)

(Choice.223
	Disabled:	1
	Help:	"Combines the selected polygons"
	HelpTopic:	"Combine_Graphics"
	Update:	"View.CombineUpdate"
	Label:	"Com&bine Graphics"
	Click:	"View.CombineGraphics"
	Shortcut:	"Keys.None"
)

(Choice.224
	Disabled:	1
	Help:	"Unions the selected graphics to create a new graphic"
	HelpTopic:	"Union_Graphics"
	Update:	"View.UnionUpdate"
	Label:	"U&nion Graphics"
	Click:	"View.UnionGraphics"
	Shortcut:	"Keys.None"
)

(Choice.225
	Disabled:	1
	Help:	"Subtracts one selected polygon from the other selected polygon"
	HelpTopic:	"Subtract_Graphics"
	Update:	"View.SubtractUpdate"
	Label:	"&Subtract Graphics"
	Click:	"View.SubtractGraphics"
	Shortcut:	"Keys.None"
)

(Choice.226
	Disabled:	1
	Help:	"Creates a new polygon from the area  of overlap between the selected polygons"
	HelpTopic:	"Intersect_Graphics"
	Update:	"View.IntersectUpdate"
	Label:	"&Intersect Graphics"
	Click:	"View.IntersectGraphics"
	Shortcut:	"Keys.None"
)

(Space.227
)

(Choice.228
	Help:	"Inserts the contents of the clipboard"
	HelpTopic:	"Paste"
	Update:	"View.PasteUpdate"
	Label:	"&Paste"
	Click:	"View.Paste"
	Shortcut:	"Keys.Ctrl+V"
)

(Space.229
)

(Choice.230
	Disabled:	1
	Help:	"Selects all graphics in the view"
	HelpTopic:	"Select_All_Graphics"
	Update:	"View.HasGraphicsUpdate"
	Label:	"Select &All Graphics"
	Click:	"Graphic.SelectAll"
	Shortcut:	"Keys.None"
)

(PMenu.231
	InternalName:	"View"
	Child:	232
	Child:	233
	Child:	234
	Child:	235
	Child:	236
	Child:	237
	Child:	238
	Child:	239
	Child:	240
	Child:	241
	Child:	242
	Child:	243
	Child:	244
	Child:	245
	Child:	246
	Child:	247
	Child:	248
	Child:	249
	Child:	250
	Child:	251
	Child:	252
	Child:	253
	Child:	254
	Label:	"&View"
)

(Choice.232
	Help:	"Displays the dialog box to edit properties of the view"
	HelpTopic:	"View_Properties"
	Label:	"&Properties..."
	Click:	"View.Properties"
	Shortcut:	"Keys.None"
)

(Space.233
)

(Choice.234
	Help:	"Inserts themes into the view"
	HelpTopic:	"Add_Theme"
	Label:	"&Add Theme..."
	Click:	"View.Add"
	Shortcut:	"Keys.Ctrl+T"
)

(Choice.235
	Disabled:	1
	Help:	"Displays a dialog box to create a geocoded theme"
	HelpTopic:	"Geocode_Addresses"
	Update:	"View.GeocodeUpdate"
	Label:	"&Geocode Addresses..."
	Click:	"View.Geocode"
	Shortcut:	"Keys.None"
)

(Choice.236
	Help:	"Displays a dialog box to create an XY or dynamic segmentation event-based theme "
	HelpTopic:	"Add_Event_Theme"
	Update:	"View.AddEventUpdate"
	Label:	"Add &Event Theme..."
	Click:	"View.AddEvent"
	Shortcut:	"Keys.None"
)

(Choice.237
	Help:	"Creates a new theme"
	HelpTopic:	"New_Theme"
	Label:	"&New Theme..."
	Click:	"View.NewTheme"
	Shortcut:	"Keys.None"
)

(Choice.238
	Help:	"Makes all themes visible"
	HelpTopic:	"Themes_On_Themes_Off"
	Update:	"View.HasThemesUpdate"
	Label:	"&Themes On"
	Click:	"View.ThemesOn"
	Shortcut:	"Keys.None"
)

(Choice.239
	Help:	"Makes all themes invisible"
	HelpTopic:	"Themes_On_Themes_Off"
	Update:	"View.HasThemesUpdate"
	Label:	"T&hemes Off"
	Click:	"View.ThemesOff"
	Shortcut:	"Keys.None"
)

(Space.240
)

(Choice.241
	Help:	"Create a Layout from the View"
	HelpTopic:	"Layout_menu_choice"
	Update:	"View.HasThemesUpdate"
	Label:	"La&yout..."
	Click:	"View.Layout"
	Shortcut:	"Keys.None"
)

(Space.242
)

(Choice.243
	Help:	"Shows a dialog where you can change the style of the TOC"
	HelpTopic:	"TOC_Defaults"
	Update:	"TocDefs.ShowUpdate"
	Label:	"TOC Style..."
	Click:	"TocDefs.Show"
	Shortcut:	"Keys.None"
)

(Space.244
)

(Choice.245
	Help:	"Zooms to the extent of all themes"
	HelpTopic:	"Zoom_to_Full_Extent"
	Update:	"View.HasDataUpdate"
	Label:	"Full E&xtent"
	Click:	"View.ZoomFullExtent"
	Shortcut:	"Keys.None"
)

(Choice.246
	Help:	"Zooms in on the center of the display"
	HelpTopic:	"Zoom_In"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom &In"
	Click:	"View.ZoomIn"
	Shortcut:	"Keys.None"
)

(Choice.247
	Help:	"Zooms out from the center of the display"
	HelpTopic:	"Zoom_Out"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom &Out"
	Click:	"View.ZoomOut"
	Shortcut:	"Keys.None"
)

(Choice.248
	Help:	"Zooms to the extent of active themes"
	HelpTopic:	"Zoom_to_Active_Theme"
	Update:	"View.ActiveThemesUpdate"
	Label:	"&Zoom To Themes"
	Click:	"View.ZoomToThemes"
	Shortcut:	"Keys.None"
)

(Choice.249
	Help:	"Zooms to the extent of the selected features"
	HelpTopic:	"Zoom_to_Selected"
	Update:	"View.SelectableThemesUpdate"
	Label:	"Zoom To &Selected"
	Click:	"View.ZoomToSelected"
	Shortcut:	"Keys.None"
)

(Choice.250
	Help:	"Goes back to the previous extent you were viewing"
	HelpTopic:	"Zoom_Previous"
	Update:	"View.UndoZoomUpdate"
	Label:	"Zoom Pre&vious"
	Click:	"View.UndoZoom"
	Shortcut:	"Keys.None"
)

(Space.251
)

(Choice.252
	Help:	"Finds features in the active themes using the text you enter"
	HelpTopic:	"Find"
	Update:	"View.TabularThemesUpdate"
	Label:	"&Find..."
	Click:	"View.Find"
	Shortcut:	"Keys.Ctrl+F"
)

(Choice.253
	Disabled:	1
	Help:	"Locates an address in the active, matchable theme"
	HelpTopic:	"Locate_Address"
	Update:	"View.LocateUpdate"
	Label:	"&Locate Address..."
	Click:	"View.Locate"
	Shortcut:	"Keys.None"
)

(Choice.254
	InternalName:	"GeoProc"
	Help:	"Opens the GeoProcessing Wizard"
	HelpTopic:	"geoproc_choice"
	Tag:	"GeoProcessing"
	Update:	"GeoProc.Main.Show Update"
	Label:	"GeoProcessing Wizard..."
	Click:	"GeoProc.Show"
	Shortcut:	"Keys.None"
)

(PMenu.255
	Child:	256
	Child:	257
	Child:	258
	Child:	259
	Child:	260
	Child:	261
	Child:	262
	Child:	263
	Child:	264
	Child:	265
	Child:	266
	Child:	267
	Child:	268
	Child:	269
	Child:	270
	Child:	271
	Child:	272
	Label:	"DC Sewer"
)

(Choice.256
	Label:	"Create Excel calculation"
	Click:	"DCSewerDesign.createXlsSewerCalculation"
	Shortcut:	"Keys.None"
)

(Choice.257
	Help:	"calculates the population connected to every sewer section with a network trace"
	Label:	"Accumulate Population"
	Click:	"DCSewerDesign.accumulatePopulation"
	Shortcut:	"Keys.None"
)

(Choice.258
	Help:	"accumulates the maximum branch length for a tree of sewer lines"
	Label:	"Accumulate Branch Length"
	Click:	"DCSewerDesign.accumulateBranchLength"
	Shortcut:	"Keys.None"
)

(Choice.259
	Label:	"Calculate Minimum Elevation Differences"
	Click:	"DCSewerDesign.calculateMinimumElevationDifferences"
	Shortcut:	"Keys.None"
)

(Choice.260
	Label:	"Flip Lines to Flow Direction"
	Click:	"DCSewerDesign.flipLinesToFlowDirection"
	Shortcut:	"Keys.None"
)

(Choice.261
	Disabled:	1
	Help:	"Calculates the Maximum Manhole Elevations for each line based on minimum cover and a given gradient."
	Update:	"DCSewerDesign.calculateMaximumManholeElevations.update"
	Label:	"Calculate Maximum Manhole Elevations"
	Click:	"DCSewerDesign.calculateMaximumManholeElevations"
	Shortcut:	"Keys.None"
)

(Choice.262
	Label:	"Enforce Drainage"
	Click:	"DCSewerDesign.enforceDrainage"
	Shortcut:	"Keys.None"
)

(Choice.263
	Label:	"Export Basys Ascii File"
	Click:	"DCSewerDesign.exportBasysFile"
	Shortcut:	"Keys.None"
)

(Choice.264
	Help:	"checks if the Lines contain only two vertexes"
	Label:	"Validate Lines"
	Click:	"DCSewerDesign.Lines.validate"
	Shortcut:	"Keys.None"
)

(Choice.265
	Help:	"Create a profile (L-Section) for the selected lines.//Create a profile for the selected lines."
	Label:	"Create Profile"
	Click:	"DCSewerDesign.ComplexProfile.create"
	Shortcut:	"Keys.None"
)

(Choice.266
	Help:	"Select the profile configuration file"
	Label:	"Select Profile Configuration"
	Click:	"DCSewerDesign.ComplexProfile.selectConfigurationFile"
	Shortcut:	"Keys.None"
)

(Choice.267
	Disabled:	1
	Update:	"DCSewerDesign.Profile.linkToLayout.update"
	Label:	"Link Profile to Layout"
	Click:	"DCSewerDesign.Profile.linkToLayout"
	Shortcut:	"Keys.None"
)

(Choice.268
	Help:	"transfer Manhole Data Fields to Upstream/Downstream Fields in the Line Table"
	Label:	"Manhole Data  to Line"
	Click:	"DCSewerDesign.Lines.takeoverManholeData"
	Shortcut:	"Keys.None"
)

(Choice.269
	Help:	"transfer data from the line theme to the manhole theme"
	Label:	"Line Data to Manholes"
	Click:	"DCSewerDesign.Manholes.takeoverLineData"
	Shortcut:	"Keys.None"
)

(Choice.270
	Label:	"Create Dbf Sewer Calculation"
	Click:	"DCSewerDesign.createDbfSewerCalculation"
	Shortcut:	"Keys.None"
)

(Choice.271
	Label:	"Assign Minimum Values from Points to Lines using Buffer"
	Click:	"DCSewerDesign.Lines.takeoverMinimumValuesFromBuffer"
	Shortcut:	"Keys.None"
)

(Choice.272
	Help:	"DC Sewer Design Extension Help//DC Sewer Design Extension Help"
	Label:	"Help"
	Click:	"DCSewerDesign.Help.openCHM"
	Shortcut:	"Keys.None"
)

(PMenu.273
	InternalName:	"Theme"
	Child:	274
	Child:	275
	Child:	276
	Child:	277
	Child:	278
	Child:	279
	Child:	280
	Child:	281
	Child:	282
	Child:	283
	Child:	284
	Child:	285
	Child:	286
	Child:	287
	Child:	288
	Child:	289
	Child:	290
	Child:	291
	Child:	292
	Child:	293
	Child:	294
	Child:	295
	Label:	"&Theme"
)

(Choice.274
	Help:	"Displays the dialog box to edit properties of the active theme"
	HelpTopic:	"Theme_Properties"
	Update:	"View.ActiveThemesUpdate"
	Label:	"&Properties..."
	Click:	"View.ThemeProperties"
	Shortcut:	"Keys.None"
)

(Space.275
)

(Choice.276
	Help:	"Starts or stops editing of shapefile"
	HelpTopic:	"Start_Stop_Editing_in_a_view"
	Update:	"View.ToggleEditingUpdate"
	Label:	"Start &Editing"
	Click:	"View.ToggleEditing"
	Shortcut:	"Keys.None"
)

(Choice.277
	Disabled:	1
	Help:	"Save edits to the source shapefile"
	HelpTopic:	"Save_edits_theme"
	Update:	"View.SaveEditsUpdate"
	Label:	"Save Ed&its"
	Click:	"View.SaveEdits"
	Shortcut:	"Keys.None"
)

(Choice.278
	Disabled:	1
	Help:	"Saves edits to a new shapefile"
	HelpTopic:	"Save_edits_as_theme"
	Update:	"View.SaveEditsUpdate"
	Label:	"Save E&dits As..."
	Click:	"View.SaveEditsAs"
	Shortcut:	"Keys.None"
)

(Choice.279
	Help:	"Converts a theme to a shapefile"
	HelpTopic:	"Convert_to_Shapefile"
	Update:	"View.ExportUpdate"
	Label:	"Convert to &Shapefile..."
	Click:	"View.Export"
	Shortcut:	"Keys.None"
)

(Space.280
)

(Choice.281
	Help:	"Displays the legends of the active themes"
	HelpTopic:	"Edit_Legend"
	Update:	"View.ActiveThemesUpdate"
	Label:	"Edit &Legend..."
	Click:	"View.EditLegendClick"
	Shortcut:	"Keys.None"
)

(Choice.282
	Help:	"Shows or hides the active themes' legends"
	HelpTopic:	"Hide_show_Legend"
	Update:	"View.ActiveThemesUpdate"
	Label:	"&Hide/Show Legend"
	Click:	"View.ToggleLegend"
	Shortcut:	"Keys.None"
)

(Space.283
)

(Choice.284
	Disabled:	1
	Help:	"Displays the Re-match dialog for re-matching addresses"
	HelpTopic:	"Re_match_Addresses"
	Update:	"View.EditMatchUpdate"
	Label:	"&Re-match Addresses..."
	Click:	"View.EditMatch"
	Shortcut:	"Keys.None"
)

(Space.285
)

(Choice.286
	Help:	"Labels features in active, visible themes"
	HelpTopic:	"Auto_label"
	Update:	"View.LabelThemesUpdate"
	Label:	"&Auto-label..."
	Click:	"View.LabelThemes"
	Shortcut:	"Keys.Ctrl+L"
)

(Choice.287
	Disabled:	1
	Help:	"Removes any labels from active themes"
	HelpTopic:	"Remove_Labels"
	Update:	"View.RemoveThemeLabelsUpdate"
	Label:	"Rem&ove Labels"
	Click:	"View.RemoveThemeLabels"
	Shortcut:	"Keys.Ctrl+R"
)

(Choice.288
	Disabled:	1
	Help:	"Removes the overlapping labels from active themes, if they are still green."
	HelpTopic:	"Remove_Overlapping_Labels"
	Update:	"View.RemoveOverlapThemeLabelsUpdate"
	Label:	"Remove Overlappi&ng Labels"
	Click:	"View.RemoveOverlapThemeLabels"
	Shortcut:	"Keys.None"
)

(Choice.289
	Disabled:	1
	Help:	"Converts selected overlapping labels to symbol of selected good label"
	HelpTopic:	"Convert_Overlapping_Labels"
	Update:	"View.ConvertOverlapLabelsUpdate"
	Label:	"&Convert Overlapping Labels"
	Click:	"View.ConvertOverlapLabels"
	Shortcut:	"Keys.Ctrl+O"
)

(Space.290
)

(Choice.291
	Help:	"Opens the tables of the active themes"
	HelpTopic:	"Open_Theme_Table"
	Update:	"View.TabularThemesUpdate"
	Label:	"&Table..."
	Click:	"View.ShowTable"
	Shortcut:	"Keys.None"
)

(Choice.292
	Help:	"Displays the Query Builder to select features with a logical expression"
	HelpTopic:	"Query_Builder"
	Update:	"View.AttributeThemesUpdate"
	Label:	"&Query..."
	Click:	"View.Query"
	Shortcut:	"Keys.Ctrl+Q"
)

(Choice.293
	Help:	"Selects features in the active themes using another theme's features"
	HelpTopic:	"Select_By_Theme"
	Update:	"View.SelectableThemesUpdate"
	Label:	"Select &By Theme..."
	Click:	"View.SelectByTheme"
	Shortcut:	"Keys.None"
)

(Choice.294
	Help:	"Creates buffers around features"
	HelpTopic:	"Create_Buffer_Choice"
	Update:	"WizardBuffer.OpenDialogUpdate"
	Label:	"Create Buffers..."
	Click:	"WizardBuffer.OpenDialog"
	Shortcut:	"Keys.None"
)

(Choice.295
	Help:	"Unselects the selected features of all active themes"
	HelpTopic:	"Clear_Selected_Features"
	Update:	"View.AttributeThemesUpdate"
	Label:	"Clear Selected &Features"
	Click:	"View.ClearSelect"
	Shortcut:	"Keys.None"
)

(PMenu.296
	InternalName:	"Graphics"
	Child:	297
	Child:	298
	Child:	299
	Child:	300
	Child:	301
	Child:	302
	Child:	303
	Child:	304
	Child:	305
	Child:	306
	Child:	307
	Child:	308
	Child:	309
	Child:	310
	Child:	311
	Label:	"&Graphics"
)

(Choice.297
	Disabled:	1
	Help:	"Displays the property editor for the selected graphic"
	HelpTopic:	"Graphic_Properties"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"&Properties..."
	Click:	"Graphic.Edit"
	Shortcut:	"Keys.None"
)

(Space.298
)

(Choice.299
	Help:	"Shows a dialog where you can set the default values for the label and text tools"
	HelpTopic:	"Default_settings_for_text_and_label_tools"
	Label:	"&Text and Label Defaults..."
	Click:	"Graphic.Label Defaults Show"
	Shortcut:	"Keys.None"
)

(Space.300
)

(Choice.301
	Disabled:	1
	Help:	"Displays a dialog box to adjust size and position of selected graphic"
	HelpTopic:	"Size_and_Position"
	Update:	"Graphic.SingleSelectionUpdate"
	Label:	"&Size and Position..."
	Click:	"Graphic.SizePos"
	Shortcut:	"Keys.None"
)

(Choice.302
	Disabled:	1
	Help:	"Aligns the selected graphics"
	HelpTopic:	"Align"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"&Align..."
	Click:	"Graphic.Align"
	Shortcut:	"Keys.Ctrl+A"
)

(Space.303
)

(Choice.304
	Disabled:	1
	Help:	"Moves selected graphics in front of other graphics"
	HelpTopic:	"Bring_to_Front_on_a_view"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"Bring to &Front"
	Click:	"Graphic.ToFront"
	Shortcut:	"Keys.None"
)

(Choice.305
	Disabled:	1
	Help:	"Moves selected graphics behind other graphics"
	HelpTopic:	"Send_to_Back_on_a_view"
	Update:	"Graphic.HasSelectionUpdate"
	Label:	"Send to &Back "
	Click:	"Graphic.ToBack"
	Shortcut:	"Keys.None"
)

(Choice.306
	Disabled:	1
	Help:	"Groups selected graphics"
	HelpTopic:	"Group_on_a_view"
	Update:	"Graphic.GroupUpdate"
	Label:	"&Group"
	Click:	"Graphic.Group"
	Shortcut:	"Keys.Ctrl+G"
)

(Choice.307
	Disabled:	1
	Help:	"Ungroups selected graphics"
	HelpTopic:	"Ungroup_on_a_view"
	Update:	"Graphic.UngroupUpdate"
	Label:	"&Ungroup"
	Click:	"Graphic.Ungroup"
	Shortcut:	"Keys.Ctrl+U"
)

(Space.308
)

(Choice.309
	Disabled:	1
	Help:	"Associates selected graphics with active themes"
	HelpTopic:	"Attach_Graphics"
	Update:	"View.AddGraphicsUpdate"
	Label:	"A&ttach Graphics"
	Click:	"View.AddGraphics"
	Shortcut:	"Keys.None"
)

(Choice.310
	Disabled:	1
	Help:	"Removes association between graphics and active themes"
	HelpTopic:	"Detach_Graphics"
	Update:	"View.ClearGraphicsUpdate"
	Label:	"&Detach Graphics"
	Click:	"View.ClearGraphics"
	Shortcut:	"Keys.None"
)

(Space.311
)

(PMenu.312
	InternalName:	"Window"
	Child:	313
	Child:	314
	Child:	315
	Child:	316
	Child:	317
	Child:	318
	Child:	320
	Child:	321
	Child:	322
	Label:	"&Window"
)

(Choice.313
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.314
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.315
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.316
)

(Choice.317
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.318
	ObjectTag:	319
	Update:	"WindowMenuUpdate"
)

(AVStr.319
	S:	"dcsewerdesign.apr DCSewerDesign.NetworkCalculator.calculate View1"
)

(Choice.320
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.321
	Help:	"Activates DCSewerDesign.NetworkCalculator.calculate"
	Label:	"&2 DCSewerDesign.NetworkCalculator.calculate"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.322
	Help:	"Activates View1"
	Label:	"&3 View1"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.323
	InternalName:	"Help"
	Child:	324
	Child:	325
	Child:	326
	Child:	327
	Label:	"&Help"
)

(Choice.324
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.325
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help..."
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.326
)

(Choice.327
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(ButnBar.328
	Child:	329
	Child:	331
	Child:	332
	Child:	334
	Child:	335
	Child:	337
	Child:	339
	Child:	341
	Child:	342
	Child:	344
	Child:	346
	Child:	348
	Child:	349
	Child:	351
	Child:	353
	Child:	355
	Child:	357
	Child:	359
	Child:	361
	Child:	362
	Child:	364
	Child:	366
	Child:	367
	Child:	369
)

(Butn.329
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	330
	Click:	"Project.Save"
)

(AVIcon.330
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.331
)

(Butn.332
	Help:	"Add Theme//Inserts themes into the view"
	HelpTopic:	"Add_Theme"
	Icon:	333
	Click:	"View.Add"
)

(AVIcon.333
	Name:	"AddTheme"
	Res:	"Icons.AddTheme"

)

(Space.334
)

(Butn.335
	Help:	"Theme Properties//Displays the dialog box to edit properties of the active theme"
	HelpTopic:	"Theme_Properties"
	Update:	"View.ActiveThemesUpdate"
	Icon:	336
	Click:	"View.ThemeProperties"
)

(AVIcon.336
	Name:	"Props"
	Res:	"Icons.Props"

)

(Butn.337
	Help:	"Edit Legend//Displays the legends of the active themes"
	HelpTopic:	"Edit_Legend"
	Update:	"View.ActiveThemesUpdate"
	Icon:	338
	Click:	"View.EditLegendClick"
)

(AVIcon.338
	Name:	"Legend"
	Res:	"Icons.Legend"

)

(Butn.339
	Help:	"Open Theme Table//Opens the tables of the active themes"
	HelpTopic:	"Open_Theme_Table"
	Update:	"View.TabularThemesUpdate"
	Icon:	340
	Click:	"View.ShowTable"
)

(AVIcon.340
	Name:	"Table"
	Res:	"Icons.Table"

)

(Space.341
)

(Butn.342
	Help:	"Find//Finds features in the active themes using the text you enter"
	HelpTopic:	"Find"
	Update:	"View.TabularThemesUpdate"
	Icon:	343
	Click:	"View.Find"
)

(AVIcon.343
	Name:	"Find"
	Res:	"Icons.Find"

)

(Butn.344
	Disabled:	1
	Help:	"Locate Address//Locates an address in the active, matchable theme"
	HelpTopic:	"Locate_Address"
	Update:	"View.LocateUpdate"
	Icon:	345
	Click:	"View.Locate"
)

(AVIcon.345
	Name:	"AddMatch"
	Res:	"Icons.AddMatch"

)

(Butn.346
	Help:	"Query Builder//Displays the Query Builder to select features with a logical expression"
	HelpTopic:	"Query_Builder"
	Update:	"View.AttributeThemesUpdate"
	Icon:	347
	Click:	"View.Query"
)

(AVIcon.347
	Name:	"QueryBuilder"
	Res:	"Icons.QueryBuilder"

)

(Space.348
)

(Butn.349
	Help:	"Zoom to Full Extent//Zooms to the extent of all themes"
	HelpTopic:	"Zoom_to_Full_Extent"
	Update:	"View.HasDataUpdate"
	Icon:	350
	Click:	"View.ZoomFullExtent"
)

(AVIcon.350
	Name:	"ZoomView"
	Res:	"Icons.ZoomView"

)

(Butn.351
	Help:	"Zoom to Active Theme(s)//Zooms to the extent of active themes"
	HelpTopic:	"Zoom_to_Active_Theme"
	Update:	"View.ActiveThemesUpdate"
	Icon:	352
	Click:	"View.ZoomToThemes"
)

(AVIcon.352
	Name:	"ZoomTheme"
	Res:	"Icons.ZoomTheme"

)

(Butn.353
	Help:	"Zoom to Selected//Zooms to the extent of the selected features"
	HelpTopic:	"Zoom_to_Selected"
	Update:	"View.SelectableThemesUpdate"
	Icon:	354
	Click:	"View.ZoomToSelected"
)

(AVIcon.354
	Name:	"ZoomToSelected"
	Res:	"Icons.ZoomToSelected"

)

(Butn.355
	Help:	"Zoom In//Zooms in on the center of the display"
	HelpTopic:	"Zoom_In"
	Update:	"View.HasDataUpdate"
	Icon:	356
	Click:	"View.ZoomIn"
)

(AVIcon.356
	Name:	"ZoomIn"
	Res:	"Icons.ZoomIn"

)

(Butn.357
	Help:	"Zoom Out//Zooms out from the center of the display"
	HelpTopic:	"Zoom_Out"
	Update:	"View.HasDataUpdate"
	Icon:	358
	Click:	"View.ZoomOut"
)

(AVIcon.358
	Name:	"ZoomOut"
	Res:	"Icons.ZoomOut"

)

(Butn.359
	Help:	"Zoom to Previous Extent//Goes back to the previous extent you were viewing"
	HelpTopic:	"Zoom_Previous"
	Update:	"View.UndoZoomUpdate"
	Icon:	360
	Click:	"View.UndoZoom"
)

(AVIcon.360
	Name:	"ZoomPrevious"
	Res:	"Icons.ZoomPrevious"

)

(Space.361
)

(Butn.362
	Disabled:	1
	Help:	"Select Features Using Graphic//Selects features in active themes using selected graphics"
	HelpTopic:	"Select_Features_Using_Graphic"
	Update:	"View.SpatialSelectUpdate"
	Icon:	363
	Click:	"View.SpatialSelect"
)

(AVIcon.363
	Name:	"SpatialSelect"
	Res:	"Icons.SpatialSelect"

)

(Butn.364
	Help:	"Clear Selected Features//Unselects the selected features of all active themes"
	HelpTopic:	"Clear_Selected_Features"
	Update:	"View.AttributeThemesUpdate"
	Icon:	365
	Click:	"View.ClearSelect"
)

(AVIcon.365
	Name:	"SelectNone"
	Res:	"Icons.SelectNone"

)

(Space.366
)

(Butn.367
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	368
	Click:	"Help.Tool"
)

(AVIcon.368
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(Butn.369
	Icon:	370
	Click:	"DCSewerDesign.ComplexProfile.create"
)

(AVIcon.370
	Name:	"Profile"
	Res:	"Icons.Profile"

)

(PopupSet.371
	Child:	372
)

(Popup.372
	Child:	373
	Child:	374
	Child:	375
	Child:	376
	Child:	377
	Child:	378
	Child:	379
	Child:	380
	Child:	381
	Child:	382
	Child:	383
	Child:	384
	Child:	385
	Child:	386
	Child:	387
	Child:	388
	Child:	389
	Child:	390
	Child:	391
	Child:	392
	Label:	"Menu"
)

(Choice.373
	Disabled:	1
	Invisible:	1
	Help:	"Deletes the last entered point on the line or polygon being drawn"
	Update:	"View.DelLastPointUpdate"
	Label:	"Delete Last Point"
	Click:	"View.DeleteLastPoint"
	Shortcut:	"Keys.None"
)

(Choice.374
	Disabled:	1
	Help:	"Undo the last edit to features in a theme"
	HelpTopic:	"Undo_Feature_Edit_on_a_view"
	Update:	"View.UndoEditUpdate"
	Label:	"Undo Feature Edit"
	Click:	"View.UndoEdit"
	Shortcut:	"Keys.None"
)

(Choice.375
	Disabled:	1
	Help:	"Redo the last edit operation on a theme that was undone"
	Update:	"View.RedoEditUpdate"
	Label:	"Redo Feature Edit"
	Click:	"View.RedoEdit"
	Shortcut:	"Keys.None"
)

(Space.376
)

(Choice.377
	Help:	"Turns general snapping on"
	Update:	"View.ToggleGeneralSnapUpdate"
	Label:	"Enable General Snapping"
	Click:	"View.ToggleGeneralSnap"
	Shortcut:	"Keys.None"
)

(Choice.378
	Help:	"Turns interactive snapping on"
	Update:	"View.ToggleInteractiveSnapUpdate"
	Label:	"Enable Interactive Snapping"
	Click:	"View.ToggleInteractiveSnap"
	Shortcut:	"Keys.None"
)

(Choice.379
	Help:	"Turns snap tolerance cursor off"
	Update:	"View.ToggleTolCursorUpdate"
	Label:	"Hide Snap Tolerance Cursor"
	Click:	"View.ToggleTolCursor"
	Shortcut:	"Keys.None"
)

(Space.380
)

(Choice.381
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest vertex within the user tolerance"
	Update:	"View.InteractiveSnapUpdate"
	Label:	"Snap to Vertex"
	Click:	"View.SnapToVertex"
	Shortcut:	"Keys.None"
)

(Choice.382
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest line segment"
	Update:	"View.InteractiveSnapUpdate"
	Label:	"Snap to Boundary"
	Click:	"View.SnapToBoundary"
	Shortcut:	"Keys.None"
)

(Choice.383
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest node common to two or more features"
	Update:	"View.InteractiveSnapUpdate"
	Label:	"Snap to Intersection"
	Click:	"View.SnapToIntersection"
	Shortcut:	"Keys.None"
)

(Choice.384
	Disabled:	1
	Invisible:	1
	Help:	"Snaps the next entered point to the nearest endpoint of an existing line"
	Update:	"View.SnapToEndPointUpdate"
	Label:	"Snap to Endpoint"
	Click:	"View.SnapToEndPoint"
	Shortcut:	"Keys.None"
)

(Space.385
)

(Choice.386
	Help:	"Unselects the selected features in all active themes"
	Update:	"View.AttributeThemesUpdate"
	Label:	"Clear Selection"
	Click:	"View.ClearSelect"
	Shortcut:	"Keys.None"
)

(Choice.387
	Help:	"Zooms in at point where you click to bring up popup menu"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom In"
	Click:	"View.PopupZoomIn"
	Shortcut:	"Keys.None"
)

(Choice.388
	Help:	"Zooms out from point where you click to bring up popup menu"
	Update:	"View.HasDataUpdate"
	Label:	"Zoom Out"
	Click:	"View.PopupZoomOut"
	Shortcut:	"Keys.None"
)

(Choice.389
	Help:	"Zooms to the extent of the selected features"
	Update:	"View.SelectableThemesUpdate"
	Label:	"Zoom to Selected"
	Click:	"View.ZoomToSelected"
	Shortcut:	"Keys.None"
)

(Choice.390
	Help:	"Centers display on point where you click to bring up popup"
	Update:	"View.HasDataUpdate"
	Label:	"Pan"
	Click:	"View.PopupPan"
	Shortcut:	"Keys.None"
)

(Space.391
)

(Choice.392
	Help:	"Opens the shape properties window for editing vertex locations"
	Update:	"ShapeWin.PopUp Update"
	Label:	"Shape Properties"
	Click:	"ShapeWin.PopUp Open"
	Shortcut:	"Keys.None"
)

(ToolBar.393
	Child:	394
	Child:	396
	Child:	398
	Child:	400
	Child:	402
	Child:	404
	Child:	406
	Child:	408
	Child:	410
	Child:	412
	Child:	414
	Child:	433
	Child:	446
	Child:	465
)

(Tool.394
	Help:	"Identify//Provides information about a feature"
	HelpTopic:	"Identify_tool"
	Update:	"View.IdentifyUpdate"
	Icon:	395
	Cursor:	"Cursors.ID"
	Apply:	"View.Identify"
)

(AVIcon.395
	Name:	"ID"
	Res:	"Icons.ID"

)

(Tool.396
	Help:	"Pointer//Selects, moves, and resizes graphics"
	HelpTopic:	"Pointer_tool"
	Update:	"View.HasDataUpdate"
	Icon:	397
	Cursor:	"Cursors.Select"
	Apply:	"View.Select"
	Click:	"View.SelectTool"
)

(AVIcon.397
	Name:	"Select"
	Res:	"Icons.Select"

)

(Tool.398
	Disabled:	1
	Help:	"Vertex Edit//Adds, moves, and deletes vertices of features and graphics"
	HelpTopic:	"Vertex_Edit_tool"
	Update:	"View.SelectToEditUpdate"
	Icon:	399
	Cursor:	"Cursors.SelectEdit"
	Apply:	"View.SelectToEdit"
	Click:	"View.SelectToEditTool"
)

(AVIcon.399
	Name:	"SelectEdit"
	Res:	"Icons.SelectEdit"

)

(Tool.400
	Help:	"Select Feature//Selects features in the active themes by pointing or dragging"
	HelpTopic:	"Select_Feature_tool"
	Update:	"View.SelectableThemesUpdate"
	Icon:	401
	Cursor:	"Cursors.Default"
	Apply:	"View.SelectPoint"
)

(AVIcon.401
	Name:	"FeatureSelect"
	Res:	"Icons.FeatureSelect"

)

(Tool.402
	Help:	"Zoom In//Zooms in at a point you click or zooms in on a rectangle you drag"
	HelpTopic:	"Zoom_In_tool"
	Update:	"View.HasDataUpdate"
	Icon:	403
	Cursor:	"Cursors.ZoomIn"
	Apply:	"View.ZoomInTool"
)

(AVIcon.403
	Name:	"ZoomInTool"
	Res:	"Icons.ZoomInTool"

)

(Tool.404
	Help:	"Zoom Out//Zooms out from a point you click or zooms out to include a rectangle you drag"
	HelpTopic:	"Zoom_Out_tool"
	Update:	"View.HasDataUpdate"
	Icon:	405
	Cursor:	"Cursors.ZoomOut"
	Apply:	"View.ZoomOutTool"
)

(AVIcon.405
	Name:	"ZoomOutTool"
	Res:	"Icons.ZoomOutTool"

)

(Tool.406
	Help:	"Pan//Drags the display in the direction you move the cursor"
	HelpTopic:	"Pan_tool"
	Update:	"View.HasDataUpdate"
	Icon:	407
	Cursor:	"Cursors.Pan"
	Apply:	"View.Pan"
)

(AVIcon.407
	Name:	"Pan"
	Res:	"Icons.Pan"

)

(Tool.408
	Help:	"Measure//Measures distance"
	HelpTopic:	"Measure_tool"
	Update:	"View.HasDataUpdate"
	Icon:	409
	Cursor:	"Cursors.Measure"
	Apply:	"View.Measure"
)

(AVIcon.409
	Name:	"Measure"
	Res:	"Icons.Measure"

)

(Tool.410
	Disabled:	1
	Help:	"Hot Link//Follows a hot link in the active themes"
	HelpTopic:	"Hot_Link_tool"
	Update:	"View.HotLinkUpdate"
	Icon:	411
	Cursor:	"Cursors.Media"
	Apply:	"View.HotLink"
)

(AVIcon.411
	Name:	"Media"
	Res:	"Icons.Media"

)

(Tool.412
	Disabled:	1
	Help:	"Area of Interest//Sets the view's Area Of Interest for library-based themes"
	HelpTopic:	"Area_Of_Interest_tool"
	Update:	"View.AOIToolUpdate"
	Icon:	413
	Cursor:	"Cursors.Default"
	Apply:	"View.AOITool"
)

(AVIcon.413
	Name:	"AOI"
	Res:	"Icons.AOI"

)

(ToolMenu.414
	Help:	"Label//Labels a feature in the active theme with data from its table"
	HelpTopic:	"Label_Tool"
	Update:	"View.LabelToolUpdate"
	Icon:	415
	Cursor:	"Cursors.Tag"
	Apply:	"View.LabelTool"
	Child:	416
	Child:	417
	Child:	419
	Child:	421
	Child:	423
	Child:	425
	Child:	427
	Child:	429
	Child:	431
)

(AVIcon.415
	Name:	"Tag"
	Res:	"Icons.Tag"

)

(Tool.416
	Help:	"Label//Labels a feature in the active theme with data from its table"
	HelpTopic:	"Label_Tool"
	Update:	"View.LabelToolUpdate"
	Icon:	415
	Cursor:	"Cursors.Tag"
	Apply:	"View.LabelTool"
)

(Tool.417
	Help:	"Callout Label//Click on a feature and drag in the direction you want the label to appear"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	418
	Cursor:	"Cursors.Tag"
	Apply:	"View.CalloutLabelTool"
)

(AVIcon.418
	Name:	"CallOutLabel1"
	Res:	"Icons.CallOutLabel1"

)

(Tool.419
	Help:	"Bullet Leader Label//Click on a feature and drag in the direction you want the label to appear"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	420
	Cursor:	"Cursors.Tag"
	Apply:	"View.BulletLeaderLabelTool"
)

(AVIcon.420
	Name:	"CallOutLabel2"
	Res:	"Icons.CallOutLabel2"

)

(Tool.421
	Help:	"Banner Label//Click on a feature you want to label"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	422
	Cursor:	"Cursors.Tag"
	Apply:	"View.ShadowBoxLabelTool"
)

(AVIcon.422
	Name:	"CallOutLabel3"
	Res:	"Icons.CallOutLabel3"

)

(Tool.423
	Help:	"U.S. Interstate//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	424
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway1 Apply"
)

(AVIcon.424
	Name:	"BW US Interstate"
	Res:	"Icons.BW US Interstate"

)

(Tool.425
	Help:	"U.S. Route//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	426
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway2 Apply"
)

(AVIcon.426
	Name:	"USRoute"
	Res:	"Icons.USRoute"

)

(Tool.427
	Help:	"Generic State Hwy//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	428
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway3 Apply"
)

(AVIcon.428
	Name:	"GenericStateHighway"
	Res:	"Icons.GenericStateHighway"

)

(Tool.429
	Help:	"Generic Square Hwy//Click where you want to place a highway shield"
	HelpTopic:	"Label_Tool"
	Update:	"View.CalloutUpdate"
	Icon:	430
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway4 Apply"
)

(AVIcon.430
	Name:	"GenericHighway1"
	Res:	"Icons.GenericHighway1"

)

(Tool.431
	Help:	"Generic Oval Hwy//Click where you want to place a highway shield"
	Update:	"View.CalloutUpdate"
	Icon:	432
	Cursor:	"Cursors.Tag"
	Apply:	"View.Highway5 Apply"
)

(AVIcon.432
	Name:	"GenericHighway2"
	Res:	"Icons.GenericHighway2"

)

(ToolMenu.433
	Help:	"Text//Creates text on the display"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	434
	Cursor:	"Cursors.Text"
	Apply:	"View.TextTool"
	Click:	"SymWin.DisplayFontPanel"
	Child:	435
	Child:	436
	Child:	438
	Child:	440
	Child:	442
	Child:	444
)

(AVIcon.434
	Name:	"Text"
	Res:	"Icons.Text"

)

(Tool.435
	Help:	"Text//Creates text on the display"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	434
	Cursor:	"Cursors.Text"
	Apply:	"View.TextTool"
	Click:	"SymWin.DisplayFontPanel"
)

(Tool.436
	Help:	"Callout Text//Click and drag to where you want your text to appear, then enter the text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	437
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.CalloutTextTool"
)

(AVIcon.437
	Name:	"CallOutText1"
	Res:	"Icons.CallOutText1"

)

(Tool.438
	Help:	"Bullet Leader Text//Click and drag to where you want your text to appear, then enter the text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	439
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.BulletLeaderTextTool"
)

(AVIcon.439
	Name:	"CallOutText2"
	Res:	"Icons.CallOutText2"

)

(Tool.440
	Help:	"Banner Text//Click where you want your label to appear and enter your text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	441
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.ShadowBoxTextTool"
)

(AVIcon.441
	Name:	"CallOutText3"
	Res:	"Icons.CallOutText3"

)

(Tool.442
	Help:	"Drop-Shadow Text//Click where you want your text to appear and enter your text"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	443
	Cursor:	"Cursors.Target"
	Apply:	"View.CreateDropShadowText"
)

(AVIcon.443
	Name:	"DropShadowText"
	Res:	"Icons.DropShadowText"

)

(Tool.444
	Help:	"Spline Text//Adds text that is aligned to a splined baseline"
	HelpTopic:	"Text_tool"
	Update:	"View.TextToolUpdate"
	Icon:	445
	Cursor:	"Cursors.Bullseye"
	Apply:	"View.SplineText"
)

(AVIcon.445
	Name:	"TextAligned"
	Res:	"Icons.TextAligned"

)

(ToolMenu.446
	Help:	"Draw Point//Creates a point on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PointToolUpdate"
	Icon:	447
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PointTool"
	Click:	"SymWin.DisplayMarkerPanel"
	Child:	448
	Child:	449
	Child:	451
	Child:	453
	Child:	455
	Child:	457
	Child:	459
	Child:	461
	Child:	463
)

(AVIcon.447
	Name:	"Point"
	Res:	"Icons.Point"

)

(Tool.448
	Help:	"Draw Point//Creates a point on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PointToolUpdate"
	Icon:	447
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PointTool"
	Click:	"SymWin.DisplayMarkerPanel"
)

(Tool.449
	Help:	"Draw Straight Line//Creates a line on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.GraphicToolUpdate"
	Icon:	450
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.LineTool"
	Click:	"SymWin.DisplayPenPanel"
)

(AVIcon.450
	Name:	"SelectLine"
	Res:	"Icons.SelectLine"

)

(Tool.451
	Help:	"Draw Line//Creates a line with two or more points on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyLineToolUpdate"
	Icon:	452
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PolyLineTool"
	Click:	"SymWin.DisplayPenPanel"
)

(AVIcon.452
	Name:	"Lines"
	Res:	"Icons.Lines"

)

(Tool.453
	Help:	"Draw Rectangle//Creates a rectangle on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyToolUpdate"
	Icon:	454
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.RectTool"
	Click:	"SymWin.DisplayFillPanel"
)

(AVIcon.454
	Name:	"Rect"
	Res:	"Icons.Rect"

)

(Tool.455
	Help:	"Draw Circle//Creates a circle on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyToolUpdate"
	Icon:	456
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.CircleTool"
	Click:	"SymWin.DisplayFillPanel"
)

(AVIcon.456
	Name:	"Disk"
	Res:	"Icons.Disk"

)

(Tool.457
	Help:	"Draw Polygon//Creates a polygon on the display"
	HelpTopic:	"Draw_tool"
	Update:	"View.PolyToolUpdate"
	Icon:	458
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.PolyTool"
	Click:	"SymWin.DisplayFillPanel"
)

(AVIcon.458
	Name:	"Poly"
	Res:	"Icons.Poly"

)

(Tool.459
	Disabled:	1
	Help:	"Draw Line to Split Feature//Creates a line to split line features"
	HelpTopic:	"Draw_tool"
	Update:	"View.SplitLineToolUpdate"
	Icon:	460
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.SplitTool"
)

(AVIcon.460
	Name:	"SplitLine"
	Res:	"Icons.SplitLine"

)

(Tool.461
	Disabled:	1
	Help:	"Draw Line to Split Polygon//Creates a line to split polygon features"
	HelpTopic:	"Draw_tool"
	Update:	"View.SplitPolyToolUpdate"
	Icon:	462
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.SplitTool"
)

(AVIcon.462
	Name:	"SplitPoly"
	Res:	"Icons.SplitPoly"

)

(Tool.463
	Disabled:	1
	Help:	"Draw Line to Append Polygon//Appends a new polygon adjacent to other polygons"
	HelpTopic:	"Draw_tool"
	Update:	"View.AutoCompleteUpdate"
	Icon:	464
	Cursor:	"Cursors.CrossHair"
	Apply:	"View.AutoCompleteTool"
)

(AVIcon.464
	Name:	"AutoComplete"
	Res:	"Icons.AutoComplete"

)

(ToolMenu.465
	Disabled:	1
	Invisible:	1
	Help:	"Snap//Sets the general snapping tolerance for the editable theme"
	HelpTopic:	"Snap_tools"
	Update:	"View.SnapToolUpdate"
	Icon:	466
	Cursor:	"Cursors.Default"
	Apply:	"View.SnapTool"
	Child:	467
	Child:	468
)

(AVIcon.466
	Name:	"SnapTool"
	Res:	"Icons.SnapTool"

)

(Tool.467
	Disabled:	1
	Invisible:	1
	Help:	"Snap//Sets the general snapping tolerance for the editable theme"
	HelpTopic:	"Snap_tools"
	Update:	"View.SnapToolUpdate"
	Icon:	466
	Cursor:	"Cursors.Default"
	Apply:	"View.SnapTool"
)

(Tool.468
	Disabled:	1
	Invisible:	1
	Help:	"Snap//Sets the interactive snapping tolerance for the editable theme"
	HelpTopic:	"Snap_tools"
	Update:	"View.InteractiveSnapToolUpdate"
	Icon:	469
	Cursor:	"Cursors.Default"
	Apply:	"View.InteractiveSnapTool"
)

(AVIcon.469
	Name:	"SnapFeatureTool"
	Res:	"Icons.SnapFeatureTool"

)

(AVIcon.470
	Name:	"Icon"
	Res:	"View.Icon"

)

(DocGUI.471
	Name:	"Table"
	Type:	"Table"
	Modified:	1
	Visible:	1
	MenuBar:	472
	ButnBar:	550
	Popups:	593
	ToolBar:	594
	NewScript:	"Table.New"
	OpenScript:	"Doc.Open"
	ActionScript:	"Table.Action"
	NewUpdateScript:	"Doc.NewUpdate"
	OpenUpdateScript:	"Doc.OpenUpdate"
	ActionUpdateScript:	"Table.ActionUpdate"
	Title:	"Tables"
	Icon:	601
)

(MenuBar.472
	Child:	473
	Child:	487
	Child:	503
	Child:	521
	Child:	530
	Child:	542
	Child:	547
)

(PMenu.473
	InternalName:	"File"
	Child:	474
	Child:	475
	Child:	476
	Child:	477
	Child:	478
	Child:	479
	Child:	480
	Child:	481
	Child:	482
	Child:	483
	Child:	484
	Child:	485
	Child:	486
	Label:	"&File"
)

(Choice.474
	Help:	"Closes the active component"
	HelpTopic:	"Close"
	Label:	"&Close"
	Click:	"Project.CloseDoc"
	Shortcut:	"Keys.None"
)

(Choice.475
	Help:	"Closes all components"
	HelpTopic:	"Close_All"
	Label:	"Close &All"
	Click:	"Project.CloseAll"
	Shortcut:	"Keys.None"
)

(Space.476
)

(Choice.477
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.478
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.479
)

(Choice.480
	Help:	"Displays the Extensions Dialog"
	HelpTopic:	"Extensions"
	Label:	"Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.481
)

(Choice.482
	Help:	"Prints the table"
	HelpTopic:	"Print"
	Label:	"&Print..."
	Click:	"Doc.Print"
	Shortcut:	"Keys.None"
)

(Choice.483
	Help:	"Edits the printer and the printing options"
	HelpTopic:	"Print_Setup"
	Update:	"PrintSetupUpdate"
	Label:	"P&rint Setup..."
	Click:	"Project.PrintSetup"
	Shortcut:	"Keys.None"
)

(Choice.484
	Help:	"Exports the current table to a dBASE, INFO, or text file"
	HelpTopic:	"Export_Table"
	Update:	"Table.ExportUpdate"
	Label:	"&Export..."
	Click:	"Table.Export"
	Shortcut:	"Keys.None"
)

(Space.485
)

(Choice.486
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.487
	InternalName:	"Edit"
	Child:	488
	Child:	489
	Child:	490
	Child:	491
	Child:	492
	Child:	493
	Child:	494
	Child:	495
	Child:	496
	Child:	497
	Child:	498
	Child:	499
	Child:	500
	Child:	501
	Child:	502
	Label:	"&Edit"
)

(Choice.488
	Disabled:	1
	Help:	"Cuts the selected cell to the clipboard"
	HelpTopic:	"Cut"
	Update:	"Table.CutUpdate"
	Label:	"Cu&t"
	Click:	"Table.Cut"
	Shortcut:	"Keys.Ctrl+X"
)

(Choice.489
	Disabled:	1
	Help:	"Copies the selected cell to the clipboard"
	HelpTopic:	"Copy"
	Update:	"Table.CutUpdate"
	Label:	"&Copy"
	Click:	"Table.Copy"
	Shortcut:	"Keys.Ctrl+C"
)

(Choice.490
	Disabled:	1
	Help:	"Inserts the contents of the Clipboard into the active cell"
	HelpTopic:	"Paste"
	Update:	"Table.CutUpdate"
	Label:	"&Paste"
	Click:	"Table.Paste"
	Shortcut:	"Keys.Ctrl+V"
)

(Space.491
)

(Choice.492
	Disabled:	1
	Help:	"Undo the last edit operation on the Table"
	HelpTopic:	"Undo_Edit_on_a_table"
	Update:	"Table.UndoEditUpdate"
	Label:	"&Undo Edit"
	Click:	"Table.UndoEdit"
	Shortcut:	"Keys.Ctrl+Z"
)

(Choice.493
	Disabled:	1
	Help:	"Redo the last undone operation on the Table"
	HelpTopic:	"Redo_Edit_on_a_table"
	Update:	"Table.RedoEditUpdate"
	Label:	"Red&o Edit"
	Click:	"Table.RedoEdit"
	Shortcut:	"Keys.Ctrl+Y"
)

(Space.494
)

(Choice.495
	Disabled:	1
	Help:	"Adds a new field to the table"
	HelpTopic:	"Add_Field"
	Update:	"Table.AddFieldUpdate"
	Label:	"Add &Field..."
	Click:	"Table.AddField"
	Shortcut:	"Keys.None"
)

(Choice.496
	Disabled:	1
	Help:	"Adds a new record at the bottom of the table"
	HelpTopic:	"Add_Record"
	Update:	"Table.AddRecordUpdate"
	Label:	"Add &Record"
	Click:	"Table.AddRecord"
	Shortcut:	"Keys.Ctrl+A"
)

(Choice.497
	Disabled:	1
	Help:	"Deletes the active field from the table"
	HelpTopic:	"Delete_Field"
	Update:	"Table.DeleteFieldUpdate"
	Label:	"&Delete Field"
	Click:	"Table.DeleteField"
	Shortcut:	"Keys.None"
)

(Choice.498
	Disabled:	1
	Help:	"Deletes the selected records from the table"
	HelpTopic:	"Delete_Records"
	Update:	"Table.DeleteRecordsUpdate"
	Label:	"D&elete Records"
	Click:	"Table.DeleteRecords"
	Shortcut:	"Keys.None"
)

(Space.499
)

(Choice.500
	Help:	"Selects all records in the table"
	HelpTopic:	"Select_All"
	Label:	"Select &All"
	Click:	"Table.SelectAll"
	Shortcut:	"Keys.None"
)

(Choice.501
	Help:	"Unselects all records in the table"
	HelpTopic:	"Select_None_in_a_table"
	Label:	"Select &None"
	Click:	"Table.UnselectAll"
	Shortcut:	"Keys.None"
)

(Choice.502
	Help:	"Toggles selected and unselected records in the table"
	HelpTopic:	"Switch_Selection"
	Label:	"&Switch Selection"
	Click:	"Table.SwitchSelection"
	Shortcut:	"Keys.None"
)

(PMenu.503
	InternalName:	"Table"
	Child:	504
	Child:	505
	Child:	506
	Child:	507
	Child:	508
	Child:	509
	Child:	510
	Child:	511
	Child:	512
	Child:	513
	Child:	514
	Child:	515
	Child:	516
	Child:	517
	Child:	518
	Child:	519
	Child:	520
	Label:	"&Table"
)

(Choice.504
	Help:	"Displays the dialog box to edit properties of the table"
	HelpTopic:	"Table_Properties"
	Label:	"&Properties..."
	Click:	"Table.Properties"
	Shortcut:	"Keys.None"
)

(Space.505
)

(Choice.506
	Help:	"Creates a chart from the table"
	HelpTopic:	"Create_Chart"
	Update:	"Table.ChartUpdate"
	Label:	"&Chart..."
	Click:	"Table.Chart"
	Shortcut:	"Keys.None"
)

(Choice.507
	Help:	"Starts or stops editing of table values"
	HelpTopic:	"Start_Stop_Editing"
	Update:	"Table.ToggleEditingUpdate"
	Label:	"Start &Editing"
	Click:	"Table.ToggleEditing"
	Shortcut:	"Keys.None"
)

(Choice.508
	Disabled:	1
	Help:	"Saves edits to the source file"
	HelpTopic:	"Save_edits_table"
	Update:	"Table.SaveEditsUpdate"
	Label:	"Save Ed&its"
	Click:	"Table.SaveEdits"
	Shortcut:	"Keys.None"
)

(Choice.509
	Disabled:	1
	Help:	"Save edits to a new source file"
	HelpTopic:	"Save_edits_as_table"
	Update:	"Table.SaveEditsUpdate"
	Label:	"Save E&dits As..."
	Click:	"Table.SaveEditsAs"
	Shortcut:	"Keys.None"
)

(Space.510
)

(Choice.511
	Help:	"Finds the row in the table using the text you enter"
	HelpTopic:	"Find"
	Label:	"&Find..."
	Click:	"Table.Find"
	Shortcut:	"Keys.Ctrl+F"
)

(Choice.512
	Help:	"Displays the Query Builder to select records with a logical expression"
	HelpTopic:	"Query_Builder"
	Label:	"&Query..."
	Click:	"Table.Query"
	Shortcut:	"Keys.Ctrl+Q"
)

(Choice.513
	Disabled:	1
	Help:	"Promotes selected rows to the top of the table"
	HelpTopic:	"Promote"
	Update:	"Table.PromoteUpdate"
	Label:	"Pr&omote"
	Click:	"Table.Promote"
	Shortcut:	"Keys.None"
)

(Space.514
)

(Choice.515
	Disabled:	1
	Help:	"Appends the fields of another table to the active table based on a common field"
	HelpTopic:	"Join"
	Update:	"Table.JoinUpdate"
	Label:	"&Join"
	Click:	"Table.Join"
	Shortcut:	"Keys.Ctrl+J"
)

(Choice.516
	Disabled:	1
	Help:	"Removes any fields joined to the table"
	HelpTopic:	"Remove_All_Joins"
	Update:	"Table.HasJoinsUpdate"
	Label:	"&Remove All Joins"
	Click:	"Table.RemoveAllJoins"
	Shortcut:	"Keys.None"
)

(Choice.517
	Disabled:	1
	Help:	"Associates the selection of the active table with another table"
	HelpTopic:	"Link"
	Update:	"Table.LinkUpdate"
	Label:	"&Link"
	Click:	"Table.Link"
	Shortcut:	"Keys.None"
)

(Choice.518
	Disabled:	1
	Help:	"Removes the association between the active table and its linked tables"
	HelpTopic:	"Remove_All_Links"
	Update:	"Table.HasLinksUpdate"
	Label:	"Re&move All Links"
	Click:	"Table.RemoveAllLinks"
	Shortcut:	"Keys.None"
)

(Space.519
)

(Choice.520
	Help:	"Refreshes the table"
	HelpTopic:	"Refresh"
	Label:	"Refres&h"
	Click:	"Table.Refresh"
	Shortcut:	"Keys.None"
)

(PMenu.521
	InternalName:	"Field"
	Child:	522
	Child:	523
	Child:	524
	Child:	525
	Child:	526
	Child:	527
	Child:	528
	Child:	529
	Label:	"F&ield"
)

(Choice.522
	Help:	"Sorts rows in ascending order (A-Z), (0-9)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Label:	"Sort &Ascending"
	Click:	"Table.SortAscending"
	Shortcut:	"Keys.None"
)

(Choice.523
	Help:	"Sorts rows in descending order (Z-A), (9-0)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Label:	"Sort &Descending"
	Click:	"Table.SortDescending"
	Shortcut:	"Keys.None"
)

(Space.524
)

(Choice.525
	Help:	"Creates or removes an index on the active field"
	HelpTopic:	"Create_Remove_Index"
	Update:	"Table.IndexUpdate"
	Label:	"Create &Index"
	Click:	"Table.Index"
	Shortcut:	"Keys.None"
)

(Space.526
)

(Choice.527
	Help:	"Creates a summary table grouped by the active field"
	HelpTopic:	"Summarize"
	Update:	"Table.SortUpdate"
	Label:	"&Summarize..."
	Click:	"Table.Summarize"
	Shortcut:	"Keys.None"
)

(Choice.528
	Disabled:	1
	Help:	"Calculates the value of a field"
	HelpTopic:	"Calculate"
	Update:	"Table.CalculateUpdate"
	Label:	"&Calculate..."
	Click:	"Table.Calculate"
	Shortcut:	"Keys.None"
)

(Choice.529
	Help:	"Generates a report of statistics for data in the active, numeric field"
	HelpTopic:	"Statistics"
	Update:	"Table.StatisticsUpdate"
	Label:	"S&tatistics..."
	Click:	"Table.Statistics"
	Shortcut:	"Keys.None"
)

(PMenu.530
	InternalName:	"Window"
	Child:	531
	Child:	532
	Child:	533
	Child:	534
	Child:	535
	Child:	536
	Child:	538
	Child:	539
	Child:	540
	Child:	541
	Label:	"&Window"
)

(Choice.531
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.532
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.533
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.534
)

(Choice.535
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.536
	ObjectTag:	537
	Update:	"WindowMenuUpdate"
)

(AVStr.537
	S:	"dcsewerdesign.apr Attributes of Line.shp DCSewerDesign.NetworkCalculator.calculate View1"
)

(Choice.538
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.539
	Help:	"Activates Attributes of Line.shp"
	Label:	"&2 Attributes of Line.shp"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.540
	Help:	"Activates DCSewerDesign.NetworkCalculator.calculate"
	Label:	"&3 DCSewerDesign.NetworkCalculator.calculate"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.541
	Help:	"Activates View1"
	Label:	"&4 View1"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.542
	InternalName:	"Help"
	Child:	543
	Child:	544
	Child:	545
	Child:	546
	Label:	"&Help"
)

(Choice.543
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.544
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help..."
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.545
)

(Choice.546
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(PMenu.547
	Help:	"DC Sewer Design Extension Menu"
	Child:	548
	Child:	549
	Label:	"&DC Sewer"
)

(Choice.548
	Disabled:	1
	Help:	"Calculate table column values using upstream and downstream lines"
	Update:	"DCSewerDesign.NetworkCalculator.update"
	Label:	"Network &Calculator"
	Click:	"DCSewerDesign.NetworkCalculator.calculate"
	Shortcut:	"Keys.None"
)

(Choice.549
	Help:	"DC Sewer Design Extension Help//DC Sewer Design Extension Help"
	Label:	"Help"
	Click:	"DCSewerDesign.Help.openCHM"
	Shortcut:	"Keys.None"
)

(ButnBar.550
	Child:	551
	Child:	553
	Child:	554
	Child:	556
	Child:	558
	Child:	560
	Child:	561
	Child:	563
	Child:	565
	Child:	567
	Child:	568
	Child:	570
	Child:	571
	Child:	573
	Child:	575
	Child:	577
	Child:	578
	Child:	580
	Child:	581
	Child:	583
	Child:	585
	Child:	586
	Child:	588
	Child:	590
	Child:	591
)

(Butn.551
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	552
	Click:	"Project.Save"
)

(AVIcon.552
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.553
)

(Butn.554
	Disabled:	1
	Help:	"Cut//Cuts the selected cell to the clipboard"
	HelpTopic:	"Cut"
	Update:	"Table.CutUpdate"
	Icon:	555
	Click:	"Table.Cut"
)

(AVIcon.555
	Name:	"Cut"
	Res:	"Icons.Cut"

)

(Butn.556
	Disabled:	1
	Help:	"Copy//Copies the selected cell to the clipboard"
	HelpTopic:	"Copy"
	Update:	"Table.CutUpdate"
	Icon:	557
	Click:	"Table.Copy"
)

(AVIcon.557
	Name:	"Copy"
	Res:	"Icons.Copy"

)

(Butn.558
	Disabled:	1
	Help:	"Paste//Inserts the contents of the Clipboard into the active cell"
	HelpTopic:	"Paste"
	Update:	"Table.CutUpdate"
	Icon:	559
	Click:	"Table.Paste"
)

(AVIcon.559
	Name:	"Paste"
	Res:	"Icons.Paste"

)

(Space.560
)

(Butn.561
	Help:	"Select All//Selects all records in the table"
	HelpTopic:	"Select_All"
	Icon:	562
	Click:	"Table.SelectAll"
)

(AVIcon.562
	Name:	"SelectAll"
	Res:	"Icons.SelectAll"

)

(Butn.563
	Help:	"Select None//Unselects all records in the table"
	HelpTopic:	"Select_None_in_a_table"
	Icon:	564
	Click:	"Table.UnselectAll"
)

(AVIcon.564
	Name:	"SelectNone"
	Res:	"Icons.SelectNone"

)

(Butn.565
	Help:	"Switch Selection//Toggles selected and unselected records in the table"
	HelpTopic:	"Switch_Selection"
	Icon:	566
	Click:	"Table.SwitchSelection"
)

(AVIcon.566
	Name:	"SwitchSelect"
	Res:	"Icons.SwitchSelect"

)

(Space.567
)

(Butn.568
	Help:	"Create Chart//Creates a chart from the table"
	HelpTopic:	"Create_Chart"
	Update:	"Table.ChartUpdate"
	Icon:	569
	Click:	"Table.Chart"
)

(AVIcon.569
	Name:	"MakeChart"
	Res:	"Icons.MakeChart"

)

(Space.570
)

(Butn.571
	Help:	"Find//Finds the row in the table using the text you enter"
	HelpTopic:	"Find"
	Icon:	572
	Click:	"Table.Find"
)

(AVIcon.572
	Name:	"Find"
	Res:	"Icons.Find"

)

(Butn.573
	Help:	"Query Builder//Displays the Query Builder to select records with a logical expression"
	HelpTopic:	"Query_Builder"
	Icon:	574
	Click:	"Table.Query"
)

(AVIcon.574
	Name:	"QueryBuilder"
	Res:	"Icons.QueryBuilder"

)

(Butn.575
	Disabled:	1
	Help:	"Promote//Promotes selected rows to the top of the table"
	HelpTopic:	"Promote"
	Update:	"Table.PromoteUpdate"
	Icon:	576
	Click:	"Table.Promote"
)

(AVIcon.576
	Name:	"Promote"
	Res:	"Icons.Promote"

)

(Space.577
)

(Butn.578
	Disabled:	1
	Help:	"Join//Appends the fields of another table to the active table based on a common field"
	HelpTopic:	"Join"
	Update:	"Table.JoinUpdate"
	Icon:	579
	Click:	"Table.Join"
)

(AVIcon.579
	Name:	"Join"
	Res:	"Icons.Join"

)

(Space.580
)

(Butn.581
	Help:	"Summarize//Creates a summary table grouped by the active field"
	HelpTopic:	"Summarize"
	Update:	"Table.SortUpdate"
	Icon:	582
	Click:	"Table.Summarize"
)

(AVIcon.582
	Name:	"Summarize"
	Res:	"Icons.Summarize"

)

(Butn.583
	Disabled:	1
	Help:	"Calculate//Calculates the value of a field"
	HelpTopic:	"Calculate"
	Update:	"Table.CalculateUpdate"
	Icon:	584
	Click:	"Table.Calculate"
)

(AVIcon.584
	Name:	"Calculator"
	Res:	"Icons.Calculator"

)

(Space.585
)

(Butn.586
	Help:	"Sort Ascending//Sorts rows in ascending order (A-Z), (0-9)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Icon:	587
	Click:	"Table.SortAscending"
)

(AVIcon.587
	Name:	"SortAscending"
	Res:	"Icons.SortAscending"

)

(Butn.588
	Help:	"Sort Descending//Sorts rows in descending order (Z-A), (9-0)"
	HelpTopic:	"Sort_table"
	Update:	"Table.SortUpdate"
	Icon:	589
	Click:	"Table.SortDescending"
)

(AVIcon.589
	Name:	"SortDescending"
	Res:	"Icons.SortDescending"

)

(Space.590
)

(Butn.591
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	592
	Click:	"Help.Tool"
)

(AVIcon.592
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(PopupSet.593
)

(ToolBar.594
	Child:	595
	Child:	597
	Child:	599
)

(Tool.595
	Help:	"Select//Selects records in the table"
	HelpTopic:	"Select_tool"
	Icon:	596
	Cursor:	"Cursors.Default"
	Apply:	"Table.Select"
	Click:	"Table.StopEditing"
)

(AVIcon.596
	Name:	"Select"
	Res:	"Icons.Select"

)

(Tool.597
	Disabled:	1
	Help:	"Edit//Changes cell values"
	HelpTopic:	"Edit_tool"
	Update:	"Table.IsEditableUpdate"
	Icon:	598
	Cursor:	"Cursors.Finger"
	Apply:	"Table.Edit"
)

(AVIcon.598
	Name:	"Edit"
	Res:	"Icons.Edit"

)

(Tool.599
	Help:	"Identify//Provides information about a record"
	HelpTopic:	"Identify_tool"
	Icon:	600
	Cursor:	"Cursors.ID"
	Apply:	"Table.Identify"
	Click:	"Table.StopEditing"
)

(AVIcon.600
	Name:	"ID"
	Res:	"Icons.ID"

)

(AVIcon.601
	Name:	"Icon"
	Res:	"Table.Icon"

)

(DocGUI.871
	Name:	"Script"
	Type:	"SEd"
	Modified:	1
	Visible:	1
	MenuBar:	872
	ButnBar:	935
	Popups:	979
	ToolBar:	980
	NewScript:	"Script.New"
	OpenScript:	"Doc.Open"
	ActionScript:	"Script.Action"
	NewUpdateScript:	"Doc.NewUpdate"
	OpenUpdateScript:	"Doc.OpenUpdate"
	ActionUpdateScript:	"Script.ActionUpdate"
	Title:	"Scripts"
	Icon:	981
)

(MenuBar.872
	Child:	873
	Child:	886
	Child:	902
	Child:	919
	Child:	930
)

(PMenu.873
	InternalName:	"File"
	Child:	874
	Child:	875
	Child:	876
	Child:	877
	Child:	878
	Child:	879
	Child:	880
	Child:	881
	Child:	882
	Child:	883
	Child:	884
	Child:	885
	Label:	"&File"
)

(Choice.874
	Help:	"Closes the active component"
	HelpTopic:	"Close"
	Label:	"&Close"
	Click:	"Project.CloseDoc"
	Shortcut:	"Keys.None"
)

(Choice.875
	Help:	"Closes all components"
	HelpTopic:	"Close_All"
	Label:	"Close &All"
	Click:	"Project.CloseAll"
	Shortcut:	"Keys.None"
)

(Space.876
)

(Choice.877
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.878
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.879
)

(Choice.880
	Help:	"Displays the Extensions Dialog"
	HelpTopic:	"Extensions"
	Label:	"Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.881
)

(Choice.882
	Help:	"Prints the script"
	HelpTopic:	"Print"
	Label:	"&Print..."
	Click:	"Doc.Print"
	Shortcut:	"Keys.None"
)

(Choice.883
	Help:	"Edits the printer and the printing options"
	HelpTopic:	"Print_Setup"
	Update:	"PrintSetupUpdate"
	Label:	"P&rint Setup..."
	Click:	"Project.PrintSetup"
	Shortcut:	"Keys.None"
)

(Space.884
)

(Choice.885
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.886
	InternalName:	"Edit"
	Child:	887
	Child:	888
	Child:	889
	Child:	890
	Child:	891
	Child:	892
	Child:	893
	Child:	894
	Child:	895
	Child:	896
	Child:	897
	Child:	898
	Child:	899
	Child:	900
	Child:	901
	Label:	"&Edit"
)

(Choice.887
	Help:	"Undoes the last change"
	HelpTopic:	"Undo__Script_"
	Label:	"&Undo"
	Click:	"Script.Undo"
	Shortcut:	"Keys.Ctrl+Z"
)

(Space.888
)

(Choice.889
	Help:	"Finds the selected or specified string"
	HelpTopic:	"Script_Find"
	Label:	"&Find..."
	Click:	"Script.Find"
	Shortcut:	"Keys.None"
)

(Choice.890
	Help:	"Finds the next occurrence of the string"
	HelpTopic:	"Script_FindNext"
	Update:	"Script.FindNextUpdate"
	Label:	"Find &Next"
	Click:	"Script.FindNext"
	Shortcut:	"Keys.F3"
)

(Choice.891
	Help:	"Replaces the selected or specifed string"
	HelpTopic:	"Script_Replace"
	Label:	"Rep&lace..."
	Click:	"Script.Replace"
	Shortcut:	"Keys.None"
)

(Space.892
)

(Choice.893
	Disabled:	1
	Help:	"Cuts the selection and puts it into the clipboard"
	HelpTopic:	"Cut"
	Update:	"Script.HasSelUpdate"
	Label:	"Cu&t"
	Click:	"Script.Cut"
	Shortcut:	"Keys.Ctrl+X"
)

(Choice.894
	Disabled:	1
	Help:	"Copies the selection and puts it into the clipboard"
	HelpTopic:	"Copy"
	Update:	"Script.HasSelUpdate"
	Label:	"&Copy"
	Click:	"Script.Copy"
	Shortcut:	"Keys.Ctrl+C"
)

(Choice.895
	Help:	"Inserts the contents of the clipboard"
	HelpTopic:	"Paste"
	Label:	"&Paste"
	Click:	"Script.Paste"
	Shortcut:	"Keys.Ctrl+V"
)

(Space.896
)

(Choice.897
	Help:	"Selects all text in the script editor"
	HelpTopic:	"Select_All_in_a_script"
	Label:	"Select &All"
	Click:	"Script.SelectAll"
	Shortcut:	"Keys.None"
)

(Choice.898
	Help:	"Deletes text from the cursor to the left margin"
	HelpTopic:	"Delete_Left"
	Label:	"&Delete Left"
	Click:	"Script.KillLine"
	Shortcut:	"Keys.Ctrl+U"
)

(Space.899
)

(Choice.900
	Disabled:	1
	Help:	"Comments selected text"
	HelpTopic:	"Comment"
	Update:	"Script.HasSelUpdate"
	Label:	"C&omment"
	Click:	"Script.Comment"
	Shortcut:	"Keys.None"
)

(Choice.901
	Disabled:	1
	Help:	"Uncomments selected text"
	HelpTopic:	"Remove_Comment"
	Update:	"Script.HasSelUpdate"
	Label:	"&Remove Comment"
	Click:	"Script.Uncomment"
	Shortcut:	"Keys.None"
)

(PMenu.902
	InternalName:	"Script"
	Child:	903
	Child:	904
	Child:	905
	Child:	906
	Child:	907
	Child:	908
	Child:	909
	Child:	910
	Child:	911
	Child:	912
	Child:	913
	Child:	914
	Child:	915
	Child:	916
	Child:	917
	Child:	918
	Label:	"&Script"
)

(Choice.903
	Help:	"Displays the dialog box to edit properties of the script"
	HelpTopic:	"Script_Properties"
	Label:	"&Properties..."
	Click:	"Script.Properties"
	Shortcut:	"Keys.None"
)

(Space.904
)

(Choice.905
	Disabled:	1
	Help:	"Compiles the script"
	HelpTopic:	"Compile"
	Update:	"Script.CompileUpdate"
	Label:	"&Compile"
	Click:	"Script.Compile"
	Shortcut:	"Keys.None"
)

(Choice.906
	Help:	"Executes one request or object reference in the compiled script"
	HelpTopic:	"Step"
	Update:	"Script.RunUpdate"
	Label:	"&Step"
	Click:	"Script.Step"
	Shortcut:	"Keys.F8"
)

(Choice.907
	Help:	"Runs the compiled script"
	HelpTopic:	"Run"
	Update:	"Script.RunUpdate"
	Label:	"&Run"
	Click:	"Script.Run"
	Shortcut:	"Keys.F5"
)

(Space.908
)

(Choice.909
	Help:	"Toggles a breakpoint on or off at the current cursor position"
	HelpTopic:	"Toggle_Breakpoint"
	Update:	"Script.RunUpdate"
	Label:	"Toggle &Breakpoint"
	Click:	"Script.ToggleBreak"
	Shortcut:	"Keys.None"
)

(Choice.910
	Help:	"Clears all breakpoints"
	HelpTopic:	"Clear_All_Breakpoints"
	Update:	"Script.RunUpdate"
	Label:	"Clear &All Breakpoints"
	Click:	"Script.ClearAllBreaks"
	Shortcut:	"Keys.None"
)

(Choice.911
	Help:	"Displays the current value of local and global variables"
	HelpTopic:	"Examine_Variables"
	Update:	"Script.RunUpdate"
	Label:	"E&xamine Variables..."
	Click:	"Script.ShowVariables"
	Shortcut:	"Keys.Ctrl+E"
)

(Space.912
)

(Choice.913
	Help:	"Inserts the source code of a system script"
	HelpTopic:	"Load_System_Script"
	Label:	"&Load System Script..."
	Click:	"Script.SystemLoad"
	Shortcut:	"Keys.None"
)

(Choice.914
	Help:	"Inserts the contents of a text file"
	HelpTopic:	"Load_Text_File"
	Label:	"Load &Text File..."
	Click:	"Script.FileLoad"
	Shortcut:	"Keys.None"
)

(Choice.915
	Help:	"Writes the entire script or the selected text to a text file"
	HelpTopic:	"Write_Text_File"
	Label:	"&Write Text File..."
	Click:	"Script.FileWrite"
	Shortcut:	"Keys.None"
)

(Space.916
)

(Choice.917
	Help:	"Embeds the script in the project and deletes its window"
	HelpTopic:	"Embed_Script"
	Update:	"Script.RunUpdate"
	Label:	"&Embed Script"
	Click:	"Script.Embed"
	Shortcut:	"Keys.None"
)

(Choice.918
	Disabled:	1
	Help:	"Removes specified script from embedded scripts and puts it in a SEd"
	HelpTopic:	"Script_Unembed"
	Update:	"Script.UnembedUpdate"
	Label:	"&Unembed Script..."
	Click:	"Script.Unembed"
	Shortcut:	"Keys.None"
)

(PMenu.919
	InternalName:	"Window"
	Child:	920
	Child:	921
	Child:	922
	Child:	923
	Child:	924
	Child:	925
	Child:	927
	Child:	928
	Child:	929
	Label:	"&Window"
)

(Choice.920
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.921
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.922
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.923
)

(Choice.924
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.925
	ObjectTag:	926
	Update:	"WindowMenuUpdate"
)

(AVStr.926
	S:	"dcsewerdesign.apr DCSewerDesign.NetworkCalculator.calculate DCSewerDesign.NetworkCalculator.update"
)

(Choice.927
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.928
	Help:	"Activates DCSewerDesign.NetworkCalculator.calculate"
	Label:	"&2 DCSewerDesign.NetworkCalculator.calculate"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.929
	Help:	"Activates DCSewerDesign.NetworkCalculator.update"
	Label:	"&3 DCSewerDesign.NetworkCalculator.update"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.930
	InternalName:	"Help"
	Child:	931
	Child:	932
	Child:	933
	Child:	934
	Label:	"&Help"
)

(Choice.931
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.932
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help"
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.933
)

(Choice.934
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(ButnBar.935
	Child:	936
	Child:	938
	Child:	939
	Child:	941
	Child:	943
	Child:	945
	Child:	946
	Child:	948
	Child:	949
	Child:	951
	Child:	953
	Child:	954
	Child:	956
	Child:	958
	Child:	960
	Child:	962
	Child:	964
	Child:	965
	Child:	967
	Child:	969
	Child:	971
	Child:	972
	Child:	974
	Child:	976
	Child:	977
)

(Butn.936
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	937
	Click:	"Project.Save"
)

(AVIcon.937
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.938
)

(Butn.939
	Disabled:	1
	Help:	"Cut//Cuts the selection and puts it into the clipboard"
	HelpTopic:	"Cut"
	Update:	"Script.HasSelUpdate"
	Icon:	940
	Click:	"Script.Cut"
)

(AVIcon.940
	Name:	"Cut"
	Res:	"Icons.Cut"

)

(Butn.941
	Disabled:	1
	Help:	"Copy//Copies the selection and puts it into the clipboard"
	HelpTopic:	"Copy"
	Update:	"Script.HasSelUpdate"
	Icon:	942
	Click:	"Script.Copy"
)

(AVIcon.942
	Name:	"Copy"
	Res:	"Icons.Copy"

)

(Butn.943
	Help:	"Paste//Inserts the contents of the clipboard"
	HelpTopic:	"Paste"
	Icon:	944
	Click:	"Script.Paste"
)

(AVIcon.944
	Name:	"Paste"
	Res:	"Icons.Paste"

)

(Space.945
)

(Butn.946
	Help:	"Undo//Undoes the last modification to the script editor text"
	HelpTopic:	"Undo__Script_"
	Icon:	947
	Click:	"Script.Undo"
)

(AVIcon.947
	Name:	"Undo"
	Res:	"Icons.Undo"

)

(Space.948
)

(Butn.949
	Help:	"Shift Lines Left//Shifts selected lines or current line two spaces to the left"
	HelpTopic:	"Shift_lines_left_or_right"
	Icon:	950
	Click:	"Script.ShiftLeft"
)

(AVIcon.950
	Name:	"ShiftLeft"
	Res:	"Icons.ShiftLeft"

)

(Butn.951
	Help:	"Shift Lines Right//Shifts selected lines or current line two spaces to the right"
	HelpTopic:	"Shift_lines_left_or_right"
	Icon:	952
	Click:	"Script.ShiftRight"
)

(AVIcon.952
	Name:	"ShiftRight"
	Res:	"Icons.ShiftRight"

)

(Space.953
)

(Butn.954
	Disabled:	1
	Help:	"Compile//Compiles the script"
	HelpTopic:	"Compile"
	Update:	"Script.CompileUpdate"
	Icon:	955
	Click:	"Script.Compile"
)

(AVIcon.955
	Name:	"Check"
	Res:	"Icons.Check"

)

(Butn.956
	Help:	"Run//Runs the compiled script"
	HelpTopic:	"Run"
	Update:	"Script.RunUpdate"
	Icon:	957
	Click:	"Script.Run"
)

(AVIcon.957
	Name:	"Run"
	Res:	"Icons.Run"

)

(Butn.958
	Help:	"Step//Executes one request or object reference in the compiled script"
	HelpTopic:	"Step"
	Update:	"Script.RunUpdate"
	Icon:	959
	Click:	"Script.Step"
)

(AVIcon.959
	Name:	"Footprints"
	Res:	"Icons.Footprints"

)

(Butn.960
	Help:	"Toggle Breakpoint//Toggles a breakpoint on or off at the current cursor position"
	HelpTopic:	"Toggle_Breakpoint"
	Update:	"Script.RunUpdate"
	Icon:	961
	Click:	"Script.ToggleBreak"
)

(AVIcon.961
	Name:	"Hand"
	Res:	"Icons.Hand"

)

(Butn.962
	Help:	"Examine Variables//Displays the current value of local and global variables"
	HelpTopic:	"Examine_Variables"
	Update:	"Script.RunUpdate"
	Icon:	963
	Click:	"Script.ShowVariables"
)

(AVIcon.963
	Name:	"Examine"
	Res:	"Icons.Examine"

)

(Space.964
)

(Butn.965
	Help:	"Load System Script//Inserts the source code of a system script"
	HelpTopic:	"Load_System_Script"
	Icon:	966
	Click:	"Script.SystemLoad"
)

(AVIcon.966
	Name:	"LoadScript"
	Res:	"Icons.LoadScript"

)

(Butn.967
	Help:	"Load Text File//Inserts the contents of a text file"
	HelpTopic:	"Load_Text_File"
	Icon:	968
	Click:	"Script.FileLoad"
)

(AVIcon.968
	Name:	"Open"
	Res:	"Icons.Open"

)

(Butn.969
	Help:	"Write Text File//Writes the entire script or the selected text to a text file"
	HelpTopic:	"Write_Text_File"
	Icon:	970
	Click:	"Script.FileWrite"
)

(AVIcon.970
	Name:	"Write"
	Res:	"Icons.Write"

)

(Space.971
)

(Butn.972
	Help:	"Script Help//Searches for help using the current selection"
	HelpTopic:	"Getting_help_about_script_components"
	Icon:	973
	Click:	"Script.Help"
)

(AVIcon.973
	Name:	"Help"
	Res:	"Icons.Help"

)

(Butn.974
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	975
	Click:	"Help.Tool"
)

(AVIcon.975
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(Space.976
)

(Butn.977
	Icon:	978
	Click:	"DCSewerDesignExtension.make"
)

(AVIcon.978
	Name:	"DiamondRed"
	Res:	"Icons.DiamondRed"

)

(PopupSet.979
)

(ToolBar.980
)

(AVIcon.981
	Name:	"Icon"
	Res:	"SEd.Icon"

)

(DocGUI.982
	Name:	"Project"
	Type:	"Project"
	Modified:	1
	MenuBar:	983
	ButnBar:	1021
	Popups:	1027
	ToolBar:	1028
	Icon:	1029
)

(MenuBar.983
	Child:	984
	Child:	995
	Child:	1005
	Child:	1016
)

(PMenu.984
	InternalName:	"File"
	Child:	985
	Child:	986
	Child:	987
	Child:	988
	Child:	989
	Child:	990
	Child:	991
	Child:	992
	Child:	993
	Child:	994
	Label:	"&File"
)

(Choice.985
	Help:	"Creates a new project"
	HelpTopic:	"New_Project"
	Label:	"&New Project"
	Click:	"Project.New"
	Shortcut:	"Keys.Ctrl+N"
)

(Choice.986
	Help:	"Opens an existing project"
	HelpTopic:	"Open_Project"
	Label:	"&Open Project..."
	Click:	"Project.Open"
	Shortcut:	"Keys.None"
)

(Choice.987
	Help:	"Closes the project window"
	HelpTopic:	"Close_Project"
	Label:	"&Close Project"
	Click:	"Project.Close"
	Shortcut:	"Keys.None"
)

(Space.988
)

(Choice.989
	Help:	"Saves the current project"
	HelpTopic:	"Save_Project"
	Label:	"&Save Project"
	Click:	"Project.Save"
	Shortcut:	"Keys.Ctrl+S"
)

(Choice.990
	Help:	"Saves the current project with a new name"
	HelpTopic:	"Save_Project_As"
	Label:	"Save Project &As..."
	Click:	"Project.SaveAs"
	Shortcut:	"Keys.None"
)

(Space.991
)

(Choice.992
	Help:	"Displays the Extensions dialog"
	HelpTopic:	"Extensions"
	Label:	"&Extensions..."
	Click:	"Appl.GetExtensionWin"
	Shortcut:	"Keys.None"
)

(Space.993
)

(Choice.994
	Help:	"Exits ArcView"
	HelpTopic:	"Exit"
	Label:	"E&xit"
	Click:	"Project.Exit"
	Shortcut:	"Keys.None"
)

(PMenu.995
	InternalName:	"Project"
	Child:	996
	Child:	997
	Child:	998
	Child:	999
	Child:	1000
	Child:	1001
	Child:	1002
	Child:	1003
	Child:	1004
	Label:	"&Project"
)

(Choice.996
	Help:	"Displays the dialog box to edit properties of the project"
	HelpTopic:	"Project_Properties"
	Label:	"&Properties..."
	Click:	"Project.Properties"
	Shortcut:	"Keys.None"
)

(Choice.997
	Help:	"Customizes the active project"
	HelpTopic:	"Customize"
	Update:	"Project.CustomizeUpdate"
	Label:	"&Customize..."
	Click:	"Project.Customize"
	Shortcut:	"Keys.None"
)

(Space.998
)

(Choice.999
	Help:	"Renames the selected project component"
	HelpTopic:	"Rename"
	Update:	"Project.RenameUpdate"
	Label:	"&Rename 'Script.saveAllScripts'..."
	Click:	"Project.Rename"
	Shortcut:	"Keys.Ctrl+R"
)

(Choice.1000
	Help:	"Deletes the selected component from the project"
	HelpTopic:	"Delete_Component"
	Update:	"Project.DeleteUpdate"
	Label:	"&Delete 'Script.saveAllScripts'..."
	Click:	"Project.Delete"
	Shortcut:	"Keys.Del"
)

(Space.1001
)

(Choice.1002
	Help:	"Adds a table to the project"
	HelpTopic:	"Add_Table"
	Update:	"Project.AddTableUpdate"
	Label:	"&Add Table..."
	Click:	"Project.AddTable"
	Shortcut:	"Keys.None"
)

(Choice.1003
	Help:	"Creates a new project component from an external source"
	HelpTopic:	"Import"
	Update:	"Project.ImportUpdate"
	Label:	"&Import..."
	Click:	"Project.Import"
	Shortcut:	"Keys.None"
)

(Choice.1004
	Help:	"Opens the SQL Connection manager"
	HelpTopic:	"SQL_Connect"
	Update:	"Project.HasSQL"
	Label:	"&SQL Connect..."
	Click:	"Project.SQLConnect"
	Shortcut:	"Keys.None"
)

(PMenu.1005
	InternalName:	"Window"
	Child:	1006
	Child:	1007
	Child:	1008
	Child:	1009
	Child:	1010
	Child:	1011
	Child:	1013
	Child:	1014
	Child:	1015
	Label:	"&Window"
)

(Choice.1006
	Help:	"Arranges windows as non-overlapping tiles"
	HelpTopic:	"Tile"
	Label:	"&Tile"
	Click:	"Project.Tile"
	Shortcut:	"Keys.None"
)

(Choice.1007
	Help:	"Arranges windows"
	HelpTopic:	"Cascade"
	Label:	"&Cascade"
	Click:	"Project.Cascade"
	Shortcut:	"Keys.None"
)

(Choice.1008
	Help:	"Arranges iconified windows"
	HelpTopic:	"Arrange_Icons"
	Label:	"&Arrange Icons"
	Click:	"Project.ArrangeIcons"
	Shortcut:	"Keys.None"
)

(Space.1009
)

(Choice.1010
	Help:	"Shows the symbol window"
	HelpTopic:	"Show_Symbol_Window"
	Label:	"Show Symbol Window..."
	Click:	"Project.ShowHideSymWin"
	Shortcut:	"Keys.Ctrl+P"
)

(Space.1011
	ObjectTag:	1012
	Update:	"WindowMenuUpdate"
)

(AVStr.1012
	S:	"dcsewerdesign.apr DCSewerDesign.NetworkCalculator.calculate DCSewerDesign.NetworkCalculator.update"
)

(Choice.1013
	Help:	"Activates dcsewerdesign.apr"
	Label:	"&1 dcsewerdesign.apr"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1014
	Help:	"Activates DCSewerDesign.NetworkCalculator.calculate"
	Label:	"&2 DCSewerDesign.NetworkCalculator.calculate"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(Choice.1015
	Help:	"Activates DCSewerDesign.NetworkCalculator.update"
	Label:	"&3 DCSewerDesign.NetworkCalculator.update"
	Click:	"WindowActivate"
	Shortcut:	"Keys.None"
)

(PMenu.1016
	InternalName:	"Help"
	Child:	1017
	Child:	1018
	Child:	1019
	Child:	1020
	Label:	"&Help"
)

(Choice.1017
	Help:	"Displays the dialog for browsing and searching ArcView's help system"
	HelpTopic:	"Help_on_Help_Topics"
	Label:	"Help &Topics..."
	Click:	"Project.HelpTopics"
	Shortcut:	"Keys.None"
)

(Choice.1018
	Help:	"Provides instructions for how to obtain help from ArcView"
	HelpTopic:	"Help_on_How_to_Get_Help"
	Label:	"&How to Get Help..."
	Click:	"Project.HelpHelp"
	Shortcut:	"Keys.None"
)

(Space.1019
)

(Choice.1020
	Help:	"Provides information about ArcView"
	HelpTopic:	"About"
	Label:	"&About ArcView..."
	Click:	"Project.About"
	Shortcut:	"Keys.None"
)

(ButnBar.1021
	Update:	"Project.UpdateButtons"
	Child:	1022
	Child:	1024
	Child:	1025
)

(Butn.1022
	Help:	"Save Project//Saves the current project"
	HelpTopic:	"Save_Project"
	Icon:	1023
	Click:	"Project.Save"
)

(AVIcon.1023
	Name:	"Save"
	Res:	"Icons.Save"

)

(Space.1024
)

(Butn.1025
	Help:	"Help//Gets help about the next button, tool, or menu choice you click"
	HelpTopic:	"Help_button"
	Icon:	1026
	Click:	"Help.Tool"
)

(AVIcon.1026
	Name:	"HelpTool"
	Res:	"Icons.HelpTool"

)

(PopupSet.1027
)

(ToolBar.1028
)

(AVIcon.1029
	Name:	"Icon"
	Res:	"Project.Icon"

)

(FN.1048
	Path:	"$HOME"
)

(TClr.1049
	Red:	0xffff
	Green:	0xffff
)

(AVStr.1050
	S:	"View"
)

(AVStr.1051
	S:	"Table"
)

(AVStr.1052
	S:	"Chart"
)

(AVStr.1053
	S:	"Layout"
)

(AVStr.1054
	S:	"Script"
)

(AVStr.1055
	S:	"Project"
)

(AVStr.1056
	S:	"Appl"
)

